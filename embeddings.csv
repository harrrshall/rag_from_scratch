sentence,embedding
"Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.
 Attention Is All You Need
Ashish Vaswani∗
Google Brain
avaswani@google.com
Noam Shazeer∗
Google Brain
noam@google.com
Niki Parmar∗
Google Research
nikip@google.com
Jakob Uszkoreit∗
Google Research
usz@google.com
Llion Jones∗
Google Research
llion@google.com
Aidan N. Gomez∗†
University of Toronto
aidan@cs.toronto.edu
Łukasz Kaiser∗
Google Brain
lukaszkaiser@google.com
Illia Polosukhin∗‡
illia.polosukhin@gmail.com
 Abstract
The dominant sequence transduction models are based on complex recurrent or
convolutional neural networks that include an encoder and a decoder. The best
performing models also connect the encoder and decoder through an attention
mechanism. We propose a new simple network architecture, the Transformer,
based solely on attention mechanisms, dispensing with recurrence and convolutions
entirely. Experiments on two machine translation tasks show these models to
be superior in quality while being more parallelizable and requiring significantly
less time to train. Our model achieves 28.4 BLEU on the WMT 2014 English-
to-German translation task, improving over the existing best results, including
ensembles, by over 2 BLEU. On the WMT 2014 English-to-French translation task,
our model establishes a new single-model state-of-the-art BLEU score of 41.8 after
training for 3.5 days on eight GPUs, a small fraction of the training costs of the
best models from the literature. We show that the Transformer generalizes well to
other tasks by applying it successfully to English constituency parsing both with
large and limited training data.
 ∗Equal contribution. Listing order is random. Jakob proposed replacing RNNs with self-attention and started
the effort to evaluate this idea. Ashish, with Illia, designed and implemented the first Transformer models and
has been crucially involved in every aspect of this work.","[ 4.49048867e-03  3.70565578e-02  1.57672772e-03  2.29408182e-02
 -2.03762539e-02  5.39894262e-03  3.83871496e-02 -2.34218109e-02
 -8.00722539e-02 -1.79393664e-02 -6.76491717e-03 -5.86971752e-02
  6.25002459e-02  2.07494143e-02  4.64560166e-02 -4.67480756e-02
  2.11521797e-02 -2.59823049e-03 -1.78921558e-02  2.07081065e-02
 -2.09094230e-02 -4.93842550e-03  1.11523392e-02  6.23278916e-02
  1.70484036e-02  2.01699473e-02  8.09905026e-03  8.08815937e-03
  3.96776944e-02 -3.45976651e-02 -2.23420244e-02  5.43845743e-02
  1.87751409e-02  6.53641373e-02  2.34425011e-06 -8.84229038e-03
 -3.68853472e-03 -3.26291807e-02  2.37810407e-02 -6.20553875e-03
  1.85932941e-03 -5.85208721e-02 -2.49557011e-02  1.30786048e-02
 -2.07570307e-02 -2.14823224e-02  7.00297952e-02  1.44565422e-02
  4.41750418e-03  8.71469304e-02 -8.96989740e-03 -5.15324995e-02
  2.57723089e-02 -4.82990183e-02  1.41874077e-02 -3.34650241e-02
  4.62959427e-03 -5.30459583e-02 -5.40458709e-02 -9.08037691e-05
 -6.18826374e-02  6.24362156e-02  4.05932069e-02  1.87737010e-02
  3.78441215e-02  2.55860556e-02  1.53300324e-02 -5.07772341e-02
 -3.82611677e-02  4.34033386e-02 -7.45961219e-02 -1.51469046e-02
 -2.62606423e-02  1.69728175e-02 -2.28540581e-02 -3.53572257e-02
 -6.11519478e-02  1.96555927e-02  8.33004620e-03  7.05594895e-04
  1.05694756e-02  1.08431149e-02  3.92109491e-02 -6.21011108e-02
 -3.78693715e-02 -3.95089276e-02  2.80085374e-02 -2.56694164e-02
 -1.51733719e-02  2.42990740e-02 -2.63746120e-02 -3.44258919e-02
  4.20040078e-02  2.81447284e-02  1.38036031e-02 -4.26786533e-03
 -1.32243913e-02 -7.23943487e-02 -2.69153267e-02 -6.28330186e-03
  5.48075698e-02  5.34326248e-02 -4.09127958e-03 -1.53183064e-03
 -2.55321860e-02  7.59630352e-02 -4.69753630e-02 -2.41917763e-02
 -5.87325580e-02  1.68838724e-02 -1.61823481e-02  3.65562327e-02
  1.29715819e-02 -2.15102434e-02 -2.77280714e-02 -1.76184718e-02
 -5.62755316e-02 -1.75248310e-02  2.25895718e-02 -1.76812187e-02
  1.54770138e-02  1.41395209e-02 -6.14997037e-02  1.61119420e-02
  3.18434313e-02  8.15960839e-02  6.68720901e-03 -1.97887756e-02
  2.38212608e-02 -8.26821476e-02 -3.60907465e-02  3.04371724e-03
  5.94000518e-03 -1.79121587e-02 -2.28465274e-02  6.15258515e-02
 -2.25741211e-02 -4.06518914e-02  3.60529171e-03  1.26282061e-02
 -2.93077733e-02 -4.99127582e-02  3.20339911e-02 -9.42423493e-02
  4.54253517e-02 -9.45340376e-03  9.70004499e-03 -2.77903564e-02
  2.70902570e-02 -2.83672591e-03 -1.91964041e-02  5.58016486e-02
  1.27931293e-02 -1.22618629e-02  5.27563356e-02  1.48894694e-02
 -1.32638970e-02  2.19011642e-02  6.18136637e-02  6.64486643e-03
 -2.67984550e-02 -5.38690686e-02  4.08818647e-02  6.26831204e-02
  1.13971606e-02  3.99094960e-03 -3.01179215e-02 -6.51851296e-02
  1.92920193e-02  3.87645923e-02  4.09390330e-02  2.85700746e-02
 -2.69847568e-02 -1.89633016e-02  5.94460964e-02  5.96753769e-02
  2.10621953e-02  5.74638322e-02  3.39713171e-02 -4.54384014e-02
 -2.56575271e-02  7.55349221e-03 -1.85912419e-02  6.76136538e-02
 -1.97503939e-02 -6.06572395e-03  1.38605572e-02  5.06567620e-02
 -4.89624497e-03 -2.24415995e-02  7.64338905e-03 -6.80066645e-03
  1.92180835e-02 -3.90966311e-02  4.06209230e-02  2.32813265e-02
 -7.37635940e-02  2.48638988e-02 -1.14456657e-03 -5.41190617e-02
 -1.06647322e-02  3.21803358e-03 -3.03815380e-02  5.41449301e-02
  3.06808092e-02  2.68186722e-02 -2.08663102e-02 -5.03099971e-02
 -2.85422686e-03  3.98511551e-02  1.41467704e-02  4.99881208e-02
  2.03228649e-02 -7.55541474e-02 -1.37640741e-02  4.02233526e-02
 -7.59809511e-03  4.75494936e-02 -4.23285402e-02  2.31602918e-02
  2.08856706e-02  2.28882395e-02 -4.85248007e-02  1.56741552e-02
 -3.25692333e-02 -4.93710414e-02 -7.51217315e-03  2.45673172e-02
  2.21279655e-02  6.59104576e-03  7.57891638e-03  2.43884027e-02
  4.25896794e-02 -8.57882723e-02  2.05605850e-02  4.58606817e-02
 -5.82607500e-02 -4.75303009e-02  1.21995267e-02 -6.11639321e-02
  2.94652791e-03  3.48901004e-02 -5.52738830e-03 -5.54290190e-02
  3.45356688e-02 -5.95050566e-02  2.84875371e-02  7.55391130e-03
  3.25699337e-02  3.19548957e-02  3.09921261e-02 -1.14784744e-02
  2.45812032e-02 -4.07247432e-02  1.50298467e-02  8.27755255e-04
 -2.53529605e-02 -4.16867156e-03 -3.94152999e-02  1.22871557e-02
  4.71825786e-02  1.07700157e-03  2.50274921e-03  2.87041515e-02
 -2.98013678e-03 -9.46539361e-03 -1.65931713e-02 -3.72326411e-02
  2.61222757e-02 -8.09323601e-03  4.74689156e-02  2.23157797e-02
  2.50738040e-02  2.74403617e-02  1.56703289e-03 -3.38278376e-02
  2.97499187e-02 -5.84167009e-03  1.78382976e-03  4.30103112e-03
 -2.58239731e-02 -2.05353256e-02 -2.93514580e-02 -4.60947640e-02
 -1.40035967e-03  6.83156028e-02 -7.90517684e-03 -4.50154282e-02
 -2.23865081e-02  6.04838878e-03  1.50315417e-03  1.34979282e-02
 -1.18314615e-02 -7.13059232e-02  1.74137428e-02 -2.49476521e-03
  5.01502007e-02  7.64728561e-02  2.07309332e-02 -1.12199569e-02
 -4.03491221e-03 -2.93429438e-02 -2.65428759e-02 -1.63666792e-02
 -3.33194472e-02 -9.17235855e-03 -2.56204195e-02 -5.94792031e-02
 -1.49448607e-02  8.25840384e-02  1.62234635e-03  2.07806751e-02
 -7.12263733e-02 -1.79856513e-02  1.57070197e-02 -1.99631788e-02
  7.38021871e-03 -4.87768464e-03 -2.88258288e-02  3.43466513e-02
 -2.72133388e-02 -2.53780298e-02  2.98021920e-02 -2.84900088e-02
 -9.08664428e-03 -3.41103040e-02  1.52334906e-02  3.06645478e-03
  3.58251669e-02  1.72396749e-02  1.04732346e-02  4.32799989e-03
 -3.49694975e-02 -1.69963948e-02  2.23244540e-02 -4.08445625e-03
 -2.74789073e-02  6.19941391e-02 -2.32546758e-02 -5.45469597e-02
 -3.43006961e-02 -2.31528729e-02 -2.20686439e-02  6.01218119e-02
 -1.64154675e-02 -1.80403609e-02  1.42944185e-02 -2.63239909e-02
 -8.18626657e-02  2.22105868e-02  4.29452062e-02  7.26031512e-02
 -1.00220935e-02  7.11632986e-03 -1.17607377e-02  3.51141095e-02
  3.86028248e-03  3.48805711e-02  3.94941345e-02 -5.30600511e-02
  1.49942422e-02  5.71915135e-02  3.46187428e-02  1.34068839e-02
 -5.14618568e-02  2.87799630e-03  3.20438072e-02  9.92347300e-03
 -3.90098579e-02  1.04970261e-02  4.34392728e-02 -1.01083346e-01
 -1.20256497e-02  1.07598975e-01 -9.65911988e-03 -4.69471365e-02
  2.11506411e-02  2.41027661e-02  2.33892747e-03  7.09906686e-03
 -1.32893007e-02 -4.52195965e-02 -2.29535270e-02  8.22210405e-03
  1.99749023e-02  2.91786082e-02  1.29286423e-02  1.12559153e-02
 -7.14074224e-02  4.33109701e-02  6.26959652e-02 -5.44132479e-02
 -5.26299588e-02 -2.67248973e-02 -3.38882916e-02 -2.50752829e-02
  2.45198398e-03  1.54534262e-02  1.85661037e-02  4.47418448e-03
  2.59695146e-02  1.20393801e-02 -4.81990017e-02  2.04024441e-03
 -5.71265034e-02  1.15445815e-02  8.48522931e-02  1.48965837e-02
  3.48353572e-03 -4.83709797e-02  1.05091007e-02 -1.41250330e-03
  2.65481714e-02 -1.18304985e-02  1.68513171e-02  1.18355229e-02
 -2.18810420e-02  1.55358789e-02  2.25879699e-02 -7.87311569e-02
 -2.31705327e-03  1.80355199e-02  6.74004629e-02  1.74588971e-02
 -2.43659914e-02  3.01225955e-04  9.96826869e-03 -2.12699343e-02
  4.90661412e-02  4.94700111e-02 -5.41514009e-02 -3.17946076e-02
 -3.42770070e-02  2.38759276e-02 -9.96741876e-02 -5.79388365e-02
  1.70359958e-03  2.36045755e-02 -8.88101608e-02 -9.46389884e-02
 -3.70769128e-02 -1.57805197e-02  3.86483297e-02  3.11096180e-02
  3.40320077e-03  4.93565463e-02 -1.99335758e-02 -2.79161986e-02
  2.97764633e-02  1.13078263e-02  1.22023290e-02 -5.90669625e-02
  1.36274826e-02 -2.71540112e-03 -1.81351751e-02  2.77690677e-04
  4.26908657e-02 -9.19282511e-02 -5.09957559e-02 -1.10877650e-02
  7.19205961e-02  2.27277856e-02  1.40340701e-02 -1.06264267e-03
 -2.17273068e-02  6.31710095e-03 -1.22653507e-02 -9.06903180e-04
  3.38551812e-02  2.79113185e-02 -6.11550771e-02 -8.72972421e-03
  2.06269268e-02  1.04453675e-02  2.68909354e-02  3.64452899e-02
  3.57467420e-02 -1.47540541e-02 -3.63882110e-02  2.27008853e-02
 -2.28427798e-02  7.05548450e-02  3.69619555e-03  2.84182141e-03
 -7.63982348e-03  3.70055251e-02  2.35910378e-02  3.92388254e-02
 -5.17992899e-02 -9.07726400e-03  4.57313247e-02  4.53459211e-02
  1.33474059e-02 -1.08105624e-02  4.24062721e-02 -6.51337504e-02
 -5.31055406e-02  6.43651336e-02 -2.32704710e-02  6.59273751e-03
 -4.36221110e-03  1.41765801e-02 -9.17444564e-03  2.47501042e-02
 -1.76702626e-02  1.97413769e-02 -1.86734423e-02  3.26454602e-02
  1.23094218e-02  5.78820482e-02  1.09050609e-02  1.62246991e-02
 -4.55811620e-02  2.54635699e-03 -4.03671153e-03 -1.79242641e-02
  9.12829116e-02 -1.58381015e-02  9.63358283e-02  1.61986221e-02
  6.37321081e-03 -4.93215844e-02  2.99111735e-02 -5.08392416e-02
  1.07823927e-02 -2.73502879e-02 -2.16030958e-03  6.90896483e-03
 -2.95872684e-03  5.81475832e-02 -2.46725213e-02  2.95152459e-02
  2.65291873e-02  3.30570387e-03 -2.88351178e-02 -1.71577018e-02
 -2.09010206e-02 -4.33581732e-02 -1.82426479e-02 -1.26392655e-02
 -1.58591624e-02 -3.79997119e-02  5.19213341e-02 -2.84878798e-02
  2.07812861e-02 -1.29952906e-02  2.98205893e-02  2.76200101e-02
 -4.69001532e-02 -2.76564453e-02 -1.14319539e-02  3.73098589e-02
 -3.52176465e-02 -5.15563302e-02 -1.13281496e-02 -6.64674024e-33
  3.12126894e-03 -7.22472835e-03  7.66104436e-04 -3.51698361e-02
 -4.15722355e-02  4.80694929e-03 -5.10875806e-02 -1.37973297e-02
 -9.30781104e-03 -1.35335550e-02  5.93759771e-03 -1.59698427e-02
  2.87022814e-03  3.97988930e-02  4.64118980e-02  1.17637124e-02
  5.32333106e-02  2.00167838e-02 -3.04703042e-02  1.92562658e-02
  5.25960773e-02  5.42178117e-02  1.01409979e-01 -2.91876048e-02
 -4.64872830e-02 -3.56139778e-03  5.52477641e-03 -2.09785942e-02
 -7.91765843e-03  3.46334837e-02 -4.10461944e-04  8.73896293e-03
  1.38726411e-02 -7.18008280e-02 -4.63473126e-02  2.33541988e-02
 -8.84764418e-02  3.65067180e-03 -2.98967622e-02  2.67657898e-02
 -4.62316610e-02 -5.44466451e-02  9.69141722e-02 -2.60681305e-02
 -1.70135908e-02 -2.24762857e-02  1.51467109e-02 -4.55416590e-02
 -6.35291785e-02  4.60924208e-03 -8.27179700e-02  1.68560967e-02
 -2.75639147e-02  1.04051735e-02  3.74412872e-02  4.56577539e-02
 -3.83763164e-02 -1.02489023e-02 -1.03564791e-01  1.18060634e-02
  1.80571396e-02  8.33363906e-02  5.48201837e-02  1.48664275e-02
  5.07310126e-03 -2.07834877e-02  5.09460196e-02 -1.68806687e-02
  1.72115269e-03 -9.67843924e-03  1.99987497e-02 -6.93155307e-05
  1.05112933e-01 -1.42004406e-02  6.75945878e-02 -2.04479154e-02
 -5.09399138e-02  3.04652704e-03 -2.06120759e-02  3.93373370e-02
  3.21728177e-02  3.54814455e-02 -9.94989742e-03  1.21623194e-02
 -1.70273415e-03  8.74643680e-03 -9.06669348e-03 -2.22482868e-02
  2.15549171e-02 -2.76674540e-03  5.57766855e-03 -1.65642146e-02
  6.29452914e-02 -1.05740419e-02  5.88382781e-02 -1.17974142e-02
  5.76745672e-03  3.50117460e-02 -1.67608466e-02  2.73611117e-02
 -6.89076334e-02  1.71336101e-03  2.20144466e-02  3.20495591e-02
  5.16707730e-03 -2.70401780e-03  4.44136374e-02  2.77774930e-02
 -4.05747816e-02 -3.67516838e-02 -6.78894520e-02  2.27814931e-02
  2.19913516e-02  5.43699861e-02  5.10255061e-02 -3.04732956e-02
 -1.59764022e-03  1.12038152e-02 -1.17491353e-02 -1.42816342e-02
 -1.71341151e-02  2.03343425e-02  9.07284487e-03  4.32941876e-02
 -5.26019931e-02  1.37124592e-02 -6.89726025e-02  4.73926477e-02
  4.27991673e-02 -3.35463621e-02 -5.60299121e-02  5.89418188e-02
  3.08138169e-07  3.69004831e-02  4.89005558e-02  3.49698700e-02
  1.02918176e-02  2.59340107e-02  1.13499723e-02 -1.88736524e-02
  3.62387486e-02  8.10784288e-03 -7.70668313e-03  2.16727555e-02
  1.04479557e-02  8.56635347e-02 -5.72686456e-03 -4.82039154e-02
 -5.67312315e-02 -5.61588556e-02  4.95021343e-02 -1.99526511e-02
  1.31843568e-04  3.05872736e-03  9.32081118e-02 -1.48706660e-02
 -4.08313097e-03  3.61398868e-02  7.66267674e-03  5.67610934e-02
 -1.09072896e-02  1.27969803e-02 -3.61860804e-02  7.46292295e-03
  2.04868559e-02 -4.70252968e-02  1.14834579e-02 -3.39936018e-02
 -1.06564770e-02  4.06961516e-02  3.53844389e-02 -3.26053463e-02
 -3.61642614e-02  2.58450750e-02  2.78548263e-02 -1.95097476e-02
 -3.61286141e-02  1.05454819e-02 -2.81809941e-02 -2.64372770e-02
  2.32017948e-03 -2.70725172e-02  4.24772277e-02  3.22430246e-02
 -3.56011167e-02  1.43004861e-02  1.20978747e-02  3.71994451e-02
  6.83390303e-03 -3.33379842e-02 -2.58359406e-02 -2.02131807e-03
 -1.39352651e-02 -4.01412547e-02 -2.35651117e-02 -8.39845389e-02
  3.24312341e-03  1.88115193e-03  1.08407848e-02 -6.79169819e-02
  2.92834768e-34  1.45680616e-02 -3.30102853e-02  3.14648189e-02
  1.31498892e-02  3.57028283e-02 -4.06583957e-02 -2.91802026e-02
  1.00230109e-02 -8.24920461e-03 -5.84659837e-02 -5.79688400e-02]"
"Noam proposed scaled dot-product attention, multi-head
attention and the parameter-free position representation and became the other person involved in nearly every
detail. Niki designed, implemented, tuned and evaluated countless model variants in our original codebase and
tensor2tensor. Llion also experimented with novel model variants, was responsible for our initial codebase, and
efficient inference and visualizations. Lukasz and Aidan spent countless long days designing various parts of and
implementing tensor2tensor, replacing our earlier codebase, greatly improving results and massively accelerating
our research.
 †Work performed while at Google Brain.
 ‡Work performed while at Google Research.
 31st Conference on Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA.
arXiv:1706.03762v7   [cs.CL]  2 Aug 2023
","[ 1.49527993e-02 -5.40683279e-04 -1.73165407e-02  3.12570930e-02
 -3.34348604e-02 -1.51043376e-02  4.40855660e-02  3.56838549e-03
 -2.49138009e-02  1.06994882e-02 -1.19083254e-02 -6.80655539e-02
  4.97799739e-03  2.27195732e-02  6.42220229e-02 -5.10739423e-02
  2.38438807e-02 -3.72435292e-03 -3.01182270e-02  8.30548743e-05
  3.95586062e-03 -1.56968962e-02  7.12181581e-03  3.31274010e-02
 -2.46777479e-02 -3.24582425e-03 -6.04044087e-02  2.49021463e-02
  4.69662212e-02 -5.88534726e-03  2.66549410e-03  6.72069564e-02
  4.24794527e-03  6.76901937e-02  2.18431160e-06 -3.01996805e-03
  1.92313250e-02  1.42537486e-02  2.13466603e-02 -4.46512317e-03
 -1.57381203e-02 -2.03264095e-02 -2.43736221e-03 -2.80382615e-02
 -3.47500630e-02 -2.42868275e-03  7.88240060e-02  3.59488912e-02
  2.49934234e-02  6.32152706e-02 -2.28817593e-02  1.92519650e-02
  3.70510072e-02 -6.58216849e-02  3.48808095e-02 -4.11199555e-02
  6.67832978e-03 -6.11758605e-02 -4.49528284e-02  2.63075996e-02
 -1.52016142e-02  2.27704532e-02  1.75912324e-02  1.15923127e-02
  6.15859888e-02  9.15056467e-02 -2.30741668e-02 -6.08900376e-02
 -2.21011881e-02  5.95520213e-02 -2.25864220e-02 -1.86847951e-02
 -6.99211936e-03  2.48888172e-02  9.81069403e-04 -5.32246381e-02
 -5.12184277e-02  1.93635654e-02  1.85046941e-02  4.17220332e-02
 -1.60026848e-02 -1.50861610e-02  5.46377338e-03 -3.74177843e-02
  1.03868908e-04  2.81574652e-02 -1.85851357e-03 -7.49880821e-03
 -1.84285343e-02  1.84562355e-02 -1.75090469e-02 -1.19563490e-02
  3.14380229e-02  2.96937451e-02  3.46960686e-02 -5.69795668e-02
 -4.45857365e-03 -8.80758837e-02 -2.24514608e-03 -9.36201662e-02
  9.75321829e-02  4.08848859e-02 -1.70735084e-02  4.75817248e-02
 -4.75570783e-02  6.34230226e-02 -5.62850609e-02  5.06771123e-03
 -8.19334388e-03 -7.57934933e-04  2.98198815e-02  3.41832116e-02
 -1.78265583e-03  7.97313266e-03 -1.83150824e-02 -5.32595105e-02
  1.21119702e-02  1.99099537e-02 -1.11548053e-02 -4.59702201e-02
 -2.23983619e-02  5.94421178e-02 -3.73089276e-02 -1.75347906e-02
 -2.60837656e-02  5.91077730e-02 -3.54432538e-02  8.35050177e-03
 -1.67494938e-02 -2.45114192e-02 -6.21678755e-02  4.37440202e-02
  1.00720872e-03 -1.84440315e-02  2.31803432e-02  6.16317876e-02
 -1.84381474e-02 -2.89626122e-02  1.93610918e-02  4.33985963e-02
  1.27312532e-02 -4.95331548e-02  5.86806685e-02 -3.10032628e-02
  4.51584980e-02  6.21911092e-03 -2.85917204e-02 -3.40053774e-02
  6.89814286e-03  1.02451127e-02 -6.15024976e-02  5.68538532e-03
  1.24721117e-02 -3.38889509e-02  3.25078378e-04 -9.13902986e-05
  1.16359582e-02  5.80620915e-02  2.63510644e-02  5.36405705e-02
 -3.14967893e-02  1.13303484e-02 -3.43015753e-02 -3.25788446e-02
  1.89044867e-02 -1.19409030e-02 -5.46462648e-02 -4.27749753e-02
  1.84481237e-02  1.73772797e-02  5.27076572e-02  5.39446175e-02
 -1.53020546e-02 -2.20923889e-02  5.37228137e-02  3.45498212e-02
  3.37722413e-02  3.15619409e-02  3.05509698e-02 -6.21408261e-02
 -2.18050182e-02 -2.53356826e-02 -8.80063027e-02  9.77218226e-02
 -8.31525307e-03 -3.11844610e-02  4.09816438e-03  1.37945786e-02
 -2.26722918e-02 -2.92498153e-02  1.31260708e-03  1.65278036e-02
  5.58296591e-03 -2.59209368e-02  4.66462076e-02 -4.62235585e-02
 -2.84556374e-02  2.68375054e-02 -1.86232291e-02 -1.77908596e-02
 -1.89382490e-03 -1.70987938e-02  2.55991239e-02  1.31359948e-02
 -1.08209252e-02 -2.34899949e-02 -7.07721114e-02  8.15574836e-04
 -9.37692542e-03  5.27666733e-02  7.26430304e-03  4.69061472e-02
  5.82250319e-02 -3.61739658e-02  1.24004867e-03 -4.37329151e-02
  1.17435642e-02 -1.03881350e-03 -2.44705379e-02  2.45313179e-02
  7.24729244e-03  2.25737169e-02  4.21071332e-03  1.68759674e-02
  3.18881050e-02 -5.99119999e-03  1.69038922e-02 -7.67707219e-03
  1.57830622e-02  1.44311478e-02 -1.99049897e-03  9.91228968e-03
  5.38961142e-02 -5.11388183e-02  4.01728526e-02 -1.95051283e-02
 -1.78185403e-02  9.07590333e-03  4.98725697e-02 -7.32913986e-02
  4.72899759e-03  4.91732024e-02 -2.98721083e-02 -5.42695262e-02
  7.50466883e-02 -6.70095580e-03 -1.65437497e-02 -1.34835662e-02
 -1.10739945e-02  5.61505323e-03  6.03532195e-02 -1.38209667e-02
  4.10623923e-02 -6.54013827e-03  2.28318293e-03  1.72203816e-02
  2.03096773e-03  1.48193985e-02 -3.42065990e-02 -2.05708924e-03
 -3.87195172e-03 -2.54274979e-02 -2.52265367e-03 -3.25222500e-02
  7.21372757e-03  1.29410368e-03  5.69125125e-03 -6.44090921e-02
  2.74456199e-02 -2.71125231e-02  2.40770020e-02  2.85461023e-02
 -1.03681870e-02 -1.69473700e-03 -3.05934474e-02 -1.50109604e-02
  2.46441532e-02  7.93887675e-03 -6.43529370e-03  4.36176509e-02
 -4.84052040e-02  1.11490372e-03 -3.90181392e-02 -4.75863218e-02
 -2.95562316e-02  2.15945356e-02  2.50280369e-02 -4.32181507e-02
 -3.99038084e-02 -1.15265260e-02 -1.59634203e-02  6.58625215e-02
 -1.61158305e-03  9.91168525e-03  3.82711031e-02 -6.02629706e-02
  3.44907939e-02  1.25452951e-01 -1.54260155e-02  2.30655763e-02
  3.89903560e-02  3.12869437e-02  5.96132316e-03  2.79600155e-02
 -3.17455716e-02  1.41020222e-02 -9.81175341e-03 -2.20325477e-02
 -4.23051752e-02  7.82032087e-02 -1.55091146e-02 -3.21524055e-03
 -5.80461919e-02 -2.99072731e-02  2.29718834e-02  7.76383746e-03
 -1.19068995e-02  1.88981891e-02 -3.95908207e-02  5.58582358e-02
 -1.61542762e-02 -3.29192504e-02  4.72891890e-02 -1.04004648e-02
 -2.26277467e-02 -1.75265037e-02 -5.25208889e-04 -5.88133652e-03
  3.41634303e-02  3.32554542e-02  5.28265759e-02  1.37571534e-02
 -3.41556221e-02 -1.89314242e-02  2.62596663e-02  1.69062091e-03
  1.22058932e-02  1.00036450e-02  4.04247257e-04 -3.18453982e-02
 -3.22507471e-02 -6.64949790e-03 -4.61730594e-03  2.43693143e-02
 -3.36537138e-02  4.02589701e-02 -2.26458460e-02 -1.13479896e-02
 -5.27888946e-02 -2.45170295e-02  6.15803003e-02  4.18763943e-02
 -4.34224196e-02 -5.26030315e-04 -2.00721286e-02  1.31241372e-02
  2.38028541e-02  8.60369951e-02  8.34109727e-03 -1.46134617e-02
 -2.13542767e-02  8.26305151e-02  4.43593338e-02  3.80273648e-02
 -8.16022158e-02 -3.24864243e-03  3.44714820e-02 -6.22831518e-03
  5.17885806e-03  2.72986591e-02  4.49942946e-02 -1.75295137e-02
  2.81506218e-03  3.35337482e-02 -2.39503309e-02 -6.88880906e-02
  1.93960383e-03 -4.68246918e-03  5.13969082e-03  3.21924426e-02
  2.74194945e-02 -2.32126676e-02 -2.58028973e-02 -5.15688770e-03
  1.57662909e-02  3.80410962e-02 -1.53176865e-04  3.83595712e-02
 -6.23884890e-03  5.84507547e-02 -4.70609346e-04 -7.86451176e-02
 -2.62120236e-02 -5.79182431e-02  2.13632192e-02 -1.64336208e-02
 -2.30987836e-02  2.06010081e-02  9.71353799e-03 -1.59630575e-03
  5.35521470e-03  6.29301965e-02 -6.57298928e-03 -1.00715831e-02
 -4.02612314e-02  1.26677416e-02  5.76718524e-02  9.31775849e-03
 -2.03836802e-02 -3.09768226e-02  1.09339142e-02  9.48654208e-03
  4.78341542e-02 -3.23499888e-02  5.57094105e-02 -1.68336891e-02
 -1.46220224e-02 -5.89661933e-02  4.44708578e-02 -4.19478081e-02
  2.11685542e-02 -6.28705695e-02  7.14093745e-02 -9.61369486e-04
 -1.68118197e-02 -6.69093728e-02  3.16574648e-02 -3.56292129e-02
  5.10795880e-03  6.88640550e-02 -1.54141374e-02 -5.91814220e-02
  7.01892143e-03  4.22535017e-02 -3.97704802e-02 -4.41993177e-02
 -3.49957384e-02  5.96402064e-02 -7.64588043e-02 -2.31131092e-02
  7.72890449e-03 -1.68038532e-02  3.91956344e-02 -1.31930877e-03
 -4.63531502e-02 -1.16947619e-02 -5.79922646e-02 -1.37857152e-02
  7.36174881e-02  1.69841163e-02 -1.32174073e-02 -4.21167873e-02
 -4.83759074e-03  7.25971255e-03 -8.11061449e-03 -2.06229929e-03
  6.06598146e-02 -9.76912454e-02 -6.56888783e-02 -2.20886432e-02
  8.26524645e-02  1.96567625e-02  2.54706889e-02 -3.66001613e-02
  8.22447822e-04  1.07707074e-02  1.84356160e-02  1.12484517e-02
  4.97491471e-02  3.37166823e-02 -4.94006090e-02 -2.72310786e-02
  1.03663951e-02 -2.78170244e-03  2.18730178e-02  2.01079808e-02
  1.16730742e-02 -1.86187681e-03 -2.08783504e-02 -6.14076946e-03
 -3.22213285e-02  9.84045714e-02  4.22815792e-02  5.20939641e-02
 -4.30037677e-02  6.47363428e-04  2.15969421e-02  3.30341533e-02
 -2.77335625e-02 -2.81668585e-02  3.92323807e-02  4.05621827e-02
  2.03939918e-02 -4.08055726e-03  2.78262533e-02 -9.79063008e-03
 -5.17025776e-02  3.79514396e-02 -2.01830007e-02  2.00889073e-02
 -8.45797081e-03  1.07832570e-02 -3.44849005e-02  4.53255065e-02
 -2.22754162e-02  5.95128089e-02  6.88940287e-03  3.17192711e-02
  1.74410809e-02  4.27283347e-03 -4.96768728e-02  3.28568853e-02
 -7.64328763e-02 -8.85258541e-02 -1.97320953e-02 -7.83355720e-03
  7.84507543e-02  6.15588902e-03  6.95362836e-02  1.36918202e-02
 -3.61482962e-03 -1.57533791e-02  2.27735471e-02 -1.58007033e-02
  1.84049401e-02  5.94816869e-04  4.79015463e-04  3.24175172e-02
 -1.37025667e-02  3.38872373e-02 -3.03072464e-02 -3.42930704e-02
 -1.16158312e-03  1.18867243e-02 -1.17565542e-02 -3.51227634e-02
 -3.42862564e-03  3.59465778e-02 -3.74500528e-02 -4.10406245e-03
  6.22585602e-03 -3.99672166e-02 -4.23276471e-03 -3.06035429e-02
 -4.72752703e-03 -5.89061007e-02  2.75800787e-02  2.42237598e-02
  1.71171408e-02 -4.63694669e-02  1.32114766e-02 -2.84406240e-03
  1.57636940e-03 -3.70897800e-02 -3.81938294e-02 -7.30914306e-33
 -1.23686763e-02  3.86711769e-02 -4.06047702e-02 -1.96026154e-02
 -4.80662808e-02  3.22427079e-02 -5.96041791e-02  1.67445932e-02
 -5.07876016e-02 -1.23903416e-02 -1.60954148e-02 -7.46203354e-03
  6.79515861e-03 -6.06934715e-04  4.32314090e-02 -1.10121351e-02
 -1.80939268e-02 -1.03593254e-02 -8.72056466e-03  4.27109450e-02
  4.44758348e-02  4.54534814e-02  1.00617766e-01 -2.22201627e-02
  1.87720563e-02  4.27464629e-03 -2.45902911e-02  1.28754601e-02
 -5.83061390e-02  1.83694903e-02 -4.75173220e-02  5.42373676e-03
  9.35544819e-03 -6.24826849e-02 -1.50631983e-02 -2.91186441e-02
 -7.54309520e-02 -4.12144028e-02 -3.23242880e-02 -3.60826477e-02
 -1.00292698e-01 -3.04840552e-03  1.05755314e-01  1.16371028e-02
 -1.01365587e-02 -2.29094289e-02  3.01455930e-02 -3.13754435e-06
 -5.03300466e-02  5.50195649e-02 -5.56456000e-02 -1.63492654e-02
 -2.79387366e-02  1.02625666e-02  2.43378654e-02  2.93323658e-02
 -2.51982287e-02  2.36643329e-02 -8.41243565e-02  4.52868966e-03
 -6.94383867e-04  2.99094599e-02  3.71817760e-02 -4.52758744e-04
  3.72041278e-02  2.26073489e-02  5.54938428e-02  3.87269468e-03
 -7.02834204e-02 -2.90992875e-02  1.72033310e-02  2.96050701e-02
  5.82313314e-02 -4.78222333e-02  2.04083864e-02  2.16640104e-02
 -4.90982048e-02 -1.76971918e-03  3.91233712e-02  6.43419921e-02
  7.04847462e-03  1.09182503e-02 -2.53785402e-02 -2.15173811e-02
  3.57467011e-02 -6.42618686e-02 -3.49518023e-02 -2.92826854e-02
  8.80756415e-03  1.32184671e-02 -3.21973674e-02  9.50320624e-03
  3.94830629e-02  2.08922550e-02  9.00506303e-02 -5.74421196e-04
  2.15693973e-02  5.17049693e-02  4.01047356e-02 -2.69353911e-02
 -5.47101609e-02 -1.82916746e-02 -1.89903565e-02  1.27070630e-02
  2.87581924e-02  3.10775712e-02 -6.52428484e-03  3.74885648e-02
  2.29324065e-02 -3.39112394e-02 -4.91233543e-02 -2.88802814e-02
  1.25289671e-02  4.30158079e-02  2.60640122e-02 -6.55510947e-02
  8.25304911e-03  2.08059307e-02 -6.67789206e-03  4.59630005e-02
 -2.87593417e-02  7.13810977e-03 -1.19154043e-02  3.70495878e-02
 -4.29465109e-03 -3.60829919e-03 -6.61192760e-02  9.56272054e-03
  5.81041314e-02 -9.34570581e-02 -6.11552782e-02  2.74972320e-02
  3.06060372e-07  3.61033194e-02  2.35637687e-02  1.53291421e-02
 -1.68047622e-02  2.41221525e-02  3.62610072e-02 -5.13694063e-03
  5.95044307e-02  3.77699174e-02  9.64818057e-03  5.43641532e-03
  7.74483234e-02 -2.27204096e-02 -3.22327986e-02 -5.03765419e-02
 -5.06257713e-02 -4.49864427e-04  2.47838404e-02 -3.27324010e-02
  2.88277138e-02 -2.81075202e-02  8.27860832e-02  9.20950156e-03
 -1.86004415e-02  4.84440364e-02  5.65795274e-03  4.33395952e-02
 -1.43907396e-02  8.12519491e-02  6.15745783e-03  5.64801693e-02
 -7.60760345e-03 -6.03133403e-02 -5.45320625e-04  4.48901998e-03
  1.27625773e-02 -3.59009043e-03  5.08363731e-02 -3.75050493e-02
 -1.09518170e-02  2.24867202e-02 -7.14393379e-03  2.51407214e-02
 -8.43567625e-02  8.02298710e-02 -3.00161131e-02 -7.11883232e-02
  8.83735484e-05 -7.36114429e-03  5.39998431e-03  2.63492838e-02
 -7.56773911e-03  2.49755960e-02 -4.08480540e-02 -1.87068582e-02
 -1.98941939e-02 -2.23302357e-02 -5.76192103e-02 -1.40154120e-02
  1.90270052e-03 -4.53555994e-02  9.48940217e-03 -4.30467799e-02
 -5.24503849e-02  5.13583347e-02  1.16480812e-02 -6.23722225e-02
  2.57353618e-34  1.15833320e-02 -1.10609243e-02  4.04441878e-02
  4.40702476e-02  1.62033481e-03 -2.62780674e-02 -2.14824714e-02
 -3.18818986e-02 -1.38188591e-02 -4.71120663e-02 -7.02951029e-02]"
"1
Introduction
Recurrent neural networks, long short-term memory [13] and gated recurrent [7] neural networks
in particular, have been firmly established as state of the art approaches in sequence modeling and
transduction problems such as language modeling and machine translation [35, 2, 5]. Numerous
efforts have since continued to push the boundaries of recurrent language models and encoder-decoder
architectures [38, 24, 15].
Recurrent models typically factor computation along the symbol positions of the input and output
sequences. Aligning the positions to steps in computation time, they generate a sequence of hidden
states ht, as a function of the previous hidden state ht−1 and the input for position t. This inherently
sequential nature precludes parallelization within training examples, which becomes critical at longer
sequence lengths, as memory constraints limit batching across examples. Recent work has achieved
significant improvements in computational efficiency through factorization tricks [21] and conditional
computation [32], while also improving model performance in case of the latter. The fundamental
constraint of sequential computation, however, remains.
 Attention mechanisms have become an integral part of compelling sequence modeling and transduc-
tion models in various tasks, allowing modeling of dependencies without regard to their distance in
the input or output sequences [2, 19]. In all but a few cases [27], however, such attention mechanisms
are used in conjunction with a recurrent network.
 In this work we propose the Transformer, a model architecture eschewing recurrence and instead
relying entirely on an attention mechanism to draw global dependencies between input and output.
 The Transformer allows for significantly more parallelization and can reach a new state of the art in
translation quality after being trained for as little as twelve hours on eight P100 GPUs.
 2
Background
The goal of reducing sequential computation also forms the foundation of the Extended Neural GPU
[16], ByteNet [18] and ConvS2S","[ 1.62406061e-02  6.59973994e-02 -1.05331913e-02  3.42396311e-02
 -2.71944832e-02 -2.62454711e-03  2.52647344e-02 -1.64903589e-02
 -4.41415459e-02 -1.83232073e-02  1.98039934e-02 -5.45265079e-02
  4.94529717e-02  5.12778983e-02  1.65851824e-02 -5.98750673e-02
  3.23703513e-02 -9.05052572e-03 -4.54864046e-03  2.05685608e-02
 -3.80114876e-02 -2.62112804e-02 -8.42791516e-03  3.36755514e-02
 -4.04934399e-03  2.23885267e-03 -1.90227684e-02 -2.22478583e-02
  1.83910187e-02 -2.68195812e-02 -2.25038007e-02  3.01342960e-02
  2.57923938e-02  4.37513664e-02  2.33540459e-06 -1.85205543e-04
  2.12665834e-02 -3.80679742e-02  2.34553926e-02 -7.84617383e-04
 -1.89733226e-02 -4.27592471e-02 -1.37570612e-02 -1.02001410e-02
 -3.94190289e-02 -3.89594100e-02  5.91212437e-02  7.87727255e-03
  4.31894287e-02  6.04581200e-02  9.01268562e-04 -4.07401547e-02
  2.95729656e-02 -5.79024367e-02  2.67784987e-02 -1.22835720e-02
  1.48109281e-02 -5.48924990e-02 -7.27364887e-03 -1.92745160e-02
 -5.79714254e-02  7.11655021e-02  5.00597022e-02  1.36954747e-02
  1.18427984e-02  3.39819305e-02  4.16353159e-02 -3.13857161e-02
 -3.68096270e-02  1.38646094e-02 -1.06710956e-01 -2.08352320e-02
  3.31397641e-05 -8.06581229e-03 -1.27705699e-02 -5.21016829e-02
 -3.02551333e-02  3.58303562e-02 -5.15006157e-03  5.29700983e-03
  2.98495255e-02 -3.90068674e-03  4.31370437e-02 -2.05178205e-02
 -1.91737767e-02  1.69540718e-02  2.42462251e-02 -1.42516475e-02
 -7.01671317e-02  1.47946877e-02 -1.10154541e-03 -5.65202497e-02
  7.13352636e-02  8.26082155e-02  1.17032463e-02  1.39335124e-02
 -2.84576081e-02 -6.00919686e-02 -1.67021528e-02 -4.55042347e-02
  1.33211678e-02  7.56402686e-02  2.21199375e-02  6.70504710e-03
 -3.44998986e-02  7.58568943e-02 -4.33189236e-02 -2.65290663e-02
 -3.44203413e-02  4.56684195e-02 -1.48044154e-02  1.65565088e-02
 -9.81354527e-03  2.31653713e-02 -4.22554389e-02 -2.55399998e-02
 -3.74204889e-02  1.48311984e-02 -2.63170246e-03 -2.78554522e-02
  1.73020381e-02  3.32299508e-02 -6.16568141e-02  1.67159624e-02
  3.43451509e-03  5.23642637e-02 -4.70696250e-03 -1.56475639e-03
 -3.27015971e-03 -4.88932244e-02 -3.55620682e-02  4.06153407e-03
  2.44111810e-02  1.74263481e-03 -3.23504843e-02  7.09723681e-02
  1.96121391e-02 -4.40995730e-02 -2.88296286e-02  1.32555440e-02
  1.55925140e-04 -5.23294397e-02  4.42409851e-02 -4.03811485e-02
  5.08518033e-02 -6.52007526e-03 -1.14337038e-02 -2.66331900e-02
  2.80980337e-02  3.71678583e-02  1.54353352e-02  5.57924286e-02
  2.57295873e-02 -4.16455045e-02  3.38394158e-02  1.73268635e-02
  2.92322692e-02  3.05403536e-03  6.38774112e-02  4.08722013e-02
 -4.17059399e-02 -3.67944390e-02  4.23528776e-02  1.87531710e-02
  1.04912249e-02 -2.49696313e-04 -4.56804261e-02 -5.03395982e-02
  8.19975790e-03  4.58675846e-02  4.07702588e-02  5.55314310e-02
 -5.05479425e-03 -1.83728319e-02  5.10062836e-02  3.21936533e-02
  2.29169782e-02  8.68506655e-02  7.14682713e-02 -2.82244142e-02
 -5.49563505e-02  1.74047668e-02 -2.56437846e-02  7.37361982e-02
  1.92192923e-02  2.38111150e-02  1.00622894e-02  5.78378513e-02
 -3.43465875e-03 -2.19128765e-02  2.87767686e-02 -2.06690468e-02
  2.70418841e-02 -1.76904611e-02  2.25373618e-02  1.98439602e-02
 -7.63556063e-02  5.69685847e-02 -5.77204220e-04 -5.35074249e-02
 -1.37152337e-02 -1.88964291e-03  4.73325932e-03  6.92613199e-02
  2.00815927e-02 -8.11278820e-03 -3.79320979e-02 -3.40813063e-02
 -4.37310673e-02  2.96788551e-02 -1.89256407e-02  2.45405287e-02
  1.63305178e-02 -5.79378940e-02 -1.23802768e-02  3.85531373e-02
 -1.82898901e-02  4.94976602e-02 -1.27363661e-02  1.71191804e-02
  2.00755931e-02  4.72296216e-02 -2.66118273e-02  1.80385616e-02
 -9.62428097e-03 -4.13675718e-02  2.47686598e-02  1.49840955e-02
  3.52999046e-02  3.10548674e-03  4.29309458e-02  2.43526939e-02
  5.77394143e-02 -8.18180293e-02 -1.00431005e-02  5.29189361e-03
 -1.06466420e-01 -3.16281393e-02  4.48287986e-02 -2.12090220e-02
  2.01037135e-02  2.10920628e-02 -3.02966256e-02 -7.19354376e-02
  6.48328736e-02 -8.40784386e-02  4.56467383e-02 -2.63286638e-03
  2.17597280e-02  2.70545073e-02  3.18312459e-02 -3.57015012e-03
  3.28595452e-02 -5.96547797e-02  3.15235443e-02  9.76162963e-03
  2.72007775e-03 -1.90500654e-02 -1.90222859e-02  2.84727314e-03
  2.72786170e-02 -1.09499153e-02 -5.67598548e-03  3.18214716e-03
 -1.32533936e-02 -2.89598899e-03 -1.64878741e-02 -3.93911675e-02
  1.15748225e-02 -5.89254405e-03  2.66583376e-02  1.96596719e-02
  4.26970869e-02  4.59296852e-02 -1.24399289e-02 -3.47641967e-02
  2.35509872e-02 -7.48390332e-03  7.12759234e-03  2.70194579e-02
  6.09046605e-04 -4.35869396e-02 -2.39506792e-02 -4.47714999e-02
  2.34663067e-03  6.37937114e-02 -1.86563227e-02 -7.02838749e-02
 -4.33993004e-02 -9.25548933e-03  1.23156339e-03  6.26023859e-02
 -9.27005243e-03 -4.59767841e-02  4.03741840e-03  2.06967909e-03
  5.59727624e-02  3.37895304e-02  2.48298869e-02 -8.75418354e-03
  2.11857762e-02 -3.32272276e-02 -8.99898168e-03  2.41058543e-02
 -3.24218683e-02  3.05657890e-02  8.26309994e-03 -7.37339724e-03
 -4.44292277e-02  1.02858447e-01 -6.19421853e-03  5.33498451e-03
 -7.07982779e-02 -2.06586644e-02  1.52484525e-03 -4.21478413e-02
  8.49259086e-03 -4.00323905e-02 -3.29186693e-02  7.48111168e-03
 -1.41487811e-02 -3.31303328e-02  3.48854139e-02 -4.79049422e-02
  6.79208431e-03 -3.11762802e-02  1.42903114e-02 -2.29387376e-02
  5.04718199e-02  3.46744880e-02  1.52125112e-05 -2.97771897e-02
 -2.45236363e-02  2.17111502e-02  5.68058155e-02 -5.24074882e-02
 -2.42438223e-02  3.39699686e-02 -3.78086530e-02 -1.02367299e-02
 -2.81575397e-02 -3.04655302e-02 -2.63307672e-02  5.82548939e-02
 -9.32422187e-03 -6.84374152e-03  1.62305459e-02 -4.32251841e-02
 -2.61975359e-02  3.49146500e-02  1.80009715e-02  7.88868070e-02
 -1.32732335e-02  1.66029409e-02 -2.15763468e-02  3.20568383e-02
  1.32205924e-02  9.93849616e-03  1.32259016e-03 -5.27683739e-03
 -5.79228951e-03  3.89297307e-02  4.32717353e-02 -9.53052472e-03
 -7.40943179e-02 -3.98845971e-03  2.23923959e-02 -1.93442423e-02
 -4.05576127e-03  2.56961733e-02 -2.28915140e-02 -1.22548081e-01
 -3.94874290e-02  8.27866942e-02  6.62412262e-03 -5.17588519e-02
  1.65658910e-02  4.95255440e-02 -1.02569787e-02  1.42422440e-02
 -5.35824243e-03 -5.95624372e-02 -9.72660352e-03  1.33243492e-02
 -2.41582450e-02  1.74429100e-02 -1.74227599e-02 -1.06666833e-02
 -6.44598901e-02  2.48462036e-02  2.42544599e-02 -4.39942293e-02
 -6.59673735e-02 -4.43796255e-02 -4.10579257e-02  4.01501078e-03
 -2.08218750e-02  1.31186675e-02  2.68046348e-03  5.85211348e-03
  7.98685197e-03  1.01546606e-03  8.91691539e-03 -6.15056185e-03
 -2.78905239e-02 -1.95517596e-02  5.59524633e-02  1.99799016e-02
  2.49831136e-02 -7.93238357e-02  1.11168018e-02  1.74626336e-02
  3.53393257e-02 -9.62349959e-03 -7.18133788e-06 -1.42119536e-02
 -1.84072889e-02 -1.33570749e-02  4.34598094e-03 -8.40286165e-02
 -1.55117363e-02 -1.97801124e-02  7.96985775e-02 -1.01431906e-02
 -2.36402396e-02 -2.20652130e-02 -1.01720297e-03  2.27249283e-02
  3.92469540e-02  4.80809361e-02 -5.89794628e-02 -6.00598454e-02
 -3.35835256e-02 -6.03280170e-03 -7.63208047e-02 -3.74493450e-02
 -2.80636381e-02  6.34589493e-02 -6.67732283e-02 -5.86022101e-02
 -4.29955423e-02 -4.87091253e-03  2.65345834e-02  2.54799314e-02
 -1.02948071e-03  6.14067353e-02 -2.94698123e-02 -6.51181489e-02
 -1.30767561e-03 -4.23159404e-03  1.11257909e-02 -3.58153768e-02
  3.00489422e-02  1.52679924e-02 -9.92909167e-03  1.02358265e-03
  5.16640954e-02 -1.31598115e-01 -2.80427337e-02  2.02886425e-02
  5.37437201e-02  1.41076408e-02  3.14179771e-02 -1.09676924e-02
  1.61165162e-03  3.06743244e-03  5.29443286e-03 -3.72175053e-02
  2.63468716e-02  1.33651318e-02 -2.55011879e-02  1.38812396e-03
  7.05971383e-03  3.63011146e-03  2.02225279e-02  2.38791630e-02
  4.03788835e-02 -1.78187378e-02 -4.44474816e-02  9.40096192e-03
 -3.59275714e-02  5.73412888e-02  1.46460580e-02  1.58212222e-02
 -5.80900488e-03  4.52973843e-02  1.08825853e-02  4.57271896e-02
 -4.69695553e-02  6.64271787e-03  5.47644049e-02  2.94388216e-02
  3.95920733e-03 -3.68958861e-02  5.40940724e-02 -6.42313659e-02
 -2.20169723e-02  4.84956391e-02 -1.39841633e-02  8.47165193e-03
  2.42645433e-03 -5.11583267e-03 -2.84888074e-02  1.61387697e-02
 -1.04055312e-02  2.43503917e-02 -2.81959828e-02  3.32472622e-02
  1.80514082e-02  3.90051194e-02 -3.03659309e-02  2.32808292e-02
 -3.81158851e-02 -3.25744152e-02 -2.95588542e-02 -1.31916022e-02
  7.42996782e-02 -2.21568383e-02  4.31007184e-02  1.58778727e-02
  1.67186260e-02 -2.67189331e-02  3.29846106e-02 -5.29683148e-03
 -2.98394784e-02  4.76707332e-03  2.70764735e-02 -8.35943129e-03
  1.94778852e-02  6.07001893e-02 -1.60525441e-02  3.10662873e-02
  3.70456129e-02  1.86708756e-02 -2.18230803e-02 -3.93281654e-02
 -4.70509492e-02 -2.82910094e-03 -1.33613320e-02  7.16659764e-04
 -3.28208506e-03 -5.19496277e-02  3.01562063e-02 -1.66188367e-02
  2.82537136e-02 -2.62985379e-02  3.67042050e-02 -1.22059532e-03
 -1.59447882e-02 -1.53707564e-02 -2.05667857e-02  4.65381145e-02
  9.40908585e-03 -4.65175435e-02 -2.86314581e-02 -6.55387251e-33
 -1.57106202e-02 -5.96512109e-03  2.76364442e-02 -1.76653126e-03
 -1.93425100e-02  2.75336904e-03 -7.03568310e-02 -2.59759929e-02
  1.30871506e-02 -2.17071772e-02 -1.80493034e-02  8.94687511e-03
  6.35297690e-03  4.09114920e-02  6.64067268e-02  3.76981404e-03
  6.12989068e-02  1.01426095e-02  1.43691180e-02  2.26345249e-02
  5.57309091e-02  6.05345070e-02  6.34917840e-02 -2.74614897e-02
 -3.92309949e-02 -1.91605166e-02  3.30045894e-02 -1.48375668e-02
 -1.40085388e-02  1.14145018e-02 -4.93818186e-02  9.36436187e-03
  3.95863168e-02 -9.44480076e-02 -4.64403816e-02  3.80012169e-02
 -1.01100549e-01 -1.59466621e-02 -2.00352948e-02  1.39019089e-02
 -6.85550496e-02 -6.06812611e-02  7.81000182e-02  3.61978933e-02
  2.53151208e-02 -2.30787732e-02 -1.96440537e-02 -2.23817341e-02
 -5.18497266e-02 -2.99740322e-02 -6.15389273e-02  1.25720184e-02
 -1.37693463e-02  2.54157255e-03  6.54197782e-02  3.14711183e-02
 -4.44393046e-02 -1.47933364e-02 -9.05968770e-02 -7.72175379e-03
  3.46246101e-02  7.88846090e-02  5.25161363e-02  1.99053828e-02
  2.13579610e-02 -6.32417714e-03  3.65932919e-02 -2.94942260e-02
 -2.88752224e-02  4.01494764e-02 -9.41984181e-04  8.30335636e-03
  5.61382174e-02 -5.87770678e-02  7.82632008e-02 -2.94947978e-02
 -5.70407771e-02 -4.02317196e-02 -1.26729142e-02  6.38034418e-02
  3.86580527e-02  4.48298939e-02 -1.39750745e-02 -9.38542839e-03
  4.01764130e-03  9.07227769e-03 -2.98875049e-02 -2.65388824e-02
  2.18089614e-02  2.77858991e-02  3.19029368e-03  8.30378663e-03
  3.45894322e-02  9.81628313e-04  5.84288165e-02  5.09635825e-03
  4.66326959e-02  2.01004427e-02  1.85232591e-02  1.92964841e-02
 -3.54782864e-02  7.80555513e-03  1.16059417e-02 -5.53547288e-04
  1.12841576e-02 -1.24197351e-02  1.29665965e-02  4.74155657e-02
 -4.35363874e-02 -3.49940583e-02 -6.97501749e-02  2.43036188e-02
  2.56597884e-02  6.15872853e-02  6.29551783e-02 -5.23151690e-03
 -1.72942933e-02  4.78811599e-02 -4.14625779e-02 -2.97132670e-03
 -2.41566356e-03  2.15731636e-02  1.28318314e-02  4.30232212e-02
 -4.18186635e-02 -4.37967367e-02 -5.69540523e-02  6.38575554e-02
  2.28388757e-02 -7.52476826e-02 -3.94139551e-02  5.25568463e-02
  3.13935971e-07  1.33183626e-02  3.39048989e-02  5.93644641e-02
 -5.80804981e-03  4.74325120e-02 -1.14129949e-02  1.64848709e-04
  3.33593003e-02  2.09839288e-02  5.66562731e-03  3.80409621e-02
  9.11231525e-03  1.84733849e-02 -1.45549597e-02 -7.66443014e-02
 -3.71717140e-02 -5.79124168e-02  2.27432679e-02 -1.02763698e-02
 -1.31867817e-02 -1.18585285e-02  1.03779785e-01  8.24071991e-04
  2.66583054e-03  3.40106823e-02 -1.83450489e-03  2.47841068e-02
  1.04842894e-02  2.96749510e-02 -2.98632924e-02  9.28198826e-03
  3.00798891e-03 -5.53952716e-02 -7.11021991e-03 -1.75717268e-02
  2.20293347e-02  3.88549711e-03  6.25256374e-02 -9.16742906e-03
 -3.35249305e-02  2.76443902e-02 -1.48094911e-02 -1.30748609e-02
 -2.92048678e-02  1.69072133e-02 -3.87622118e-02 -1.05788335e-02
  9.63448454e-03 -1.14207938e-02  4.36577648e-02 -3.20092309e-03
  3.99777573e-03  4.43715490e-02  8.88439012e-04  4.86598909e-03
 -4.28974722e-03 -2.65700649e-02 -5.99480309e-02 -8.75147246e-03
 -9.62417386e-03 -6.47964254e-02  1.90222263e-02 -9.46868211e-02
 -1.03219403e-02  4.58310209e-02 -5.23244031e-03 -4.91749160e-02
  2.76033188e-34  6.87412918e-03 -4.53842655e-02  1.90583877e-02
  2.93522626e-02  3.42282243e-02 -3.42573896e-02 -6.00209571e-02
  1.64624788e-02  1.27620273e-03 -7.09546804e-02 -6.95887282e-02]"
"[9], all of which use convolutional neural networks as basic building
block, computing hidden representations in parallel for all input and output positions. In these models,
the number of operations required to relate signals from two arbitrary input or output positions grows
in the distance between positions, linearly for ConvS2S and logarithmically for ByteNet. This makes
it more difficult to learn dependencies between distant positions [12]. In the Transformer this is
reduced to a constant number of operations, albeit at the cost of reduced effective resolution due
to averaging attention-weighted positions, an effect we counteract with Multi-Head Attention as
described in section 3.2.
 Self-attention, sometimes called intra-attention is an attention mechanism relating different positions
of a single sequence in order to compute a representation of the sequence. Self-attention has been
used successfully in a variety of tasks including reading comprehension, abstractive summarization,
textual entailment and learning task-independent sentence representations [4, 27, 28, 22].
End-to-end memory networks are based on a recurrent attention mechanism instead of sequence-
aligned recurrence and have been shown to perform well on simple-language question answering and
language modeling tasks [34].
 To the best of our knowledge, however, the Transformer is the first transduction model relying
entirely on self-attention to compute representations of its input and output without using sequence-
aligned RNNs or convolution. In the following sections, we will describe the Transformer, motivate
self-attention and discuss its advantages over models such as [17, 18] and [9].
3
Model Architecture
Most competitive neural sequence transduction models have an encoder-decoder structure [5, 2, 35].
 Here, the encoder maps an input sequence of symbol representations (x1, ..., xn) to a sequence
of continuous representations z = (z1, ..., zn).","[ 1.49682816e-02  1.02942809e-03 -7.36316573e-03  3.93184498e-02
 -4.14400324e-02 -7.00485008e-03  3.26755270e-02 -2.89570410e-02
 -2.45444849e-02 -2.58996431e-02 -1.95134822e-02 -1.29793352e-02
  2.58811638e-02  7.94793572e-03  2.44451538e-02 -2.22669188e-02
  5.98775186e-02  1.68681517e-02 -2.25343276e-02  7.33669894e-03
 -2.34162901e-02 -8.71006865e-03  7.21760513e-03  3.53129990e-02
  3.31515539e-03 -3.07128020e-02 -2.65047606e-02 -2.57601328e-02
  2.51764692e-02 -1.14540728e-02 -1.09822082e-03  5.21300733e-02
  4.86944653e-02  2.73665227e-02  2.11866518e-06 -5.72237512e-03
 -3.45699838e-03 -2.58342475e-02 -2.25672801e-03 -1.11159459e-02
 -2.91408822e-02 -4.17282917e-02  1.41535944e-03  6.62723032e-04
 -4.71097045e-02  1.43148890e-03  5.05210385e-02  1.62489731e-02
  7.62535259e-02  7.78211206e-02  4.86970413e-03 -7.12199435e-02
  3.08289919e-02 -4.90127616e-02  4.81363013e-03 -8.71997979e-03
 -4.88056103e-03 -3.47149782e-02 -2.71068122e-02  2.62253061e-02
 -4.84774783e-02  5.72703741e-02  5.01177162e-02  1.82091165e-02
  1.96914319e-02  3.38046737e-02 -1.43068153e-02 -1.75054241e-02
 -3.47523838e-02  5.54525182e-02 -8.49189982e-02 -4.26260009e-02
 -3.83530254e-03  8.70375615e-03  1.66317597e-02 -1.89183932e-02
 -3.73430662e-02  3.99796627e-02  5.90034993e-03  3.06739248e-02
  1.48708941e-02  2.43897513e-02  1.23316422e-03 -2.20424961e-02
 -3.39648612e-02  1.51418308e-02 -1.40192453e-02  1.36839761e-03
 -4.32561003e-02 -2.94960430e-03 -1.48078715e-02 -2.39780508e-02
  3.45869698e-02  7.64424205e-02  4.60961424e-02  3.46563291e-03
 -2.65591517e-02 -6.57190681e-02 -7.30247935e-03 -8.48210678e-02
  4.29627858e-02  6.27512783e-02  7.93509558e-03  2.27807630e-02
 -6.33511692e-02  8.81653428e-02 -4.54671159e-02  3.33481468e-02
 -4.76472154e-02  1.79795641e-02 -1.56309567e-02 -1.63723459e-03
 -7.01322183e-02  5.25098853e-02 -2.06739344e-02 -4.05266955e-02
 -1.95764992e-02  4.03866991e-02 -5.37113613e-03 -1.91079210e-02
  1.14505878e-02  4.10674550e-02 -3.88265140e-02 -1.74312014e-02
  3.18399668e-02  6.04385547e-02 -2.35519540e-02 -3.33356857e-02
  1.62871145e-02 -2.73434110e-02 -3.73419262e-02  6.69846823e-03
  1.93252657e-02  2.32002407e-04 -1.11121852e-02  8.78967121e-02
 -2.41955388e-02 -5.08649312e-02 -7.36379158e-03  1.14185840e-03
 -1.99563075e-02 -4.92461435e-02  4.60651629e-02 -4.67519797e-02
  3.12217847e-02 -9.07604641e-04 -2.68011913e-02 -3.76547910e-02
  1.72985010e-02  3.55844125e-02 -4.15922143e-03  4.90954518e-02
  3.52885500e-02 -2.86131091e-02  3.73276733e-02  5.65497531e-03
  2.12129951e-02  2.96923425e-02  6.16223514e-02  4.02688906e-02
 -2.53793448e-02 -4.55189608e-02 -3.64372716e-03  8.88738502e-03
  2.53663696e-02 -3.12910862e-02 -3.56459990e-02 -2.10309937e-03
 -3.01936385e-03  3.26517858e-02  2.64200121e-02  1.82877015e-02
 -1.32343443e-02 -6.60670772e-02  5.32412045e-02  3.83061580e-02
  6.51693270e-02  3.75085250e-02  4.47271317e-02  1.35991266e-02
  9.08011920e-04  1.85524616e-02 -4.00409885e-02  1.05119258e-01
 -3.82309244e-03  1.44360764e-02 -2.89106363e-04  1.67102814e-02
 -1.97304580e-02 -4.44398895e-02  2.43203677e-02  1.25540476e-02
 -9.07908939e-03  8.97166133e-03  2.67460290e-02  2.86790617e-02
 -7.15413243e-02  4.38160375e-02 -2.96026748e-02 -2.24873442e-02
 -1.71105508e-02 -3.77755985e-02  8.99280421e-03  2.82169562e-02
  1.14093293e-02 -2.18092818e-02 -3.41071375e-02 -1.88738722e-02
 -2.16059033e-02  5.23489788e-02  2.56429911e-02  2.37409249e-02
 -3.63852456e-02 -4.84156422e-02 -9.26312804e-03 -3.46419774e-03
 -1.74951982e-02  4.54246402e-02 -1.71057247e-02 -1.53610366e-03
  1.87525637e-02  2.09151562e-02  2.44425349e-02  2.04464290e-02
  9.66443308e-03 -3.79468910e-02  1.04982322e-02  1.28139071e-02
  4.02579196e-02  5.86212566e-03  2.94339545e-02  3.90342213e-02
  5.69289662e-02 -5.52715287e-02 -7.45667203e-04  7.21743703e-03
 -9.10593644e-02 -5.98013699e-02  1.74947754e-02 -4.90896851e-02
  5.53156668e-03  6.04026467e-02 -1.31020909e-02 -5.96310981e-02
  4.56604362e-02 -8.58241618e-02  2.29848661e-02 -2.24306080e-02
 -2.90293625e-04  5.14170267e-02  5.12877144e-02 -1.32810613e-02
  4.01486345e-02 -2.63004526e-02  6.62901113e-03 -7.79079832e-03
  1.72229502e-02  9.00250301e-03 -2.53333915e-02  1.47306640e-02
  6.82286406e-03 -2.57795099e-02 -5.36891492e-03  3.71857570e-03
 -4.10534479e-02 -1.57160405e-02 -4.77672517e-02 -4.20241803e-02
  7.60823209e-03 -1.65939070e-02  2.62568351e-02  3.90918776e-02
  1.30044539e-02  4.32485156e-02 -8.73071514e-03 -5.74461222e-02
  4.65543531e-02 -2.23055808e-03  3.22852330e-03  6.45835996e-02
 -1.82296596e-02 -3.73245380e-03 -3.48117575e-02 -6.15858212e-02
 -2.47407984e-02  6.91508204e-02 -1.19411647e-02 -2.12629363e-02
 -6.17888570e-02 -2.89722458e-02  1.72920488e-02  2.91442517e-02
 -2.35580187e-02 -6.63718432e-02  1.41343093e-02 -1.64666660e-02
  4.62773070e-02  9.56262350e-02  5.66022694e-02  2.25955038e-03
  2.86614075e-02 -2.19852328e-02 -4.35890965e-02  2.60666218e-02
 -3.82818095e-02  3.81995738e-02 -2.18855753e-03 -7.28412019e-03
 -3.05575412e-02  8.73547494e-02  9.34943650e-03 -6.99236058e-03
 -6.50756061e-02  2.74561695e-03  3.39371413e-02 -4.28202115e-02
 -5.55201992e-03 -3.02475430e-02 -2.97510494e-02  1.79532287e-03
 -2.85582431e-02 -5.85666159e-03  2.72673871e-02 -2.55717635e-02
 -1.24601955e-02 -2.27579065e-02  1.06052337e-02 -3.86338308e-02
  7.99268559e-02  5.05139120e-02  1.85455494e-02  2.17761938e-02
 -4.45649177e-02 -3.47304568e-02  1.79220736e-02  1.44918985e-03
 -3.29822339e-02  3.98470722e-02 -2.59873806e-03  1.50153833e-03
 -2.88334768e-02  5.58893010e-03 -3.29041667e-02  8.07760656e-03
  2.63475609e-04  7.67062325e-03  6.85805362e-03 -1.84127260e-02
 -6.35066777e-02  3.14685404e-02  2.61237342e-02  6.66340366e-02
 -1.26854936e-02  1.46540329e-02 -3.64188887e-02  5.69684096e-02
  2.18654871e-02  5.86657599e-02  4.03675102e-02  4.28106589e-03
  2.42650509e-02  6.48311228e-02  1.20587414e-02 -1.56233143e-02
 -3.63872349e-02  2.50545759e-02  1.62007716e-02 -5.87813184e-02
 -2.68777204e-03  7.38802087e-03  2.48154514e-02 -1.13625944e-01
 -3.94977108e-02  1.04349226e-01  9.01391450e-03 -2.68551260e-02
  9.43367090e-03  1.56782549e-02 -2.80693192e-02  1.91748105e-02
  1.99345965e-02 -6.17486574e-02 -2.29154378e-02  7.98464927e-04
 -2.32191812e-02  3.61761265e-02 -8.06933828e-03 -3.37786763e-03
 -6.14897124e-02  2.78283805e-02  8.91554542e-03 -6.87535778e-02
 -2.94439960e-02  5.19458391e-03 -1.69591550e-02  1.43860159e-02
 -5.64291375e-03  3.37330475e-02 -2.11851541e-02 -1.76548660e-02
 -3.98524478e-03 -2.23257262e-02  3.87491509e-02  7.90067669e-03
 -3.84711241e-03 -2.28410144e-03  6.25963584e-02  3.07008885e-02
  8.72816425e-03 -2.71050427e-02  3.58401518e-03 -2.86894888e-02
  3.15111540e-02  9.93594527e-03  5.69392443e-02 -1.23372516e-02
 -2.69285738e-02 -1.97835248e-02 -6.02620654e-04 -7.09227026e-02
 -2.29702704e-03 -4.56066430e-02  4.77207787e-02  6.05844893e-03
 -4.19969112e-02 -5.31699620e-02  2.54402719e-02 -2.80438047e-02
  5.13509847e-02  2.65736561e-02 -4.82423827e-02 -7.19962344e-02
 -6.61958288e-03  2.98804250e-02 -7.39874169e-02 -6.07142262e-02
  3.14629357e-03  7.20417276e-02 -7.50390440e-02 -6.25285283e-02
 -6.30072057e-02 -2.12734914e-03  2.55686548e-02  1.24052749e-03
 -3.07079367e-02  4.44658697e-02 -1.00157904e-02 -5.54277599e-02
 -7.21385441e-05  7.85785075e-03 -7.60567235e-03 -3.50513682e-02
  3.41839269e-02  4.96770814e-02 -3.49756926e-02 -1.83630642e-02
  3.46859805e-02 -9.45649073e-02 -3.13528106e-02  6.66937698e-03
  7.45522156e-02  1.41015537e-02  2.85138134e-02 -1.26484605e-02
  2.34325267e-02  4.18784767e-02 -7.18897022e-03 -2.90809572e-02
  1.55482190e-02  2.50458755e-02 -2.99209114e-02 -1.27450228e-02
  2.31101960e-02  1.30678015e-02  4.56595719e-02  7.94251449e-03
  2.67765131e-02 -3.17827985e-02 -5.73382415e-02  4.08690274e-02
 -3.91086042e-02  3.70419919e-02  4.62635793e-02  4.93752994e-02
  6.78361207e-03  3.18484642e-02 -1.28327087e-02  2.81217005e-02
 -4.85876128e-02  1.27433725e-02  1.89328045e-02 -2.09545274e-03
  1.17781013e-02 -7.83443917e-03  4.05112803e-02 -3.71735170e-02
 -2.94496352e-03  5.92222512e-02 -2.47723777e-02  1.89511254e-02
 -3.98347750e-02  8.65215715e-03 -2.03328691e-02 -5.06611308e-03
  3.46193090e-03  2.45723091e-02 -2.36583892e-02  8.16447381e-03
  3.09053585e-02  2.87217293e-02 -3.27081829e-02  3.46119441e-02
 -8.83426294e-02  3.23421918e-02 -2.32331045e-02 -1.09709464e-02
  4.99780215e-02 -5.67103364e-03  2.97346730e-02  2.09884215e-02
  1.80777302e-03 -4.35832096e-03  2.80015878e-02 -2.57455893e-02
  1.25413146e-02 -1.10201063e-02  2.58080959e-02  1.68383084e-02
 -5.27260900e-02  5.90209216e-02 -3.41724791e-02  2.89138500e-02
  4.29989882e-02  1.30992197e-02 -6.45632669e-02 -1.92641318e-02
 -4.09061685e-02  1.08324690e-02 -1.80035236e-03  8.17590917e-04
 -6.60212291e-03 -4.94581982e-02  5.51332645e-02  1.46778347e-02
  2.24049855e-02 -9.79772676e-03  3.57083566e-02  1.49924755e-02
  1.50039634e-02 -5.58848120e-02 -2.03973297e-02  5.07530719e-02
 -6.67752884e-03 -4.02821042e-02 -2.07567904e-02 -6.56438290e-33
 -1.16759297e-02 -1.66149307e-02  6.36750658e-04 -1.36810485e-02
 -3.90803367e-02 -1.52135808e-02 -3.90237048e-02 -1.10750468e-02
 -2.80435365e-02 -3.83563619e-03 -2.85246074e-02  1.09409653e-02
 -7.00556382e-04  1.09066814e-02  5.84511869e-02 -6.93533057e-03
  4.10170406e-02 -1.53771937e-02  3.78346629e-03  1.62808914e-02
  3.59396040e-02  4.65926006e-02  7.71502703e-02 -1.28243798e-02
 -3.30852643e-02 -7.93969072e-03  1.77169833e-02 -1.24148382e-02
 -2.51143761e-02  3.64654697e-02 -8.50945711e-03  1.79359745e-02
  3.72702405e-02 -6.43342808e-02 -3.90618183e-02  6.32933155e-02
 -1.32873788e-01 -3.62645686e-02 -4.02140692e-02  7.87180848e-03
 -6.28754571e-02 -4.76770885e-02  9.66792330e-02 -1.26955379e-02
  2.10532211e-02 -5.87514266e-02  1.00874370e-02 -1.80502683e-02
 -2.12278701e-02 -5.99193852e-03 -3.35139371e-02  1.15326932e-03
 -2.51879618e-02 -2.55255122e-02  2.78346520e-02  6.62559271e-02
 -3.50024016e-03  1.75674669e-02 -8.86332467e-02  1.26060424e-02
 -8.38724431e-03  7.17605054e-02  3.62889506e-02  2.13721450e-02
  1.42856350e-03 -8.19732901e-03  2.84019541e-02 -4.36666273e-02
 -3.65722217e-02 -1.44141521e-02  2.92986562e-03  2.55648233e-02
  9.10707340e-02 -3.20509002e-02  6.69633821e-02  5.81932720e-03
 -6.92000762e-02 -6.46680966e-03 -6.82206650e-04  4.05814424e-02
  1.49799073e-02  1.43061986e-03 -2.14520004e-02  1.36677735e-02
  5.30298194e-03  1.75743811e-02 -2.68767457e-02 -3.74609232e-02
  3.25431004e-02 -9.94993388e-05 -6.77044131e-03  4.94293943e-02
  2.64071971e-02 -4.46187556e-02  3.88549231e-02  2.73326952e-02
  2.45600641e-02  2.40021646e-02  2.17793621e-02  3.22313644e-02
 -4.80984412e-02  2.18718275e-02  5.62653923e-03  1.33073796e-02
 -7.83705898e-03  1.13848662e-02  1.83398426e-02  3.85696515e-02
 -5.76211847e-02 -4.38080058e-02 -3.90996672e-02  1.73803791e-02
 -9.73905157e-03  2.16823835e-02  3.44694592e-02 -4.16135089e-03
 -2.35231854e-02  2.43511610e-02 -3.62052731e-02 -1.42366644e-02
 -2.86133531e-02  4.13536504e-02 -8.22859909e-03  4.12690789e-02
 -3.46876844e-03  5.49931079e-03 -6.42915294e-02  9.68691707e-02
  4.39545251e-02 -6.14631176e-02 -1.62897557e-02  6.95001185e-02
  2.97324902e-07  3.92412171e-02  2.41621900e-02  6.37486205e-02
  1.00991474e-02  1.94659904e-02  1.10340556e-02 -4.97227069e-04
  6.34796172e-02  7.80875375e-03 -1.96503960e-02  1.51720783e-02
  4.97812741e-02  6.23188121e-03  2.86897790e-04 -5.93147092e-02
 -2.44490784e-02 -6.12900704e-02  3.79741304e-02  9.31932870e-03
  1.65493209e-02  4.12943140e-02  1.00153968e-01 -6.98706787e-03
 -6.14368869e-03 -2.64157983e-03  1.47564081e-03  6.01228215e-02
  2.03067008e-02  3.66481692e-02 -1.13122154e-03 -3.93701426e-04
 -1.40299993e-02 -4.20413166e-02 -5.64065855e-03 -1.89086702e-02
  1.13961352e-02  1.86544843e-02  5.73684322e-03 -2.21408457e-02
 -6.22824728e-02 -3.94450640e-03  7.45287724e-03  2.02658717e-04
 -1.99860018e-02  5.68644702e-02 -1.21295758e-01 -4.77229692e-02
  4.15861839e-03 -3.38900760e-02  3.20473462e-02 -5.39739663e-03
  1.57341044e-02  8.90978612e-03  1.23485168e-02  1.79183017e-02
 -1.88709814e-02  4.70175315e-03 -1.01260468e-01 -3.90884615e-02
  2.28605443e-03 -5.82237542e-02  3.34138386e-02 -9.00270864e-02
 -2.11389996e-02  6.21210709e-02 -9.39904433e-03 -6.19896203e-02
  2.24362061e-34 -1.37991663e-02 -3.22022960e-02  8.92785005e-03
  2.57354546e-02 -2.80190855e-02 -1.90314278e-02 -4.53898795e-02
  3.26490984e-03  2.02060584e-02 -7.00313598e-02 -6.58315793e-02]"
"Given z, the decoder then generates an output
sequence (y1, ..., ym) of symbols one element at a time. At each step the model is auto-regressive
[10], consuming the previously generated symbols as additional input when generating the next.
 2
","[-2.50041205e-02  4.78062145e-02 -6.24867668e-03  9.39213857e-03
 -9.09747649e-03  4.24219258e-02  1.15749531e-03  1.48041546e-02
 -7.92246386e-02  2.19712760e-02  6.15766272e-02  2.28799861e-02
  2.22258288e-02  7.15931505e-02  4.05991264e-02 -8.24238732e-03
  1.67249609e-02 -2.12850552e-02 -1.52645186e-02 -2.45447494e-02
 -3.18645537e-02 -2.46692952e-02  7.73492316e-03  4.17307615e-02
  7.72605930e-03 -2.70605907e-02 -1.00284070e-02 -7.71267945e-03
 -6.95562139e-02 -2.27919370e-02 -5.20063005e-02  4.87378612e-02
  3.98857109e-02 -1.07830833e-03  1.43839486e-06 -5.86658996e-03
 -4.07770276e-02 -1.79273486e-02 -7.58275986e-02 -3.43045034e-03
 -1.25853643e-02 -5.70112839e-02 -3.30605060e-02 -5.44550596e-03
 -1.16838049e-02 -6.41029924e-02  5.56914136e-02 -2.11952515e-02
  4.69598509e-02  3.37475501e-02  1.42091913e-02 -3.17926183e-02
  2.41648201e-02 -1.75118707e-02  1.35552287e-02 -5.02063669e-02
  4.78817821e-02 -7.63007766e-03 -5.37678562e-02  1.21434815e-02
 -2.90235467e-02  3.10169142e-02  3.10947783e-02 -3.39830443e-02
  3.35428379e-02 -1.89903204e-03  8.39202255e-02 -7.59252533e-02
 -2.98621301e-02 -2.06922123e-04  3.08535807e-02 -4.91320640e-02
 -2.53786761e-02  1.67195387e-02 -1.08007127e-02 -2.21352894e-02
 -4.50785235e-02  1.72165390e-02 -6.31927326e-03  2.27111708e-02
  1.81136038e-02  5.57538420e-02 -1.05264997e-02 -4.34081592e-02
 -4.62857001e-02  6.43826127e-02  3.22676403e-03  2.34116381e-03
 -4.82935384e-02  2.94649228e-02  3.80135104e-02 -3.76068354e-02
  1.75681636e-02  3.08863465e-02  1.17943890e-03  9.86982696e-03
 -3.14155072e-02 -6.56710714e-02 -3.13155390e-02 -2.86699478e-02
  5.47184125e-02  4.35870774e-02  4.83437628e-02 -2.43071616e-02
  3.69891301e-02  5.19276485e-02 -6.55091647e-03 -2.41844002e-02
 -4.18368913e-02  3.08911800e-02  1.53737320e-02 -6.35784492e-02
 -7.68212974e-02  5.79167306e-02  2.56818086e-02  8.75762571e-03
 -3.05130202e-02  1.05033126e-02 -4.39270213e-03 -5.21737896e-03
 -1.54224113e-02 -1.71533152e-02 -7.37200677e-02 -1.45861367e-03
 -2.28929128e-02  4.56845276e-02 -2.70831604e-02 -8.66995752e-03
  2.51872614e-02 -1.89878270e-02 -1.47162229e-02 -3.39201987e-02
  2.40796451e-02  2.21268311e-02 -5.51559664e-02  3.07386424e-02
  8.40917404e-04  3.08466200e-02 -1.20368050e-02 -5.62643483e-02
  3.04507166e-02 -2.56483797e-02  1.70269143e-02 -3.92371528e-02
 -7.03860819e-03  4.71286401e-02 -9.45946667e-03 -5.03693111e-02
 -1.96895674e-02 -1.61161423e-02  3.09567396e-02  3.28450464e-02
 -3.34862508e-02 -1.61855929e-02  8.74591526e-03 -1.64638702e-02
  5.73700070e-02  6.93420023e-02 -4.09107562e-03 -8.85461923e-03
 -2.65630037e-02 -1.92696955e-02  1.72042511e-02  2.60830186e-02
  2.82006226e-02 -7.20464764e-03 -6.86321184e-02 -4.96508814e-02
  2.42433045e-02  6.89740572e-03  4.73080799e-02  1.22256838e-02
 -4.91962507e-02 -2.42942013e-02  8.77251942e-03  7.73360804e-02
  1.23817042e-01  6.52749315e-02  1.56934317e-02 -4.27081296e-03
  3.34013216e-02  5.34880161e-02  2.54762340e-02  3.94073911e-02
 -3.33075114e-02 -1.08318143e-02 -3.08519788e-02  5.28534502e-02
 -3.32113206e-02 -6.18878454e-02  1.75088439e-02 -2.91244971e-04
  7.25173810e-03 -4.70220447e-02  4.47939746e-02  3.02928071e-02
 -4.67732064e-02 -8.80630407e-03  6.15809299e-03 -2.79264245e-02
  5.91701455e-03 -2.84104161e-02  4.77803610e-02  4.11696620e-02
  2.95263790e-02  2.69265287e-02  2.97076441e-02 -2.22209822e-02
 -3.78723443e-02  1.78702231e-02 -9.12604574e-03 -1.42581165e-02
  1.61229447e-02  1.67946774e-03 -7.55149722e-02  1.01183087e-01
  1.94123480e-02  5.25626801e-02 -7.70107955e-02 -2.01779194e-02
 -1.90938171e-02  4.61609699e-02  1.27869919e-02 -1.04932236e-02
 -4.84654531e-02 -2.94607095e-02 -1.31194033e-02  9.28490423e-03
 -1.38589656e-02  4.62362990e-02 -1.00613404e-02  5.48129454e-02
  5.13185412e-02 -5.10023870e-02 -3.42886150e-02 -1.13652730e-02
 -6.66898116e-02 -2.71335524e-02  5.74495643e-02 -2.68473923e-02
  4.88374308e-02  3.03811990e-02  3.38537544e-02 -2.72457711e-02
  7.67275617e-02 -3.75144035e-02  4.78417166e-02 -4.88935597e-02
  2.09035352e-02  2.58197710e-02  1.59786027e-02  2.62457617e-02
  2.38799080e-02 -4.94472310e-02  3.28341983e-02 -5.51298214e-03
  7.67138880e-03  1.65266450e-02 -2.20400300e-02  5.48624583e-02
  5.72352260e-02 -6.64555505e-02 -9.14062373e-03  1.24814278e-02
 -3.54427695e-02  5.45734838e-02 -2.72163306e-03  6.95412606e-02
 -5.32127731e-02 -7.94036780e-03  2.07820982e-02 -1.46204308e-02
 -1.03599550e-02  3.79343107e-02  2.49161338e-03 -2.26975977e-02
  5.95553555e-02  5.00486605e-02 -3.54340933e-02  7.20490376e-03
  1.70213543e-02 -5.61065115e-02 -1.17991371e-02 -7.13673830e-02
 -4.58659977e-03  6.35713935e-02  1.17165390e-02 -5.32637984e-02
 -5.57445176e-02 -2.22681519e-02  1.94863006e-02  4.29281034e-02
 -1.93438698e-02 -8.40475783e-02  1.66469403e-02 -4.54468764e-02
  1.60295703e-02  2.52546594e-02  1.40423374e-02  7.45963082e-02
 -3.94388512e-02  1.04812682e-02 -3.48624215e-02 -3.57179344e-02
 -4.34844196e-02 -1.80074051e-02 -2.93866508e-02 -8.32435191e-02
 -3.14649148e-03  1.10014141e-01  1.25215128e-02  1.07997116e-02
 -4.86507341e-02  1.65949054e-02 -1.63088308e-03 -6.18288442e-02
 -1.30034080e-02 -2.56478116e-02 -3.03068962e-02  6.21421263e-02
 -1.96717922e-02 -2.16926821e-02  1.64353792e-02 -3.95212583e-02
  1.87784694e-02  4.05203402e-02  1.04143955e-02  7.96935242e-03
  8.66152439e-03 -1.15555059e-03  1.21605461e-02  3.67220230e-02
 -5.22110052e-02  2.10700240e-02  3.82533930e-02  4.48386222e-02
 -5.64965457e-02 -8.22125189e-03  3.08420062e-02 -1.07276738e-02
  8.64455942e-03  6.54881529e-04  2.45821575e-04  2.08423324e-02
  2.56328955e-02 -1.45219863e-04  3.34027372e-02  2.25482173e-02
 -1.86008364e-02  2.12780740e-02 -7.96129578e-04  2.63534356e-02
 -3.68649443e-03 -1.12833995e-02 -4.51226309e-02 -2.28235200e-02
  2.93550342e-02  2.07184497e-02 -2.63181124e-02 -4.94067073e-02
  4.20888849e-02 -4.73819999e-03  3.64061329e-03  6.19170554e-02
 -3.34577709e-02  3.74044143e-02  6.54818490e-02  3.94526459e-02
  1.64314639e-02  5.49242869e-02 -2.37620585e-02  1.72272306e-02
 -5.99058066e-03  5.54482341e-02 -1.25789754e-02 -6.51624873e-02
  1.67345740e-02 -2.42872722e-02  4.59455773e-02  4.40231189e-02
 -2.25881115e-02 -7.74069205e-02  2.49957647e-02 -9.53567307e-03
  3.00077647e-02 -6.61248248e-03 -8.78895540e-03  2.29203533e-02
 -8.35411623e-02  3.79188769e-02  3.15720849e-02 -4.36151400e-02
 -7.87693635e-02  2.79447832e-03 -4.74893674e-02 -1.27150549e-03
 -9.75582097e-03  7.52535909e-02 -3.34591269e-02  1.62986666e-02
  8.32426995e-02 -1.50147984e-02 -1.54843181e-02 -6.21403977e-02
 -1.31991347e-02  5.08999228e-02  5.66288270e-02 -9.17596091e-03
 -1.84229836e-02  4.86416696e-03 -3.87895666e-02 -1.75045319e-02
 -9.86888912e-03 -3.18251699e-02  1.31501211e-02  3.17589864e-02
  6.44490868e-03 -4.10214765e-04  3.48804928e-02 -2.64555737e-02
  4.06455211e-02 -7.37408847e-02  3.07518803e-02 -4.93132975e-03
  4.75455588e-03 -1.84659120e-02  7.91720208e-03  1.32868746e-02
  2.64364704e-02  6.41284436e-02  2.03358196e-02 -2.68640462e-02
 -7.13659227e-02  4.14670482e-02 -3.68492492e-02 -4.41787615e-02
 -1.05399052e-02  8.15519784e-03 -1.14431433e-01 -4.05844003e-02
  2.42661815e-02 -8.77103955e-03  6.52441457e-02 -7.68470205e-03
  2.39640847e-02  8.72222893e-03 -4.30256873e-02 -4.41488698e-02
 -4.57209237e-02  3.14610749e-02  2.62932815e-02 -3.24335881e-02
 -1.57989580e-02 -1.22437335e-03 -5.74652739e-02 -2.74223629e-02
  1.72154903e-02 -9.00413767e-02 -5.63123748e-02  4.22503315e-02
  5.83700463e-02  4.36143465e-02 -9.46216844e-03 -4.53869179e-05
 -4.48783524e-02  3.50195565e-03  4.90145804e-03 -9.58011299e-03
  3.05112693e-02  1.48365842e-02 -4.49357294e-02 -3.70914279e-03
  2.99510732e-02 -3.30878887e-04  2.00743172e-02 -5.51074445e-02
  2.22486095e-03 -5.07083461e-02 -4.30179387e-02  6.10720813e-02
  2.83860206e-03 -7.77212158e-03  3.68244536e-02 -1.29224936e-05
  2.08626757e-03  1.86786596e-02 -4.36446108e-02  2.96667386e-02
 -5.72536811e-02  4.01863456e-02  4.05926928e-02 -1.32893305e-02
  2.37326429e-04 -1.50391227e-02  2.25148033e-02  1.72850564e-02
 -9.84316878e-03  1.48600899e-02  9.71975923e-03 -7.40760099e-03
  1.91329373e-03 -9.92595591e-03  2.05662530e-02  3.61038260e-02
  1.26043707e-02  1.41094206e-02 -2.10742541e-02  1.03539531e-03
  1.58400666e-02  4.58830073e-02 -1.15148611e-02 -2.89885942e-02
 -3.44926193e-02 -4.74556088e-02 -2.50997767e-02 -3.99633981e-02
  1.56195136e-02  4.36202213e-02  4.80556451e-02 -1.22993914e-02
  2.54218541e-02  2.37286929e-03  3.39974202e-02 -5.71800023e-02
  1.83588658e-02  2.90805679e-02  2.72529828e-03 -1.84056796e-02
 -8.47651288e-02  6.33297041e-02  6.09622598e-02  2.36318074e-02
 -5.91798425e-02  7.26110488e-03 -3.26487981e-02 -1.77729875e-02
  2.19911393e-02  3.41846328e-03 -1.51157407e-02  1.03986003e-02
  1.14737777e-02 -6.14641607e-02  1.20170247e-02  3.11063454e-02
  5.24505004e-02 -3.11983638e-02  4.13898891e-03  1.10096671e-02
 -3.54162343e-02 -1.70866139e-02  2.06126664e-02  3.65026817e-02
 -2.38252617e-03  5.72466478e-03  4.99246642e-02 -6.11848299e-33
 -6.99488372e-02 -1.72617063e-02  1.69621520e-02 -2.10649334e-02
 -1.33594349e-02 -3.66322622e-02 -2.59890202e-02  2.88621988e-02
 -2.36646133e-03 -1.30485827e-02  5.09957178e-03  3.37471031e-02
  2.86898073e-02  1.65926665e-02  1.93600189e-02  2.02415790e-02
  4.77114767e-02 -6.68464974e-02 -7.09287683e-03  1.45962602e-03
  2.93627251e-02  4.59876768e-02  3.91265117e-02  1.76188983e-02
 -1.81188881e-02 -2.96952631e-02 -1.94933228e-02 -1.44440392e-02
  2.16537006e-02  3.14197391e-02 -1.52638759e-02 -5.80297830e-03
  7.31691811e-03 -6.84464723e-02 -2.71920785e-02  8.92760698e-04
 -1.23989046e-01 -1.77841783e-02 -2.48171017e-03  2.22587213e-02
 -1.53972348e-02 -4.04589102e-02  2.05282941e-02 -8.67987983e-03
 -8.12571868e-02  1.22767389e-02  1.35315629e-02 -1.32565824e-02
 -5.71633317e-02 -3.17662656e-02 -4.56476249e-02  5.19123813e-03
 -3.09963967e-03  3.47741134e-02  6.40314370e-02  2.12365985e-02
 -2.58825328e-02 -6.25096587e-03  1.94716994e-02  3.83544341e-02
  8.47928002e-02  7.97712728e-02  1.98244732e-02 -2.66155344e-03
  1.98457334e-02 -2.77737016e-03  4.38183770e-02 -6.13386445e-02
 -5.92298880e-02  2.51411293e-02  1.75920837e-02  1.22784711e-02
  2.73038223e-02 -2.48242985e-03  7.73616135e-02 -5.48062883e-02
 -2.91793467e-03  1.97106414e-02  1.24061136e-02  3.68235596e-02
  1.15579076e-03  1.25254896e-02  9.96080413e-03 -3.03236190e-02
 -2.92828530e-02 -6.41257912e-02 -7.73954391e-03 -5.88066736e-03
  4.90619102e-03  3.31579782e-02 -3.39885987e-02  1.51256397e-02
  5.40430844e-02 -3.89886051e-02 -6.36244705e-03  2.75231171e-02
  1.13785639e-02  1.48645118e-02 -2.25565154e-02  7.85036013e-03
 -1.78308412e-02 -9.77673847e-03  1.44702457e-02 -7.95404706e-03
  2.95076333e-02  3.97348963e-02 -3.97447161e-02  4.62591536e-02
 -4.88444157e-02 -2.18987837e-02 -3.75802182e-02 -9.87840444e-03
  6.15754314e-02 -2.19764723e-03  5.93003184e-02 -4.22418490e-02
 -1.11075956e-02 -3.69455758e-03 -2.38613077e-02  1.09042069e-02
  4.67397692e-03  1.94154717e-02  4.53434093e-03  4.57810946e-02
  8.39499943e-03 -2.11293977e-02 -7.43078366e-02  4.00590757e-03
  6.53025284e-02 -3.14243175e-02 -3.25547643e-02  4.27374952e-02
  2.21834981e-07  9.40504670e-03  2.51406226e-02  9.09760594e-02
  7.41878897e-02  2.62342338e-02 -2.25914121e-02 -3.46368030e-02
  3.13707143e-02  3.67346331e-02 -2.55144890e-02 -6.42920379e-03
 -2.64408393e-03  1.89333856e-02 -2.11614631e-02  2.70819459e-02
 -3.27386893e-02  2.12704409e-02  9.49345063e-03 -2.05955692e-02
  1.09085878e-02  4.81055640e-02  6.91133365e-02 -5.59999533e-02
 -1.89128262e-03  2.82947328e-02 -7.32111186e-03  1.22755002e-02
  1.84654295e-02  4.17478159e-02 -1.30801490e-02  2.09549982e-02
 -3.85848880e-02  5.43629797e-03 -2.46245656e-02 -1.77929718e-02
  2.64741052e-02  2.04455983e-02  7.01938868e-02 -2.51145717e-02
 -3.49329114e-02  4.83638383e-02 -1.57256536e-02 -1.98024064e-02
  3.09769046e-02  1.73689853e-02 -1.74486339e-02 -9.26067680e-03
 -2.57161650e-04 -4.88235280e-02  9.70953144e-03 -3.13739069e-02
 -2.81248856e-02  5.28662391e-02 -1.06252730e-02  1.42922373e-02
  9.54507478e-03  3.55127417e-02  2.52467990e-02  3.34243546e-03
 -1.51642254e-02 -6.09273724e-02 -2.58685295e-02 -2.12424621e-02
  2.07081307e-02  8.42226204e-03  1.55985705e-03 -2.62884926e-02
  2.14035619e-34  3.89655828e-02 -3.80881801e-02  4.34561931e-02
  5.00425994e-02 -9.75283142e-03 -4.14465517e-02 -1.56656168e-02
  6.23391159e-02 -2.10787877e-02 -6.97749481e-02 -4.36122417e-02]"
"Figure 1: The Transformer - model architecture.
 The Transformer follows this overall architecture using stacked self-attention and point-wise, fully
connected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,
respectively.
3.1
Encoder and Decoder Stacks
Encoder:
The encoder is composed of a stack of N = 6 identical layers. Each layer has two
sub-layers. The first is a multi-head self-attention mechanism, and the second is a simple, position-
wise fully connected feed-forward network. We employ a residual connection [11] around each of
the two sub-layers, followed by layer normalization [1]. That is, the output of each sub-layer is
LayerNorm(x + Sublayer(x)), where Sublayer(x) is the function implemented by the sub-layer
itself. To facilitate these residual connections, all sub-layers in the model, as well as the embedding
layers, produce outputs of dimension dmodel = 512.
Decoder:
 The decoder is also composed of a stack of N = 6 identical layers. In addition to the two
sub-layers in each encoder layer, the decoder inserts a third sub-layer, which performs multi-head
attention over the output of the encoder stack. Similar to the encoder, we employ residual connections
around each of the sub-layers, followed by layer normalization. We also modify the self-attention
sub-layer in the decoder stack to prevent positions from attending to subsequent positions.","[-5.64367278e-03 -1.43792341e-03  1.34502433e-03  3.77233922e-02
 -1.04021293e-03  1.21468874e-02  7.01223537e-02 -2.61947121e-02
 -7.13312551e-02 -3.84832057e-03 -4.27391902e-02  4.36751656e-02
  1.39518874e-02  2.69504879e-02  4.13122587e-02 -4.32738662e-02
 -3.09053846e-02  3.71434949e-02 -8.23085010e-02 -2.82844342e-02
 -1.94948204e-02 -3.36302444e-02  2.62386911e-03  1.37142427e-02
 -2.50465963e-02  1.57169551e-02 -4.34401296e-02  1.15242386e-02
  2.51674615e-02 -8.85289069e-03 -9.73383989e-03  3.57146263e-02
  2.49932520e-02  2.85162814e-02  2.19067147e-06  3.19505110e-03
  1.03054047e-02 -5.71814738e-03 -1.51018350e-04  7.83242192e-03
 -1.49485627e-02 -4.85483818e-02 -3.21921259e-02 -1.61262378e-02
  2.72628106e-03 -3.23886834e-02  8.66432413e-02  3.70309874e-02
  6.80350810e-02  5.03331237e-02 -1.19798025e-02 -1.08069815e-01
  2.38956232e-02 -2.27766093e-02 -4.14665043e-02  2.86322529e-03
  2.17841715e-02 -1.00992639e-02 -4.26946357e-02  9.70930152e-04
 -6.11199141e-02  6.03965335e-02  4.45305854e-02 -3.99556980e-02
  3.41629945e-02 -7.11234706e-03  2.24606786e-02 -7.80418962e-02
 -8.43536668e-03 -6.95596868e-03 -7.78460726e-02 -6.79673860e-03
 -3.66408452e-02  2.90156603e-02 -1.99270677e-02 -1.01201572e-02
 -4.24206741e-02  5.39969141e-03  3.45199555e-03  4.39775642e-03
 -4.33278792e-02  5.49164079e-02 -1.65800788e-02 -4.65184152e-02
 -3.34663279e-02  3.93181900e-03  9.82719287e-03 -1.56421717e-02
 -2.85515040e-02  9.73452814e-03  4.62989435e-02 -1.53234443e-02
  6.04948290e-02  4.80214618e-02  3.52337621e-02 -1.91838294e-02
 -1.64426696e-02 -3.91395614e-02 -3.07380017e-02 -8.53074715e-02
  4.35444266e-02  1.82283353e-02 -1.60925835e-02  2.25482453e-02
 -2.45506261e-02  6.86288252e-02 -1.03892744e-01  4.97258492e-02
 -5.09339795e-02 -1.74909772e-03  4.06677090e-02 -8.04384518e-03
 -7.22786635e-02  3.82480174e-02 -1.11640058e-02 -2.45567095e-02
 -2.57197097e-02  1.99857801e-02  1.11925667e-02 -1.37501219e-02
  2.39025094e-02  1.07345385e-02 -4.95262705e-02 -4.46884297e-02
  1.71748977e-02  7.91730732e-02  6.46616565e-03 -2.89623048e-02
  1.84192676e-02 -5.98493498e-03 -3.66900600e-02  2.13614497e-02
  1.03013846e-03  1.79976560e-02 -1.76532771e-02  3.14260758e-02
 -1.41760968e-02  2.24088430e-02 -4.82580252e-03  5.09501249e-02
  1.16628082e-02  1.43380947e-02  3.76255736e-02 -1.05581917e-02
  8.87975097e-03  3.11618540e-02 -7.41785578e-03 -3.16436240e-03
  1.03155747e-02  1.65103097e-02  2.04085037e-02  3.16105485e-02
  2.02260371e-02 -4.19802517e-02  6.09623902e-02  3.56383924e-03
 -6.22564228e-03  2.77240146e-02 -7.55621027e-03  2.01212727e-02
 -3.65496762e-02 -3.90909761e-02  2.45949887e-02  2.86321691e-03
 -1.20183658e-02  3.25503829e-03 -5.31652495e-02 -5.55173382e-02
 -2.97061745e-02  9.81598347e-03  5.52912503e-02  8.09779949e-03
 -2.69769598e-02 -4.08949703e-02  4.24015857e-02  2.96907108e-02
  9.42443684e-02  3.25418115e-02  1.02500571e-02  1.50594115e-02
  1.25220753e-02  3.95968333e-02 -1.89751526e-03  1.00294054e-01
 -1.19098062e-02 -4.10904139e-02 -6.66039288e-02  5.40699326e-02
 -6.56169429e-02 -2.06261929e-02  4.17893706e-03  1.71787068e-02
 -5.28541906e-03 -4.44722176e-02  2.81693041e-02  5.27534895e-02
 -6.15401529e-02  6.47622198e-02 -4.26251516e-02 -4.18537483e-02
 -5.61144156e-03 -1.43436063e-02 -4.60277237e-02 -1.69270188e-02
  1.02799628e-02  1.97391137e-02 -3.99625069e-03 -2.72720624e-02
 -2.82603353e-02  8.35714787e-02 -2.23924853e-02  1.21727400e-02
 -3.45476158e-02 -2.09000781e-02 -3.90292257e-02  5.01430295e-02
  6.33481052e-03  3.37446630e-02 -3.62100564e-02 -2.81664543e-02
 -4.14488651e-02  4.19715494e-02  6.03100695e-02 -1.20740682e-02
 -1.40534563e-03  2.52866298e-02 -4.06059138e-02  1.49536906e-02
 -3.11944587e-03  3.14107463e-02  1.33650526e-02 -9.64806182e-04
  5.21954745e-02 -3.33224051e-02 -7.05781160e-03  1.83130521e-02
 -5.20516075e-02  2.02107430e-02 -9.87360603e-04 -4.15396579e-02
  2.54213791e-02  3.23636867e-02  3.64004225e-02 -3.00248936e-02
  2.78733224e-02 -5.85239157e-02  1.02910027e-02 -3.10626868e-02
  4.27015685e-02 -5.91383409e-03  2.09971983e-02  1.09886387e-02
  2.88489126e-02 -1.89466905e-02  1.25964293e-02 -3.49999545e-03
  1.63866449e-02 -9.30777751e-03 -2.56607030e-02  5.12213726e-03
  2.08579339e-02 -3.24123204e-02 -1.15715852e-02  8.12621880e-03
 -3.48352045e-02  1.92861892e-02 -4.68040705e-02  4.24658991e-02
 -4.31095883e-02  2.80980428e-04  1.04725482e-02  2.57508066e-02
  2.44552288e-02  2.44845655e-02 -1.02856550e-02 -1.44545482e-02
  5.19102141e-02 -7.51269003e-03 -5.34043722e-02  3.37011553e-02
 -2.54340144e-03 -6.34071231e-02 -8.54105409e-03 -3.64941210e-02
  4.42445651e-02  4.43887822e-02 -3.86001309e-04 -6.84984848e-02
 -7.28618205e-02 -8.49573463e-02  7.67433792e-02  3.19191925e-02
  1.37383975e-02 -9.39306095e-02 -2.50716191e-02  1.68185700e-02
 -2.98519693e-02  7.78378621e-02  2.60545779e-02  5.71453609e-02
 -7.62547890e-04  1.93517078e-02  4.20372514e-03  2.17198227e-02
 -4.76670600e-02  8.71414319e-03 -5.23147099e-02  3.11119426e-02
 -3.23953293e-02  7.72734731e-02  1.76044013e-02  3.30862589e-02
 -5.53126894e-02  5.46210585e-03  3.90527584e-02 -3.53915058e-02
  3.68564241e-02 -5.49472980e-02 -1.73790455e-02  1.06843878e-02
 -2.63403784e-02 -2.87115457e-03 -1.48961106e-02 -2.23201048e-02
 -8.52656923e-03  2.05182005e-02  3.61470953e-02  1.47587340e-02
  2.32837745e-03  2.66880803e-02  2.71736123e-02  5.75417653e-03
 -2.98857596e-02  7.27841025e-03  6.18465021e-02 -4.12471872e-03
 -1.72260571e-02  8.62478837e-03  1.96441193e-03 -3.49265710e-02
 -3.33307460e-02  7.08362926e-03 -3.28665152e-02  8.37067738e-02
 -8.49707797e-03  2.91485321e-02  1.57786366e-02 -1.27626657e-02
 -8.93455073e-02  2.83796620e-02  3.66134383e-02  6.39714897e-02
 -9.05055460e-03  7.46650388e-03 -6.51913658e-02  3.68237011e-02
 -5.14265485e-02  4.38337810e-02  1.30055426e-02  8.72988254e-03
  7.89245665e-02  1.43460752e-02 -4.44618650e-02  3.77309285e-02
 -5.79705611e-02  1.50108524e-02  5.47947772e-02 -8.58812872e-03
  1.29940296e-02 -1.30125387e-02  3.10422089e-02 -4.08248901e-02
 -2.41676904e-02  4.58392277e-02 -2.04930715e-02 -8.97742361e-02
  1.45073456e-03 -5.92317525e-03 -5.33461273e-02  2.28593946e-02
  9.24455374e-03 -1.44547820e-02  2.81276437e-03 -2.21033394e-02
 -4.08340544e-02  4.01718356e-02  2.08154973e-02  2.40493137e-02
 -5.46672903e-02  5.04111312e-02  1.86606534e-02 -9.51824337e-03
 -8.39462355e-02  1.29620610e-02 -2.06287410e-02 -1.02654677e-02
  2.00167787e-03  3.99528183e-02 -2.74353405e-03 -4.55164239e-02
  2.52369903e-02  3.21032070e-02 -1.28691616e-02 -4.98484783e-02
 -1.70938987e-02 -1.66649241e-02  5.53562306e-02  1.13468580e-02
  1.04915146e-02 -7.28843212e-02 -1.29934947e-03 -7.17663905e-03
  4.68409285e-02  5.84571995e-03  2.59028953e-02 -1.20480470e-02
 -1.84836835e-02 -1.13651645e-03  2.67009716e-02 -3.55344750e-02
  3.71266343e-02 -7.20640123e-02  3.05493083e-02 -3.33560631e-02
  3.39163318e-02 -1.53986663e-02  2.96644531e-02 -6.33567572e-02
 -2.35145655e-03  1.19155673e-02 -9.26447567e-03 -5.28767053e-03
 -2.96310447e-02  2.88328677e-02 -7.19335750e-02 -3.03311069e-02
  4.52931076e-02  2.44492907e-02 -8.28485563e-02 -1.09262168e-02
  3.33707258e-02 -1.87731795e-02  2.50764899e-02  3.23188603e-02
 -9.99924242e-02  6.46329522e-02  2.57485989e-03 -3.21692228e-02
 -3.06754671e-02  1.79181714e-02 -1.79856271e-02 -3.39127406e-02
  2.26227455e-02  6.88637048e-02 -1.29158823e-02 -1.03654852e-03
 -1.12255346e-02 -8.28413293e-02  1.57458801e-02  3.88715789e-02
  4.87814844e-02  2.11622473e-02  4.44336347e-02 -4.29981109e-03
 -1.25264022e-02  2.10892484e-02 -2.75613926e-02 -5.22035696e-02
  3.35753448e-02  1.96189322e-02 -9.50370878e-02 -2.60201078e-02
  3.17146280e-03 -3.63717005e-02  6.96955919e-02 -1.78227257e-02
 -1.36341844e-02 -2.48604920e-02 -4.62664254e-02  3.83678079e-02
 -6.03542365e-02  4.32941988e-02  2.92093996e-02  6.44177794e-02
  1.40200397e-02  5.92298023e-02 -3.35462280e-02  3.55346017e-02
 -5.26388548e-02  2.25710624e-04  2.84069087e-02 -1.75622441e-02
  5.68546019e-02 -9.75544564e-03  3.39739695e-02 -3.05894576e-02
  1.54069979e-02  5.51313385e-02 -2.81953923e-02 -3.75417434e-02
 -4.77744788e-02 -9.30412114e-03  1.32186543e-02  7.93302245e-03
  4.57317382e-03  2.35485174e-02 -2.78657191e-02  3.20763141e-02
  1.73919611e-02  3.43847424e-02 -9.68108606e-03  3.52102406e-02
  4.59592603e-03  9.31958295e-03 -5.02504259e-02 -4.05970104e-02
  5.38895503e-02  1.59866959e-02  3.75763364e-02  3.44709940e-02
  8.52204766e-03  1.66089553e-02  3.05259563e-02 -5.73500944e-03
  6.39115181e-03  3.96381831e-03 -7.90128426e-04  3.21009159e-02
 -6.95837513e-02 -2.94819358e-03 -4.21104878e-02 -1.89350937e-02
 -3.30106914e-02  7.12151825e-03 -8.58456921e-03 -1.37412408e-02
 -3.27779688e-02 -8.15836899e-03 -1.19039118e-02 -5.00736339e-03
  3.78352171e-03 -2.24745367e-02  1.17483484e-02 -1.63613223e-02
  4.24077623e-02 -5.30452095e-02  4.70136665e-02 -3.19796801e-02
 -2.92251469e-03 -4.22668867e-02  5.81341982e-02 -2.20964383e-02
 -6.99097663e-03  1.65990032e-02  2.44921260e-02 -5.96731626e-33
 -5.75364493e-02  2.59178299e-02  2.49407720e-02  2.78157927e-02
 -3.20709832e-02  1.65839843e-03 -1.91540213e-03 -5.86625654e-03
 -3.42111140e-02 -3.18456963e-02  2.92953977e-04  7.25771906e-03
  8.10696557e-03  5.61667569e-02  2.42430437e-02  1.08426493e-02
  4.42684181e-02 -2.89311446e-02  8.70558340e-03  4.22053039e-03
  9.40343644e-03  2.80848369e-02  6.47126883e-02  1.51435733e-02
 -5.42133860e-02  1.72514487e-02 -1.57945405e-03 -3.98165826e-03
  8.46423209e-04 -8.24216194e-03 -1.45533979e-02 -9.06838197e-03
 -1.29835550e-02 -9.86488014e-02 -6.04841812e-03  2.84738503e-02
 -8.19266811e-02  7.83174299e-03 -5.61631806e-02  5.78627884e-02
 -2.79114582e-02 -3.45859006e-02  4.19071727e-02  1.22654708e-02
 -4.51467745e-02 -5.09361625e-02  1.55272614e-02 -1.54927718e-02
  1.02716433e-02  1.70227420e-02  1.21511614e-04  2.04572100e-02
 -7.13589741e-03 -3.44467051e-02  3.49484086e-02  2.33285464e-02
 -1.67434942e-02  1.12128276e-02 -7.34716877e-02  1.38220359e-02
  2.53523998e-02  3.80897634e-02  4.29375097e-02  2.08707005e-02
  1.33505128e-02  9.38110228e-04  3.45167890e-02 -3.55372205e-02
 -4.93746512e-02  2.38695052e-02  1.45598943e-03  1.54251102e-02
  8.79950449e-02 -8.22493061e-02  3.81353609e-02 -1.60557907e-02
  9.47234407e-03  1.82240475e-02 -6.33815005e-02  9.40088108e-02
  3.27514261e-02  3.41602117e-02  3.55783887e-02 -1.97352804e-02
  4.03044745e-03 -1.81200206e-02  1.33223152e-02 -2.80366968e-02
  1.53073773e-03  1.71372108e-02 -3.47912917e-03  1.67218540e-02
  2.95729376e-02 -2.47444827e-02  8.21614861e-02  3.08300816e-02
  2.95811091e-02  6.60880804e-02  8.60467367e-03  1.62437733e-03
  3.52967903e-02  2.11729445e-02  1.21361222e-02  2.95565557e-02
 -9.34232585e-03  2.67681312e-02 -1.33558400e-02  9.26680118e-02
 -1.47912828e-02 -2.78616939e-02 -3.05433907e-02 -7.64323492e-03
  1.96674410e-02  3.28383856e-02  1.00337425e-02  2.79412023e-03
 -3.25424736e-03  2.60680132e-02 -4.64781485e-02 -1.02360640e-02
 -2.00505089e-03  4.16588821e-02  1.55701078e-02  3.91991399e-02
 -2.36091185e-02  4.27939137e-03 -7.30256066e-02  2.75444500e-02
  4.18208167e-02 -8.17190334e-02 -2.79057566e-02  5.29237501e-02
  2.79768273e-07  1.12597188e-02  1.83470100e-02  9.18466002e-02
  6.06683595e-03  2.75074020e-02 -1.91802215e-02  1.70247611e-02
  5.70942536e-02  4.70156185e-02 -3.04804910e-02 -1.51448986e-02
  1.97065212e-02 -2.59670708e-02 -2.97567360e-02 -5.04283085e-02
 -4.60808277e-02 -1.69411320e-02  4.98124845e-02  3.92528102e-02
  1.79650709e-02  1.74723100e-02  7.24272579e-02 -2.77755074e-02
  1.57331564e-02 -2.66869124e-02  2.37719323e-02  5.76880155e-03
  6.52272850e-02  4.26513478e-02 -1.94159243e-02 -2.62137875e-02
  6.44042576e-03 -2.49309987e-02  1.56339370e-02 -2.94197015e-02
  1.41245294e-02  1.22841736e-02  2.85789855e-02 -2.66701765e-02
 -1.27177984e-02  3.95714976e-02  3.03186420e-02 -4.27371860e-02
 -2.49327980e-02 -1.20222084e-02 -1.10165857e-01 -4.18740548e-02
  2.30967943e-02 -4.84629758e-02  1.84274744e-02 -5.35987094e-02
 -1.27342623e-02  1.87181346e-02 -4.07868251e-02  3.03262956e-02
 -7.32722972e-03  1.60074309e-02 -2.08106358e-02  1.03204623e-02
 -1.82186731e-03 -4.99161072e-02  1.65864755e-03 -3.76687646e-02
 -6.80146366e-02  3.53214331e-02  4.18884046e-02 -8.17843899e-02
  2.50650385e-34 -6.40932005e-03 -2.09665466e-02  5.85307553e-03
  2.07374059e-02 -3.07192728e-02 -3.26929539e-02  2.08008662e-02
  3.60970683e-02 -2.95650773e-02 -5.55219986e-02 -5.25698848e-02]"
"This
masking, combined with fact that the output embeddings are offset by one position, ensures that the
predictions for position i can depend only on the known outputs at positions less than i.
3.2
Attention
An attention function can be described as mapping a query and a set of key-value pairs to an output,
where the query, keys, values, and output are all vectors. The output is computed as a weighted sum
3
","[-5.43985843e-05 -7.64022022e-02 -1.70795992e-02  2.77428702e-02
 -4.98562157e-02  2.42997725e-02  5.52494489e-02  2.09078216e-03
 -1.68325417e-02 -2.38027028e-03  3.87278129e-03 -4.21850681e-02
  3.85512225e-02  3.84318158e-02  8.01406875e-02 -7.09423274e-02
  1.70399025e-02 -2.20238026e-02 -7.98986405e-02 -7.32382573e-03
 -2.33457703e-02 -5.09460382e-02 -1.82248764e-02  4.42842022e-02
  1.28149781e-02 -1.75826438e-02  5.17578376e-03 -1.55062769e-02
  4.42980928e-03 -2.70472858e-02 -4.85576456e-03  1.81677118e-02
  2.20404286e-02 -8.74286145e-03  1.84167243e-06 -1.23076583e-03
 -7.25327525e-03 -5.07677090e-04 -1.90280620e-02 -3.41497660e-02
 -4.79257368e-02 -3.00966343e-03  2.41314583e-02  8.91700666e-03
 -2.90601025e-03  4.49122414e-02  4.02939804e-02  2.75017731e-02
  1.77739356e-02  3.47211137e-02 -2.32659886e-03 -2.14906782e-02
 -2.20720395e-02 -4.31604050e-02  8.36536586e-02 -9.82576143e-03
  3.98572125e-02 -6.50476664e-02 -6.21453077e-02 -2.50855205e-03
 -1.94082763e-02  2.52298210e-02  1.30576426e-02 -1.41729787e-02
  9.86891463e-02  4.84171622e-02  1.49746658e-02 -4.22987714e-02
 -1.46942036e-02 -4.38099988e-02 -4.74632420e-02 -2.73587066e-03
 -6.33128779e-03  2.83157900e-02  2.81123281e-03 -5.24176769e-02
 -6.76610395e-02 -3.47450329e-03  4.73721102e-02  1.69335697e-02
 -7.00864987e-03  7.69192725e-02 -2.28814669e-02 -5.53060062e-02
 -1.57200545e-02  2.68510748e-02 -3.08337621e-03 -2.49279663e-02
 -3.84084210e-02  3.42185935e-03 -1.42778707e-04 -6.49435371e-02
  4.62513193e-02  4.18307707e-02  4.26061787e-02 -2.55251583e-02
  6.03169261e-04 -3.22983898e-02 -3.14044654e-02 -4.77211364e-02
  4.78511043e-02  3.15326117e-02  1.29686696e-02  4.07620780e-02
 -1.65593494e-02  1.04278810e-01 -6.03524968e-02  3.92554179e-02
 -1.95244104e-02  4.75200005e-02  5.31319827e-02 -3.90367396e-02
 -2.10674703e-02  8.80553052e-02 -3.07307262e-02 -3.06857564e-02
 -1.35251358e-02  1.85465757e-02 -5.29752783e-02  4.48622666e-02
 -1.32222390e-02  7.98699446e-04 -4.93745990e-02 -1.96868498e-02
 -9.01648588e-03  1.08808726e-02  2.99286772e-03 -4.28701611e-03
  1.43666994e-05  3.22366171e-02 -3.61355916e-02  2.39051282e-02
  5.37157711e-03 -2.25505885e-02 -6.58930689e-02  8.79513621e-02
  1.21057862e-02  1.65848304e-02  3.18736248e-02  4.00406774e-03
  2.29738969e-02 -1.01365279e-02  9.39147323e-02 -9.75591503e-03
 -1.83131527e-02  3.76192592e-02 -1.50844241e-02 -1.24764454e-03
  2.01593507e-02  2.82540899e-02 -2.10982729e-02  1.89246796e-02
  6.54766709e-02 -2.10453216e-02 -2.32333075e-02  1.69823561e-02
 -1.08798901e-02  3.04009505e-02 -1.73303857e-02  6.20496795e-02
 -2.75781238e-03 -2.48746704e-02 -2.86635216e-02 -4.21546362e-02
  3.32017429e-02 -1.51889455e-02 -2.81730928e-02 -3.30326008e-03
  1.96191948e-02 -2.19755433e-02  4.22700495e-02 -1.64134731e-03
 -1.25911338e-02 -3.90756950e-02  4.77632061e-02  6.45021722e-02
  6.86876401e-02  1.43489428e-02 -4.85238573e-03 -1.63485110e-02
 -3.87043171e-02  9.26168486e-02 -3.25138643e-02  8.04993212e-02
 -1.09537141e-02 -8.40125605e-03 -5.91573445e-03  8.88562761e-03
 -3.05036688e-03 -2.63715312e-02  3.26023437e-03  5.00979610e-02
 -2.26619616e-02 -3.40001024e-02 -1.36289801e-02  4.00628848e-03
 -4.86343652e-02  1.23214088e-02 -2.01215986e-02  2.37177182e-02
  3.30282971e-02 -1.37783755e-02 -2.04504337e-02  1.44641558e-02
  6.21133903e-03  1.28203901e-04  5.38447127e-03 -3.08323298e-02
 -3.47954184e-02  4.36264798e-02 -1.50231849e-02  1.95697751e-02
 -1.30552538e-02 -1.67886412e-03 -3.58350277e-02 -1.91881489e-02
 -1.90551784e-02  4.86487849e-03 -5.07965907e-02 -3.26515920e-02
  4.63884324e-03  2.91402601e-02  7.25180097e-03 -1.95116139e-04
  3.60423280e-03 -3.82715985e-02 -5.78918979e-02  3.32694054e-02
 -3.55792581e-03  1.41187366e-02  2.90099699e-02  3.12890857e-02
  7.10622370e-02 -1.59728657e-02  5.88796884e-02  6.85853511e-03
 -3.11091933e-02  6.22140523e-03  6.67427573e-03 -5.56487292e-02
  4.26647067e-02  4.59555164e-02  4.66986895e-02 -3.96707393e-02
  4.84588929e-02 -4.17611822e-02 -4.67349077e-03  3.43149621e-03
 -1.83945708e-02  1.91006698e-02  9.84677952e-03  2.40982568e-04
  3.73211130e-02 -3.57677005e-02  2.18563639e-02 -1.84154755e-03
  1.84301788e-03  1.15076546e-02 -5.73971197e-02  3.92195508e-02
 -1.82927446e-03 -1.93233211e-02 -7.93215539e-03 -1.85929593e-02
 -5.24961613e-02 -1.98969096e-02 -1.33388592e-02  9.51390900e-03
 -1.65931620e-02 -8.89677554e-03  1.31384823e-02  3.14868726e-02
 -2.92123109e-02  2.87945271e-02 -1.75599065e-02 -1.01375254e-02
 -7.23851426e-03 -2.57616546e-02 -1.48492551e-03  4.09617424e-02
  6.61796611e-03 -1.00330228e-03 -1.99500825e-02 -3.91271971e-02
 -2.56004906e-03  5.60376793e-02  1.58348214e-02 -8.93242359e-02
 -5.41340411e-02 -1.12384474e-02  1.94881875e-02  4.30829749e-02
 -3.38991638e-03 -1.48301516e-02 -1.09299412e-02 -3.45703959e-02
  7.86909927e-03  1.02427572e-01  2.05093399e-02  6.18312247e-02
 -3.53163220e-02  2.35350858e-02 -9.97120701e-03  2.98646428e-02
 -6.78859279e-02  6.10859245e-02 -3.30974497e-02 -1.65052488e-02
 -2.34077424e-02  4.55749854e-02  1.37243895e-02 -3.80429276e-03
 -7.90376365e-02  3.17226686e-02  1.83429122e-02 -1.17916111e-02
 -6.26972914e-02  4.62631695e-03 -4.82496172e-02  8.85376427e-03
 -4.35581692e-02 -3.07094250e-02  1.72537938e-02 -1.33190071e-02
 -4.63317428e-03  1.50567954e-04  5.67564107e-02  7.41848303e-03
 -6.19609421e-03  5.70656955e-02  2.89861728e-02 -2.87017543e-02
 -3.75943705e-02 -4.54503257e-04  3.69630083e-02 -3.87276299e-02
 -2.69952435e-02 -2.18150914e-02  5.28416783e-02 -2.78564375e-02
 -2.35970356e-02 -2.19439026e-02 -7.27573410e-03 -2.71791033e-02
  3.88910025e-02  2.78389677e-02  2.43211277e-02  7.49083888e-03
 -5.52211702e-02  3.19737829e-02  8.62578452e-02 -1.16088958e-02
 -4.93004918e-02  1.69386175e-02 -5.02343699e-02 -3.14022000e-05
  1.06436256e-02  4.40633111e-02  4.22004284e-03 -3.20988633e-02
 -5.44416346e-03  6.06805235e-02  3.38260382e-02  4.89131622e-02
  2.67196912e-02  2.23054979e-02  7.04535842e-02 -1.93677042e-02
 -2.85623372e-02  4.50019212e-03  5.97411487e-03 -1.46473562e-02
 -1.87662654e-02  1.28981778e-02 -1.17327608e-02 -4.87781353e-02
  1.24574909e-02 -1.88931506e-02  5.10682873e-02  6.16265163e-02
  2.70272214e-02 -2.85304505e-02  2.29669232e-02 -6.61100913e-03
  1.43640200e-02  2.43663061e-02 -2.26092655e-02  3.29790860e-02
 -8.60178247e-02  5.42331636e-02  1.59681458e-02 -5.94493002e-02
 -9.44867507e-02 -1.30682942e-02  5.94318053e-03  4.31739762e-02
 -5.00145666e-02  1.93009973e-02 -4.29153303e-03 -1.26298284e-02
  8.20678622e-02  3.46204229e-02 -2.18840456e-03 -1.18374499e-02
 -3.63871851e-03  5.67264808e-03  8.66867155e-02  1.27651403e-02
 -2.77687386e-02 -6.93930611e-02 -3.09902690e-02 -3.60636413e-02
  1.61987878e-02  5.38592646e-03  8.75259191e-02 -1.13519104e-02
 -1.22974133e-02 -5.91334747e-03  3.26106627e-03  1.80265419e-02
 -1.03751128e-03 -7.31847808e-02  5.88269085e-02  7.92179909e-03
 -1.97363198e-02 -1.65168196e-02  7.19761774e-02 -9.85048711e-03
  5.44289651e-04  6.91721067e-02  8.92767590e-03  3.44467931e-03
 -5.55609390e-02  9.25310776e-02 -4.32352647e-02 -2.98943231e-03
  2.35200860e-02  2.16175094e-02 -2.77160481e-02 -3.16452496e-02
 -4.52484346e-05  1.34587577e-02  6.71386123e-02  2.06991676e-02
 -2.83354409e-02 -1.10705346e-02 -3.66107076e-02 -1.41942473e-02
  1.73544120e-02  2.84830872e-02  2.21486762e-02  1.85568258e-02
  3.49099212e-03  5.61377686e-03 -6.50996193e-02 -4.46811132e-02
 -3.88222374e-02 -4.68597859e-02 -2.82125864e-02  3.13781127e-02
  6.59915879e-02  3.33041362e-02  1.22604091e-02 -4.67190035e-02
 -3.35247405e-02  5.85117610e-03 -4.79033142e-02  4.30076867e-02
  6.19223267e-02  4.26764488e-02 -5.83083555e-02  3.82407359e-03
  8.09170865e-03 -2.93632131e-02 -5.40649239e-03  2.04562973e-02
 -2.31634788e-02  1.43903336e-02  2.82457657e-03 -7.59185106e-03
 -2.79930700e-02  9.68359485e-02  5.80963418e-02  4.78735715e-02
 -3.91101814e-04  7.17520490e-02 -3.31613049e-02 -1.05124079e-02
 -2.94224285e-02 -8.58463161e-03  2.78248508e-02  3.21307443e-02
  6.41933270e-03  4.35074233e-02  3.91973555e-02 -6.63492382e-02
 -4.07414250e-02  1.32744322e-02 -2.33051069e-02 -3.18771265e-02
 -3.42916921e-02  3.93973030e-02 -4.35492322e-02  2.13307738e-02
 -2.29194332e-02  4.04452011e-02  1.76968593e-02 -3.73723567e-03
  2.74600759e-02 -6.20385446e-03 -4.39078361e-02  2.90721767e-02
 -8.45517442e-02 -2.39966679e-02 -1.03565939e-02 -2.54200399e-02
  3.41698267e-02 -2.69792732e-02  2.65741218e-02  3.03034671e-02
 -1.99850071e-02  5.42806927e-03 -1.88938919e-02  2.07187533e-02
 -4.51555150e-03  1.37646887e-02 -5.43221971e-03  1.70319912e-03
 -5.06120287e-02  5.54306284e-02 -5.36806323e-03 -2.10800953e-02
 -5.65803237e-03 -2.11212225e-02 -5.64278150e-03 -2.10359488e-02
  5.42600043e-02  9.13050920e-02  3.25683914e-02  1.70022696e-02
 -1.35502443e-02 -4.54940796e-02  4.27991711e-02 -6.85931789e-03
  2.96567157e-02 -6.77442178e-02  8.23269971e-03  2.34252121e-03
  1.35981413e-02 -6.90328479e-02 -2.51899175e-02  1.28765032e-02
 -1.80132743e-02  2.27715180e-04  1.27624860e-02 -6.49575460e-33
 -3.27397175e-02 -4.37929407e-02  5.55820018e-03  2.60718092e-02
 -2.52341833e-02  8.89028015e-04 -2.04165303e-03 -5.32890707e-02
  2.98789912e-03 -3.02708186e-02 -7.85902794e-03  6.06423942e-03
  1.00210430e-02  1.99338957e-03 -3.53176482e-02 -2.62754317e-02
 -9.68339387e-03 -2.07633805e-02 -5.46558294e-03  1.05467001e-02
  4.09705229e-02  3.49684581e-02  6.56529814e-02 -3.24912481e-02
 -1.80213433e-02  3.74117191e-03 -3.70045491e-02 -1.50972446e-02
 -5.05821966e-02  1.91209130e-02 -5.04069403e-02 -4.87806536e-02
 -5.15330071e-03 -6.87167123e-02 -3.61308418e-02  2.06885282e-02
 -4.43278030e-02 -3.56583074e-02  3.94542292e-02  4.35924670e-03
 -5.54497764e-02 -2.73017902e-02  7.59153515e-02  1.25971958e-02
 -3.31907123e-02 -5.72262183e-02 -3.05303792e-03 -2.40142103e-02
 -4.98408526e-02  1.48697281e-02 -3.46284583e-02  5.60307875e-03
 -1.35255139e-02  9.90715623e-03  4.10540961e-02  5.82776628e-02
  4.34340499e-02  7.64497370e-03 -7.56672174e-02  3.49195935e-02
  1.78576075e-02  7.83197433e-02 -5.63507807e-03  5.41890636e-02
  3.71346138e-02  3.44846025e-02  6.62047565e-02  3.75095318e-04
 -2.11228840e-02 -1.77421719e-02 -2.11168975e-02 -1.84146166e-02
  6.77381083e-02 -7.73501545e-02  3.53717282e-02 -1.23692667e-02
 -4.31051515e-02 -1.48018228e-03 -1.29713178e-01  3.88340764e-02
  6.32626861e-02  3.01655866e-02 -6.60624728e-02 -2.28276756e-02
 -7.54027814e-03 -7.72081316e-02 -6.68610493e-03  3.05245374e-03
  8.72476306e-03  8.17123894e-03  2.96568335e-03  1.07719988e-01
 -1.17868488e-03 -9.82755143e-03  5.97374924e-02 -1.22467587e-02
  1.65198352e-02  3.27086672e-02 -1.57129089e-03 -1.08733522e-02
 -3.76070403e-02  4.48393561e-02 -4.53170063e-03 -8.72347783e-03
  2.29412448e-02  3.23677175e-02  2.71517057e-02  4.20704111e-02
 -1.48573881e-02 -7.65342414e-02 -4.57915217e-02  1.20599242e-02
 -6.87919417e-03 -7.41460035e-03  3.39337848e-02 -3.42793204e-02
 -6.96096104e-04  4.53090928e-02  3.01206615e-02  3.21555026e-02
 -2.84088682e-03  7.67729431e-03  1.60163024e-03  1.29174311e-02
 -1.09046167e-02 -1.99100375e-02 -3.64816040e-02  8.06236118e-02
  3.41662429e-02 -4.19196710e-02 -4.18645181e-02  1.97329726e-02
  2.74726631e-07  4.52586375e-02  5.84631506e-03  3.34763601e-02
  3.93565185e-02  4.57327999e-02  4.29776497e-03  1.15298787e-02
  7.62591437e-02  6.07351251e-02  8.71998258e-03 -2.44053565e-02
  3.23739871e-02 -1.87038016e-02 -2.07044426e-02  2.30712835e-02
 -5.43887280e-02 -2.35050656e-02  2.33410974e-04  1.08960795e-03
  3.32492068e-02 -3.21780443e-02  6.87643662e-02  2.69047276e-04
  3.71865481e-02  1.76511016e-02 -1.46378363e-02  4.52660993e-02
  1.10538639e-02  5.33869006e-02 -4.42026146e-02  7.52502605e-02
 -1.18424855e-02 -3.41082364e-02 -7.86934327e-03 -2.41180900e-02
  3.08841541e-02  2.82994322e-02  5.47093190e-02 -3.83019112e-02
 -3.12850215e-02 -1.79803260e-02 -1.67834703e-02  1.50698358e-02
 -8.19478408e-02  1.67209785e-02 -3.66293490e-02 -2.22353302e-02
 -1.03085265e-02 -1.48539211e-05  3.58606689e-02 -3.09570618e-02
  6.39238348e-03 -3.70166674e-02 -4.89792936e-02  1.37779340e-02
 -3.79494354e-02  2.35991064e-03 -4.11030278e-02 -3.15026119e-02
 -3.31976591e-03 -5.21053746e-02 -8.76407325e-03 -1.54594565e-02
 -5.37158968e-03 -9.21951898e-04 -3.58981155e-02 -5.93788661e-02
  2.69006005e-34 -1.97340511e-02 -1.78696681e-02  2.92694848e-03
 -1.65921915e-02  2.57721692e-02 -6.59646541e-02  1.82228722e-02
  8.80141091e-03  3.66687179e-02 -3.26623954e-02 -7.40087852e-02]"
"Scaled Dot-Product Attention
Multi-Head Attention
Figure 2: (left) Scaled Dot-Product Attention. (right) Multi-Head Attention consists of several
attention layers running in parallel.
of the values, where the weight assigned to each value is computed by a compatibility function of the
query with the corresponding key.
 3.2.1
Scaled Dot-Product Attention
 We call our particular attention ""Scaled Dot-Product Attention"" (Figure 2). The input consists of
queries and keys of dimension dk, and values of dimension dv. We compute the dot products of the
query with all keys, divide each by √dk, and apply a softmax function to obtain the weights on the
values.
 In practice, we compute the attention function on a set of queries simultaneously, packed together
into a matrix Q. The keys and values are also packed together into matrices K and V . We compute
the matrix of outputs as:
Attention(Q, K, V ) = softmax(QKT
√dk
) V
(1)
The two most commonly used attention functions are additive attention [2], and dot-product (multi-
plicative) attention. Dot-product attention is identical to our algorithm, except for the scaling factor
of
1
√dk . Additive attention computes the compatibility function using a feed-forward network with
a single hidden layer. While the two are similar in theoretical complexity, dot-product attention is
much faster and more space-efficient in practice, since it can be implemented using highly optimized
matrix multiplication code.
 While for small values of dk the two mechanisms perform similarly, additive attention outperforms
dot product attention without scaling for larger values of dk [3]. We suspect that for large values of
dk, the dot products grow large in magnitude, pushing the softmax function into regions where it has
extremely small gradients 4.","[-5.12968190e-03 -2.54530013e-02 -1.68101173e-02  2.09850017e-02
 -9.61593259e-03  8.96521471e-03  4.07929160e-02  1.41008468e-02
 -5.92111656e-03 -1.56067368e-02 -2.13636626e-02 -6.30050227e-02
 -2.24072672e-03  6.38184324e-02  2.33092457e-02 -1.56333316e-02
  2.26994865e-02  1.30382897e-02 -7.00811893e-02 -8.47337861e-03
  2.16760039e-02 -2.76769288e-02  1.54113341e-02  1.15122553e-02
 -3.68770659e-02  1.84634384e-02 -3.37814987e-02  1.92322512e-03
  3.67671251e-02  2.18530763e-02  1.58287573e-03  2.12165862e-02
  6.24320656e-03  7.56927533e-03  2.28449312e-06 -1.66736767e-02
  6.79772720e-03 -2.59174071e-02  3.61817740e-02  5.27410656e-02
 -3.02707534e-02 -1.16158212e-02  3.61227877e-02 -8.38085078e-03
 -1.43230371e-02 -5.23599088e-02  6.17903396e-02  4.82637584e-02
  4.60785888e-02  5.52345365e-02  5.87324752e-03 -3.23172249e-02
  2.48411782e-02 -3.38996165e-02  4.01260518e-02 -9.58913416e-02
  4.06348594e-02 -4.70420867e-02 -1.29460106e-02  1.77399255e-02
  1.31898420e-02  6.09551147e-02 -1.95859093e-02 -1.13630956e-02
  8.75319541e-02  3.46271954e-02  1.81242470e-02  9.75904800e-03
 -1.05517358e-03  1.11552358e-01 -4.75722589e-02  1.67505369e-02
  3.25706266e-02 -1.64304469e-02 -5.32963965e-03 -2.70379186e-02
 -3.85270379e-02 -3.93464193e-02  1.81324482e-02  4.10219328e-03
 -3.53747867e-02  2.02215575e-02  2.31446642e-02 -4.56289947e-03
 -2.00335514e-02  2.23533474e-02 -2.39717010e-02  7.79756345e-03
 -2.02542748e-02 -4.71350253e-02 -2.25577522e-02 -2.62368191e-02
  4.05426025e-02  3.85359228e-02 -6.25563727e-04 -1.15074841e-02
 -3.10455207e-02 -6.13665171e-02 -1.63685717e-02 -1.20078698e-01
  9.51772332e-02  3.51281092e-02 -2.19853371e-02  6.93002492e-02
 -3.66239622e-02  6.77171201e-02 -5.63366003e-02 -4.73171734e-04
 -2.06106808e-02  4.59123813e-02 -1.63625330e-02  3.17448564e-02
 -2.89172102e-02  6.81156218e-02 -2.96309032e-02 -4.24222276e-02
 -2.92093437e-02  2.05522515e-02 -1.50415245e-02 -1.70287117e-02
 -1.34473853e-02  3.59825790e-02 -2.22819913e-02 -3.12098078e-02
 -1.17961382e-02  6.25208989e-02 -4.79537547e-02  7.08867563e-03
 -2.38895509e-03 -6.53049583e-03 -2.48184782e-02 -3.32689518e-03
  3.84928808e-02 -1.24611249e-02  1.76268425e-02  3.86467762e-02
 -1.79804340e-02 -4.76496294e-04 -4.31942083e-02 -3.71862054e-02
  5.84143028e-03 -3.31773423e-03  1.11983009e-02 -4.41448996e-03
  6.77700490e-02 -3.31178904e-02 -3.19085233e-02 -3.07351258e-03
 -2.20160396e-03  1.26835890e-02 -5.95688485e-02  8.95670205e-02
  6.79515675e-02 -4.92012454e-03  2.74568107e-02 -2.88200341e-02
  2.45005032e-03  8.82696658e-02 -6.35367120e-03  6.08274899e-02
 -4.09480976e-03 -1.48793850e-02 -2.28198506e-02 -3.37125584e-02
  3.11084893e-02 -1.63944531e-02 -4.87690642e-02  2.70262249e-02
  2.72273775e-02  2.77858730e-02  9.62719508e-03  2.34796070e-02
 -1.96946207e-02 -3.90309095e-02  3.55604887e-02  1.82691570e-02
  3.88380922e-02  6.44026101e-02  8.24342575e-03 -2.84625646e-02
 -5.33929132e-02  2.02250723e-02 -5.52471541e-02  1.05405889e-01
 -4.43557464e-02 -4.20215949e-02  2.57081948e-02  7.13740569e-03
 -5.14390245e-02 -2.66536009e-02  3.31879072e-02  2.33978755e-03
 -1.18840914e-02 -5.53033408e-03  2.30953339e-02 -3.08965053e-02
 -6.00414015e-02  1.91070046e-03 -5.86859649e-03 -2.06011254e-02
  7.59959221e-03 -3.84708829e-02 -2.59185210e-02  8.11699219e-03
  1.00327209e-02 -4.96569872e-02 -1.54144242e-02  1.47132603e-02
 -7.41529884e-03 -4.11729701e-02  5.22411540e-02  1.42484149e-02
 -7.10023893e-03 -5.62138818e-02  3.01088020e-03 -1.59213021e-02
  5.76490164e-03  3.46405543e-02 -4.74987142e-02  4.34372202e-02
  2.51081698e-02 -6.26616413e-04 -6.51984802e-03 -5.42802643e-03
  6.30293787e-02 -3.34239602e-02  5.46593331e-02  3.82195562e-02
  1.76556651e-02  3.65127362e-02  3.83002125e-02  3.51285487e-02
  3.23434323e-02 -2.28719618e-02  1.27551928e-02 -5.94419092e-02
  9.14587639e-04  2.31971424e-02  1.22784600e-02 -6.64405292e-03
  2.89325584e-02  3.48255560e-02 -7.14398571e-04 -4.27432135e-02
  7.94792771e-02 -2.24227365e-02 -4.37627323e-02 -1.18304184e-02
 -4.63973125e-03 -1.17012970e-02  3.17413211e-02 -3.74923237e-02
  5.87548986e-02  1.12373754e-02  2.53148749e-02 -1.12989182e-02
 -3.40185650e-02  1.33615853e-02 -2.07006205e-02 -3.75953823e-04
 -2.85919057e-03 -4.62229848e-02  3.07966899e-02 -2.73521915e-02
 -6.97646365e-02 -3.78924166e-03 -1.84544595e-03  2.35475488e-02
  1.25157656e-02 -2.14571133e-02  2.14181375e-02  2.65581366e-02
  4.96959090e-02  4.87086959e-02 -2.93603782e-02 -4.21560928e-02
  8.74409676e-02 -1.71773229e-02  4.20120172e-03  1.29420767e-02
  2.61567403e-02 -1.21619599e-03 -3.49237584e-02 -5.94013184e-02
 -2.63387784e-02  3.47196907e-02  2.61809304e-02 -3.16373147e-02
 -1.08094681e-02 -1.19210575e-02 -3.76682952e-02  3.82678844e-02
 -1.07605392e-02 -2.85147987e-02 -3.69005986e-02 -7.96301961e-02
 -1.60374995e-02  1.34344473e-01  3.11153159e-02 -5.17516248e-02
  4.10843417e-02  1.08485501e-02 -5.09941839e-02  6.40106797e-02
 -6.14426620e-02  2.24771984e-02 -6.59501180e-03  1.30231250e-02
  3.03808898e-02  4.87938710e-02 -2.20919214e-02 -2.54195463e-02
 -6.11223802e-02 -3.28904553e-03  5.18705919e-02 -3.86551507e-02
 -3.61577831e-02  1.59031358e-02 -8.22005421e-03  5.11595793e-02
  6.15500892e-03 -1.44445403e-02  5.71169592e-02  2.83627864e-02
 -2.77469098e-03  8.84110760e-03  1.17222208e-03 -2.57199798e-02
  3.00599243e-02  2.50164536e-03  4.89516184e-02 -4.74557765e-02
 -4.01169658e-02 -2.33241403e-03  8.72230064e-03  1.49975605e-02
 -2.15164088e-02  7.81872347e-02  2.43657865e-02  2.28626337e-02
 -1.73170865e-02 -2.12342609e-02 -1.22318445e-02  3.14675607e-02
  1.34853777e-02  2.59878170e-02  2.17773709e-02 -1.67533103e-02
 -8.26550648e-02  4.44204882e-02  4.31966223e-02  1.06935706e-02
 -3.98959666e-02  9.94931813e-03 -1.41074825e-02  6.66460348e-03
  1.11775920e-02  6.66824281e-02 -6.82070386e-03 -1.16739457e-03
 -7.75568234e-03  2.53550895e-02  5.37638031e-02 -2.30278634e-02
 -5.81295136e-03  2.32644216e-03  3.46720293e-02 -2.18535308e-02
 -4.49303072e-03  2.56242380e-02  6.30484615e-03 -3.46589722e-02
  3.15197976e-04  2.47802883e-02 -2.08061282e-03 -1.04995221e-01
 -1.09439567e-02  6.23145979e-03 -3.62523086e-02  2.92882342e-02
  4.74506319e-02 -4.29209135e-02 -1.72168240e-02 -2.00584289e-02
  2.36830991e-02  1.62292924e-02 -5.12594245e-02  5.80755807e-03
 -4.90432680e-02  4.74721147e-03  2.36250833e-03 -4.71589193e-02
 -7.63311014e-02 -4.09150906e-02  3.57324891e-02 -1.65474676e-02
 -2.12709717e-02  4.52964008e-02  3.14535573e-03 -4.29689251e-02
 -5.38444193e-03  8.60932246e-02 -2.36067381e-02  1.22679323e-02
 -3.41415182e-02 -1.83743919e-04  6.88808262e-02 -1.08799683e-02
 -1.45027582e-02 -6.89036697e-02 -5.96314482e-03 -2.92324722e-02
  6.27925340e-03 -2.40720510e-02  2.90718004e-02 -1.14746448e-02
 -2.43288949e-02 -1.37353139e-02  8.43698345e-03 -4.65432229e-03
  7.54859522e-02 -1.35213854e-02  7.12116212e-02 -1.04661388e-02
 -4.89441566e-02 -3.98939289e-02 -7.05674477e-03 -2.91919112e-02
  1.90086216e-02  4.78035994e-02 -3.84615938e-04 -3.17161866e-02
 -6.29517715e-04  1.84699185e-02 -7.16992691e-02 -3.40761989e-02
  3.40841226e-02  1.03758862e-02 -2.85869390e-02 -3.12938616e-02
  5.98734664e-03 -3.16557736e-04  3.70597281e-02 -8.10216239e-04
 -6.95895776e-02  5.11174463e-02  2.74656084e-03 -1.88112576e-02
 -6.96027325e-03  2.19620187e-02  1.01799164e-02 -2.57803313e-02
  3.24078053e-02  3.54089215e-02 -3.76058258e-02 -7.73304328e-03
 -1.38311489e-02 -6.16590232e-02 -4.06214148e-02 -1.80895347e-02
  1.18290531e-02  1.43164573e-02 -1.84671972e-02 -4.39995639e-02
 -6.14059903e-02 -1.70469023e-02  6.02532066e-02 -3.58594954e-02
  2.44482886e-02  7.45473662e-03 -6.28195405e-02 -3.00938613e-03
  4.92252409e-02 -4.24035378e-02  1.38313351e-02  2.74112029e-03
  2.30310801e-02 -3.39923501e-02 -4.38105389e-02 -1.20015768e-03
  1.61247663e-02  4.63766642e-02  9.38288271e-02  2.80865226e-02
 -3.49351317e-02  3.30664851e-02  4.65402082e-02 -9.63201001e-03
 -5.52261584e-02 -2.92956326e-02  1.04186879e-02  2.16922089e-02
  1.05149606e-02 -2.97820549e-02  4.95136045e-02 -3.52485441e-02
 -5.73372468e-02 -1.59491203e-04 -3.11773140e-02 -2.07770988e-02
  2.24363580e-02 -2.73691519e-04 -3.70393023e-02  1.85832020e-03
  3.40693891e-02  5.14792055e-02 -1.33296000e-02 -2.59325653e-02
  2.77683735e-02  3.69861932e-03 -8.61454085e-02  6.67881034e-03
 -8.97096992e-02 -4.85979691e-02  2.67417170e-03 -2.60662101e-02
  3.78184505e-02 -2.96245376e-03  9.45266057e-03  1.78052299e-02
 -7.09799211e-03 -2.23074462e-02 -4.13779955e-04  2.00963523e-02
  2.49838252e-02  4.15923633e-02  3.43320370e-02  3.31673101e-02
 -1.37313912e-02  3.31662148e-02 -6.29637018e-02  7.95048755e-03
 -2.45251902e-03 -7.22420774e-03 -1.97763983e-02 -9.27618053e-03
 -1.61859840e-02  9.05380696e-02 -2.74541359e-02  2.55172011e-02
 -1.16256461e-03 -2.34225746e-02 -1.60105079e-02 -1.99812893e-02
 -5.08220214e-03 -1.59835275e-02  3.20576876e-02  3.08305975e-02
  4.31860685e-02 -2.00458094e-02  7.63322366e-03  2.35544760e-02
 -5.38026616e-02 -4.05685976e-02  2.05642004e-02 -7.01860273e-33
  7.41118146e-03  2.06061844e-02 -3.80408019e-02  7.72809191e-03
 -5.17605171e-02  3.67111601e-02 -2.01025046e-03 -1.88901648e-02
 -5.75631708e-02 -2.74647661e-02 -3.56425568e-02  2.27550277e-03
 -4.28955583e-03 -1.90729722e-02  4.22050953e-02 -3.95684987e-02
  5.18161245e-03 -3.54527438e-04  1.66306477e-02  7.62247518e-02
 -9.68429260e-03  2.38516293e-02  6.15701117e-02 -1.82431052e-03
 -1.84376985e-02  3.38173918e-02 -2.96912901e-02  3.01144719e-02
 -2.62877140e-02  3.45640294e-02 -1.67701617e-02  2.01314334e-02
  1.50295254e-02 -5.37805669e-02 -3.26645151e-02 -8.85395706e-03
 -8.14045966e-02 -1.89683791e-02  6.77912103e-05 -7.65774446e-03
 -2.88712736e-02  7.14064436e-03  9.09594446e-02  2.70900987e-02
  9.28972941e-03 -7.09158257e-02  4.81513254e-02  4.28883592e-03
 -5.95916845e-02 -8.46648123e-03  2.47303937e-02  2.36780569e-02
 -3.80495284e-03  2.08707955e-02  3.29936557e-02  4.87328433e-02
 -1.06389858e-02  3.72236036e-02 -7.76988119e-02  5.16597778e-02
  1.61034148e-02  5.76785691e-02  7.85025954e-03  6.21133633e-02
  1.78833306e-02  1.12800011e-02  6.20853454e-02  1.63044650e-02
 -5.29220290e-02 -2.72489600e-02 -5.72145823e-03  3.56190950e-02
  4.57407907e-02  3.80267535e-04  5.27706221e-02  6.57073501e-03
 -7.85515457e-02 -7.56313279e-03  1.45592093e-02  3.95062156e-02
  1.70920864e-02 -6.66243164e-03 -4.46195789e-02 -1.25049036e-02
  7.10261753e-03  4.66571674e-02 -9.11342949e-02 -1.42314741e-02
 -1.63752455e-02  2.34803315e-02 -2.35215425e-02  5.92534579e-02
 -1.77461542e-02 -2.66896598e-02  2.97646206e-02 -1.27207907e-02
  3.81096266e-02  4.21459367e-03  3.68716195e-02 -1.43773574e-02
 -2.04212349e-02  3.51362774e-04 -2.68127266e-02 -2.03142185e-02
 -1.00378934e-02  1.55416876e-02 -3.38476039e-02  3.18999588e-02
 -3.98800932e-02 -5.58226518e-02 -3.16519439e-02 -2.04002112e-02
  3.12392530e-03  7.50867371e-03  3.68654281e-02 -3.79484333e-02
  1.70343183e-02  6.80390075e-02  8.92540626e-03  8.28394480e-03
 -1.84008535e-02 -2.83021312e-02  1.66697819e-02  6.91619068e-02
 -6.93558156e-02 -1.14991842e-02 -6.27923608e-02  5.28327608e-03
  4.17274535e-02 -3.51393670e-02 -3.79094742e-02  5.32015488e-02
  3.14921749e-07 -3.77869536e-03 -8.49277654e-04 -1.13613736e-02
  3.24851498e-02  4.22807923e-03  6.75907657e-02  2.28685718e-02
  8.90112147e-02  6.41923305e-03 -3.18869241e-02  4.21107784e-02
  1.85747668e-02 -1.94582790e-02 -1.79766975e-02 -4.72223870e-02
 -5.70291355e-02 -1.39535023e-02  2.71621253e-02 -4.41156663e-02
 -1.72796529e-02 -1.97020080e-02  6.79252669e-02  6.77212514e-03
  1.56543832e-02  5.85375912e-02 -2.23487504e-02  4.93311929e-03
  2.22043600e-02  2.65688449e-02  1.15647698e-02  3.74452583e-02
 -2.53005885e-02 -4.37178686e-02  1.63122006e-02  4.88984864e-03
  4.79279570e-02 -6.66374573e-04  6.87055662e-02 -6.58819079e-03
 -3.50655504e-02  2.80362125e-02 -1.34876007e-02  1.17848897e-02
 -7.51725882e-02  7.15417638e-02 -7.16787064e-03 -3.93108204e-02
  3.57762501e-02  1.11606037e-02 -1.97897945e-02  1.26988031e-02
  7.44431792e-03  1.23313908e-02 -1.96257327e-03  1.39669446e-05
 -4.43317220e-02  2.93374620e-02 -8.01031291e-02  2.23000888e-02
  1.26452716e-02 -5.40386513e-02  3.05815513e-04 -5.81655428e-02
  3.40420031e-03  5.40878959e-02  5.91249354e-02 -4.11382727e-02
  2.64771080e-34  5.32142147e-02 -8.01950321e-03  3.03197019e-02
 -2.87345471e-03 -1.60539299e-02 -4.12438624e-02 -7.90292844e-02
 -8.52544885e-03  3.91572006e-02 -1.05837174e-01 -6.46333098e-02]"
"To counteract this effect, we scale the dot products by
1
√dk .
 3.2.2
Multi-Head Attention
Instead of performing a single attention function with dmodel-dimensional keys, values and queries,
we found it beneficial to linearly project the queries, keys and values h times with different, learned
linear projections to dk, dk and dv dimensions, respectively. On each of these projected versions of
queries, keys and values we then perform the attention function in parallel, yielding dv-dimensional
4To illustrate why the dot products get large, assume that the components of q and k are independent random
variables with mean 0 and variance 1. Then their dot product, q · k = Pdk
i=1 qiki, has mean 0 and variance dk.
 4
","[-3.11923921e-02  6.58950303e-03 -2.43651941e-02  2.31564771e-02
 -4.13480848e-02  3.58409132e-03  1.12722823e-02  2.92761670e-03
 -3.65963206e-02  2.28495002e-02 -4.06719819e-02 -7.46676996e-02
 -8.59538093e-03  2.41914876e-02  2.99876966e-02 -5.72033897e-02
  8.08154512e-03 -3.59786451e-02 -6.25703037e-02 -3.51387970e-02
 -1.29133342e-02 -5.59556782e-02  1.13563156e-02  4.81996773e-04
 -3.61131504e-02 -2.74399165e-02 -7.62861827e-03  7.41983205e-03
 -1.79206161e-03  5.64017100e-03 -5.51128164e-02  5.50585426e-02
 -2.80541759e-02  4.31148149e-03  1.83669192e-06 -2.36311369e-02
  2.86310185e-02 -2.21797973e-02  2.43889671e-02  8.57677311e-02
 -2.91495603e-02  1.61292367e-02  2.97047012e-02 -2.49101073e-02
  2.24778187e-02 -5.76010868e-02  2.33236533e-02  7.03467056e-02
 -1.25311110e-02  2.78591737e-02  1.08546894e-02  3.11922524e-02
  1.51559804e-02 -3.41363363e-02  5.12762070e-02 -1.05435953e-01
  3.01712845e-02 -2.67291181e-02 -3.07462551e-02  3.07374913e-02
 -9.77353100e-03  3.36029194e-02 -6.61129737e-03  2.15771683e-02
  8.97074714e-02  5.68541065e-02  3.34791131e-02  9.53843910e-03
  2.33227573e-02  8.31019878e-02 -3.99830863e-02 -5.91782853e-03
  1.13725215e-02  6.79011410e-03  1.73712857e-02  2.74443645e-02
 -7.72677064e-02 -2.23767906e-02  4.48390190e-03  5.52510563e-03
 -4.44110110e-02  4.38642241e-02  3.94567177e-02 -2.90882923e-02
 -1.29364729e-02  9.48712230e-03  2.50338148e-02 -1.47005087e-02
  7.69408944e-04 -2.44621523e-02 -4.09341864e-02  9.74763185e-03
 -3.26575823e-02 -4.13694466e-03  2.44322931e-03 -2.61871424e-03
  9.57479409e-04 -4.52062227e-02 -2.39823591e-02 -9.44715366e-02
  8.16023350e-02  2.84939501e-02 -7.88994599e-03  3.66429910e-02
 -1.88929252e-02  5.40477782e-02 -7.54775628e-02  2.80096121e-02
  5.70663484e-03  4.71719429e-02 -9.58743878e-03  1.79014858e-02
 -2.59505818e-03  5.44263199e-02 -3.49409953e-02 -2.60764323e-02
 -3.76076177e-02  4.95415665e-02  2.28695069e-02 -3.56871597e-02
 -1.40459891e-02  4.27170508e-02 -4.31704484e-02 -1.06444387e-02
 -2.93268319e-02  5.82936294e-02 -3.58911939e-02  1.50639461e-02
 -7.63898809e-03  1.18237280e-03 -4.51562032e-02 -2.31109583e-03
  2.53529251e-02 -3.83037366e-02 -3.97868492e-02  6.32786378e-02
  3.61657212e-03 -1.14010191e-02 -1.95485167e-02  2.50976114e-03
 -2.61440836e-02 -1.33776264e-02  3.21561992e-02 -1.23742959e-02
  5.98383881e-02  1.69955648e-03 -4.87055145e-02 -1.20964553e-02
  9.07734875e-03 -1.21296067e-02 -6.81213289e-02  9.17891935e-02
  9.29387361e-02 -1.48852188e-02  3.03413104e-02  3.38670635e-03
 -8.72643664e-03  1.13665462e-01  1.20193688e-02  3.08666602e-02
 -1.11139221e-02  1.47864956e-03  1.88782960e-02 -2.49412190e-02
  4.07686122e-02 -1.59363113e-02 -5.04068546e-02  1.10419039e-02
  5.48626781e-02  2.40784809e-02  3.69362682e-02  5.20449802e-02
 -2.99363192e-02 -1.39625976e-02  4.26469781e-02  2.60367105e-03
  4.71797697e-02  3.93400453e-02 -1.06902961e-02 -3.90327647e-02
 -4.23804596e-02  5.79501502e-02 -5.41346334e-02  7.12536946e-02
 -7.31938425e-03 -5.29996213e-03  3.74972187e-02 -8.63802806e-03
 -3.57196517e-02 -5.45797274e-02 -6.36268640e-03  4.86791879e-03
 -5.29318713e-02 -3.64518464e-02  4.71901596e-02 -2.36245077e-02
 -4.14805189e-02  1.19312396e-02  1.05474023e-02 -3.35532352e-02
  1.14276316e-02  8.36953428e-03 -2.43923403e-02 -2.79778354e-02
  1.40837785e-02 -1.20950202e-02  7.37535083e-05 -6.84601534e-03
 -1.00811459e-02 -5.58898412e-02  3.79009061e-02 -4.98612458e-03
 -1.31401699e-02 -4.14244318e-03 -2.17094142e-02 -4.73051146e-03
 -8.67468712e-04 -9.33423918e-03 -3.13973166e-02 -2.70142686e-03
  2.64216531e-02 -3.65893878e-02  1.54674454e-02 -1.50144501e-02
  2.08974257e-02 -6.05825894e-02  1.65162310e-02  3.55564058e-02
  1.48041723e-02  2.03895140e-02  1.96257252e-02  4.61248681e-02
  4.30504382e-02 -3.35019045e-02 -1.67491997e-03  2.60139070e-03
  2.34341864e-02  4.99602733e-03  6.95671840e-03  1.01696122e-02
  3.85236815e-02 -1.26829855e-02  3.25028710e-02 -4.05692533e-02
  7.75333568e-02 -3.04427911e-02 -5.38658863e-03 -6.37841877e-03
 -1.69475190e-02  2.79998966e-03  4.42751385e-02 -1.88615546e-02
  8.28519091e-02 -2.69306302e-02 -1.26765473e-02  3.27435439e-03
  1.12837153e-02 -2.50995596e-04 -1.48068313e-02  4.07388881e-02
  1.25659048e-03 -2.08217856e-02  3.81730348e-02 -3.38614248e-02
 -8.83238688e-02  3.69224690e-05 -1.24680800e-02  5.19272536e-02
  4.07810789e-03 -1.42101543e-02  4.54737097e-02 -7.91352242e-04
  5.15006036e-02  1.36408294e-02 -1.82571784e-02  1.56683549e-02
  6.31780596e-03  2.08208542e-02  6.40760455e-03  2.35070679e-02
 -5.95927797e-03 -2.59881485e-02  8.73992778e-03 -4.20895107e-02
 -2.68712584e-02  2.93573141e-02  6.63141347e-03  3.68179963e-03
  1.23702716e-02  4.16408740e-02 -8.88077449e-03  4.75210790e-03
 -1.75544024e-02  1.82772090e-03 -5.25390692e-02 -7.35130534e-02
  4.74410988e-02  1.19166784e-01 -1.16130505e-02 -1.34214768e-02
  5.20022549e-02 -8.64391867e-03 -1.68561079e-02  3.54101062e-02
 -6.28312677e-02  2.38819011e-02 -1.38677228e-02  5.72335441e-03
  3.20247076e-02  5.71351014e-02 -3.29234339e-02 -3.52763794e-02
 -3.13535295e-02  1.70259252e-02  2.28147171e-02 -2.90815588e-02
 -2.39656083e-02  3.25027481e-02 -4.26526815e-02  8.90144333e-02
  8.26925319e-03 -1.68645289e-02  5.63097261e-02  3.77980508e-02
  1.41692273e-02 -1.83353201e-02  4.34879400e-02  8.00207444e-03
  2.30982192e-02 -2.05571912e-02  2.36902665e-02 -6.83638379e-02
 -4.69646454e-02 -2.79359557e-02 -4.84729651e-03 -7.89908133e-03
 -6.74882764e-03  9.21936855e-02  2.84255319e-03 -3.18702543e-04
 -1.61914863e-02 -2.69725248e-02 -2.65526045e-02  4.15728837e-02
 -4.29228274e-03  2.24599354e-02  1.84066985e-02 -2.03971881e-02
 -1.94350276e-02  1.73547305e-02  5.60987107e-02 -4.18485962e-02
 -5.54524735e-02 -1.61276627e-02  4.80648549e-03  1.02062803e-02
  4.56364360e-03  3.72032374e-02 -6.70480495e-03 -3.83651629e-02
  1.65252876e-03  2.54123751e-02  8.29618424e-02  8.43021180e-03
  3.18832248e-02 -1.83529239e-02  6.13142131e-03 -1.14988431e-03
 -2.26282179e-02  2.15568021e-02  1.12588145e-03 -2.05837302e-02
 -2.63699964e-02  1.35784382e-02 -1.72431991e-02 -5.90887666e-02
  1.71840061e-02 -1.87348593e-02  9.62710101e-03  2.35677827e-02
  4.43392545e-02 -3.02532613e-02 -9.46393609e-03 -3.38595547e-02
  3.15183364e-02  5.39766252e-02 -1.71997771e-02  3.97827700e-02
 -7.73644075e-02  4.11460409e-03  1.95027385e-02 -7.42931068e-02
 -7.20084235e-02 -3.05616520e-02  7.05661206e-03 -6.48594722e-02
 -1.36288274e-02  3.92320417e-02 -3.68206427e-02 -2.17686798e-02
  2.12143045e-02  5.97453602e-02 -3.56815644e-02  5.84262982e-03
 -3.28776278e-02 -1.12277931e-02  6.57461584e-02 -2.01946553e-02
 -3.89614552e-02 -9.23859477e-02 -4.03595045e-02 -1.83440112e-02
  1.66253988e-02  7.26671144e-03  4.13190275e-02  2.09345273e-03
 -6.88042305e-03 -8.92934762e-03  1.22505324e-02  1.23145850e-02
  4.11720127e-02 -2.38324236e-02  6.80253655e-02 -2.01383550e-02
 -5.29338121e-02 -2.91929045e-03 -1.37156919e-02 -4.34678607e-02
  3.21055166e-02  5.73573522e-02  7.57116498e-03 -4.29196768e-02
 -1.87073816e-02  3.44566517e-02 -4.15337346e-02 -1.84854232e-02
  3.04217786e-02  1.73159242e-02 -5.39628901e-02 -5.95741384e-02
  1.25100533e-03  4.53298306e-03  7.09064230e-02 -2.48092338e-02
 -1.35134514e-02  1.49878496e-02  1.51092829e-02  1.49071394e-02
  1.63602596e-03  8.95613153e-03 -2.22917963e-02 -1.27404341e-02
  5.72196208e-02  7.44593609e-03 -4.73522916e-02 -9.09589790e-03
 -2.20261067e-02 -9.01436359e-02 -5.55069931e-02  3.72112449e-03
  4.50618230e-02  2.23213509e-02  2.40936689e-02 -1.61835346e-02
 -5.15527502e-02 -1.10233705e-02  2.32821703e-02 -2.94060330e-03
  3.29149552e-02  1.56566612e-02 -7.13480916e-03  6.75418507e-03
  4.48030271e-02 -2.70638317e-02  2.70695444e-02  1.20707741e-02
  3.83566469e-02 -2.41878591e-02 -4.98416796e-02 -4.63257954e-02
  1.64477341e-02  1.05577499e-01  8.34606886e-02  6.48335665e-02
 -2.28438694e-02  4.98554111e-02  1.21431779e-02  1.03543447e-02
 -3.12752761e-02 -5.60897728e-03  3.68815176e-02  2.98114382e-02
 -1.12338513e-02 -8.89404211e-03  3.15670669e-02 -4.63534556e-02
 -4.72350344e-02 -1.60995778e-02 -1.53950118e-02 -4.85619605e-02
  4.34842035e-02  7.42992619e-03 -2.13918183e-02  1.98302213e-02
  2.46884674e-02  3.24128270e-02  1.97318122e-02 -1.70365982e-02
  1.37751400e-02 -7.29725510e-03 -5.89341335e-02 -6.02971055e-02
 -1.14084780e-01 -8.69294852e-02  3.14170159e-02 -2.63836775e-02
  4.04746719e-02 -2.52571385e-02  2.88713407e-02 -3.52373384e-02
 -8.49137548e-03 -3.19069810e-02  1.18274381e-02  2.04637833e-02
  5.64054586e-02  5.75708710e-02  7.09956838e-03 -1.72137134e-02
 -2.27582641e-02  4.78024222e-02 -2.34622024e-02  1.17013650e-02
 -4.20976467e-02 -5.54167340e-03 -2.53243931e-02 -1.88185629e-02
  2.50566807e-02  5.95432706e-02 -2.28750370e-02  3.61319371e-02
 -6.69532940e-02 -3.02565265e-02 -1.97447068e-03 -3.41119878e-02
  1.04512344e-03 -3.95240076e-02  1.27280178e-02  3.42956521e-02
  3.02530285e-02 -4.08805199e-02  1.87808741e-02  3.22197117e-02
 -2.55361404e-02 -3.97750698e-02  4.23111469e-02 -6.14839308e-33
  1.06704207e-02  3.72971185e-02 -2.40644030e-02  2.50963215e-02
 -3.32739502e-02  3.09835491e-03  4.17215098e-03 -2.49298234e-02
 -2.14408338e-02 -1.07227005e-02 -3.21014300e-02  1.70445573e-02
 -8.85628816e-03 -1.32466666e-02  6.01950511e-02 -3.72383036e-02
  2.75765248e-02 -6.34357915e-04  1.45031661e-02  9.17588696e-02
  2.25058049e-02  4.95225117e-02  6.79742321e-02  1.78116933e-02
 -1.99435409e-02  1.38178337e-02 -7.40471482e-03  2.22601350e-02
 -5.89812063e-02  3.41712348e-02 -3.46325450e-02  4.10783198e-03
 -1.16709741e-02 -5.18833064e-02 -4.84106801e-02 -2.15532221e-02
 -2.08480214e-03 -2.75920774e-03 -2.16952562e-02 -2.29292829e-02
 -3.65734994e-02 -3.99263389e-02  6.90926313e-02  2.15275902e-02
 -9.86986980e-03 -5.80466464e-02  3.81258279e-02  1.57369841e-02
 -1.11101374e-01  1.48968780e-02 -5.98962372e-03  1.14532374e-02
  1.30098395e-03  1.60757471e-02  1.71385109e-02  1.09785888e-02
  4.57325345e-03  6.57261163e-03 -6.14031851e-02  4.30357456e-02
  3.09819281e-02  4.04966585e-02 -1.18593136e-02  6.21685944e-02
  3.98205630e-02  1.23191793e-02  9.16831121e-02  7.93384481e-03
 -6.52020499e-02 -2.85447836e-02 -1.90596022e-02  7.28916079e-02
  4.59624035e-03 -4.74660983e-03  5.14824800e-02  7.92661775e-03
 -7.56970420e-02 -7.54819019e-03 -4.26210538e-02  5.98040968e-02
  5.35650225e-03 -1.41596049e-02 -6.35885224e-02 -2.97398288e-02
  4.38784529e-03  3.04992404e-02 -4.35934924e-02 -1.82857085e-02
  6.66259497e-04 -6.96055498e-03 -1.53772328e-02  3.54715660e-02
 -9.91052762e-03 -1.57596767e-02  1.76330600e-02 -2.85443547e-03
  3.49156074e-02  7.01561663e-03 -3.30161909e-03 -3.96685600e-02
 -2.49797292e-03  2.29840856e-02 -4.72264551e-02 -4.14529629e-03
 -1.14355749e-02  3.36625725e-02  1.17333466e-02  3.00501240e-03
 -3.32174674e-02 -6.31150827e-02 -4.23828065e-02 -3.87028828e-02
  3.78690809e-02  1.76639389e-03  8.35554451e-02 -7.30725452e-02
  1.17646474e-02  3.39832976e-02  2.78881751e-02  4.68987040e-02
 -2.55244430e-02 -6.80100825e-03  5.61060058e-03  4.87164445e-02
 -2.14921553e-02  1.19180197e-03 -5.23740649e-02 -1.55098643e-02
  1.81315709e-02 -6.01107627e-02 -5.78590930e-02  1.61118209e-02
  2.76764467e-07  1.59779582e-02  2.66329665e-02  1.18165128e-02
  4.08539139e-02  1.24413036e-02  4.80869673e-02 -9.88253579e-03
  7.26164356e-02 -9.57444124e-03 -1.64437722e-02  3.15768756e-02
  2.99776793e-02 -8.81201308e-03 -2.43313536e-02 -4.19128835e-02
 -4.25870791e-02 -9.48941708e-03  6.99575320e-02 -4.39863838e-02
 -1.24065466e-02 -4.77013178e-02  4.88496497e-02  1.25452643e-02
  5.41266752e-03  5.53313419e-02  2.19121445e-02  4.98580076e-02
  2.03753468e-02  6.06261380e-03  1.66220702e-02  4.10561003e-02
 -3.28802653e-02 -2.37051472e-02  4.10404913e-02 -1.95447113e-02
  3.72030064e-02 -1.16303877e-03  6.62724599e-02  9.35967825e-03
 -1.58255193e-02  1.01871844e-02 -5.01821190e-03  1.95685010e-02
 -3.98457758e-02  8.10992271e-02 -9.80500504e-03 -1.74088739e-02
  1.18572749e-02  3.86661030e-02  2.12628283e-02  5.53041771e-02
  1.79890543e-02  2.02760193e-02 -2.82579921e-02 -2.09178608e-02
 -3.78783233e-02  4.19984534e-02 -4.58755307e-02  3.44981849e-02
  4.11010571e-02 -4.43199724e-02 -4.36802022e-02 -1.96459144e-02
 -5.51453000e-03  2.65330151e-02  5.00129350e-02 -7.65374824e-02
  2.65718455e-34  5.45628406e-02  9.59542394e-03  3.77557017e-02
 -1.81483123e-02 -1.66247953e-02 -8.37092698e-02 -3.39595079e-02
 -2.75609698e-02  2.90881842e-02 -7.22205043e-02 -5.74139543e-02]"
"output values. These are concatenated and once again projected, resulting in the final values, as
depicted in Figure 2.
Multi-head attention allows the model to jointly attend to information from different representation
subspaces at different positions. With a single attention head, averaging inhibits this.
 MultiHead(Q, K, V ) = Concat(head1, ..., headh)W O
where headi = Attention(QW Q
i , KW K
i , V W V
i )
 Where the projections are parameter matrices W Q
i
∈Rdmodel×dk, W K
i
∈Rdmodel×dk, W V
i
∈Rdmodel×dv
and W O ∈Rhdv×dmodel.
 In this work we employ h = 8 parallel attention layers, or heads. For each of these we use
dk = dv = dmodel/h = 64. Due to the reduced dimension of each head, the total computational cost
is similar to that of single-head attention with full dimensionality.
 3.2.3
Applications of Attention in our Model
The Transformer uses multi-head attention in three different ways:
• In ""encoder-decoder attention"" layers, the queries come from the previous decoder layer,
and the memory keys and values come from the output of the encoder. This allows every
position in the decoder to attend over all positions in the input sequence. This mimics the
typical encoder-decoder attention mechanisms in sequence-to-sequence models such as
[38, 2, 9].
 • The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.
 • Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position.","[-3.24424775e-03 -6.10397244e-03 -2.20976048e-03  1.97591335e-02
 -3.04619558e-02  3.19168679e-02  3.35136764e-02 -1.39583535e-02
 -5.67077361e-02 -1.21515691e-02 -1.26074320e-02 -2.25316435e-02
  1.16773108e-02 -1.28875589e-02  2.70764828e-02 -7.35918283e-02
  2.19680574e-02  5.12652472e-03 -6.39641285e-02  7.61054037e-03
 -3.49391699e-02 -4.52540591e-02  1.89250559e-02  1.06611205e-02
 -2.08356250e-02 -1.32510541e-02 -6.41952306e-02 -1.44587886e-02
  3.74133065e-02 -4.51538013e-03 -3.62587646e-02  5.97184636e-02
  3.53734083e-02 -1.35158738e-02  2.34476488e-06 -1.26929779e-03
 -1.32464357e-02 -1.63523592e-02 -1.18305243e-03  4.01209034e-02
 -2.11198144e-02 -4.04825956e-02 -1.65769421e-02 -8.22779071e-03
  1.89383049e-02 -1.01920497e-02  8.09430704e-02  2.87275854e-02
  7.11432770e-02  3.35937664e-02 -1.71978172e-04 -8.06400552e-02
  2.89127529e-02 -2.90121604e-02  9.17456765e-03 -4.12843302e-02
  4.10353541e-02 -3.34294848e-02 -2.26781871e-02  1.51804918e-02
 -6.05060942e-02  4.64656465e-02  2.74413656e-02 -1.14337597e-02
  2.51387283e-02 -4.05879080e-04 -1.73258130e-03 -4.32762206e-02
 -2.68878490e-02  3.20741199e-02 -8.15653503e-02 -2.04521213e-02
  7.86904804e-03  1.22722900e-02 -1.82374613e-03 -4.82660383e-02
 -5.19562438e-02  2.74986643e-02  1.13901892e-03 -1.62651408e-02
 -7.58232502e-03  5.67581914e-02 -2.10379418e-02 -5.64384572e-02
 -3.66784371e-02 -7.26433843e-03  9.20709036e-03 -1.48008121e-02
 -4.65107299e-02 -1.21163270e-02  1.34234792e-02 -1.91484801e-02
  2.27382500e-02  6.48202971e-02  3.31019238e-02 -1.43515654e-02
 -3.87255251e-02 -6.07920140e-02 -1.56932026e-02 -1.16933100e-01
  7.61481673e-02  6.28924668e-02  1.50056928e-03  1.12149622e-02
 -2.32270472e-02  6.25884384e-02 -7.48671517e-02  2.96328533e-02
 -4.92219925e-02  1.73500106e-02  1.06046656e-02  1.56578533e-02
 -6.06539249e-02  4.15229574e-02 -2.83660349e-02 -1.98259931e-02
 -2.90264767e-02  2.04210971e-02  2.41556019e-02 -1.51712475e-02
  1.68024004e-02  1.79629901e-03 -5.31764440e-02 -1.65784732e-02
  1.30766407e-02  7.12478831e-02 -9.84534994e-03 -5.00975326e-02
  1.36420215e-02 -3.11019383e-02 -6.48610964e-02  1.10983681e-02
  1.23343216e-02 -7.48979161e-03 -2.67864373e-02  8.25767294e-02
 -4.80453763e-03 -2.89320461e-02 -8.58189631e-03  6.13838900e-03
 -1.46811893e-02 -6.05125912e-03  4.66525033e-02  1.91687886e-03
  3.58286016e-02  2.07620636e-02 -3.49336825e-02  5.36432303e-03
  1.63326599e-02  2.14501712e-02 -1.55549170e-03  4.15494367e-02
  4.76120897e-02 -3.81142348e-02  3.88914533e-02  1.36831747e-02
  2.11661193e-03  4.65471707e-02 -5.81163389e-04  4.59564142e-02
 -4.02669758e-02 -5.46720028e-02  1.18278861e-02 -1.51402317e-03
  1.77138168e-02 -2.27522906e-02 -4.61325869e-02 -3.00538773e-03
  4.43022922e-02  8.26617889e-03  5.23699448e-02  3.89173627e-02
 -2.36985814e-02 -3.61113399e-02  3.53250466e-02  2.23183054e-02
  6.89637586e-02  4.57505360e-02  2.71227658e-02 -4.42307536e-03
 -1.59234386e-02  4.60398719e-02 -1.04979165e-02  1.44902945e-01
  1.52595788e-02 -7.02973083e-03  2.56859865e-02  3.22961062e-02
 -2.87219584e-02 -5.36684366e-03  4.24524827e-04  2.62022521e-02
 -1.23031326e-02 -2.97624432e-02  1.47486394e-02  1.21434834e-02
 -9.50240344e-02  4.69175950e-02 -1.76433641e-02 -6.71397969e-02
 -1.16565498e-02 -2.07951684e-02 -3.88008431e-02  2.87998319e-02
  8.75834096e-03  4.74131107e-03 -7.12161232e-03 -1.90760922e-02
 -3.05085033e-02  1.43127991e-02  1.52000058e-02  1.76780280e-02
 -2.99030542e-02 -5.50323203e-02 -2.86412612e-02  2.84638833e-02
 -6.45340839e-03  4.26615104e-02 -3.78712602e-02 -2.66232193e-02
  1.27173972e-03  5.69906868e-02  2.26883255e-02 -1.58951730e-02
  2.84796115e-02 -2.16947566e-03 -3.31575684e-02  1.32796792e-02
  3.22101973e-02  2.08834708e-02  1.95791516e-02  3.91908661e-02
  6.71647415e-02 -1.59517005e-02  1.13618597e-02 -1.58511791e-02
 -5.57013862e-02 -1.99255790e-03  1.45269698e-02 -2.31732316e-02
  2.29691733e-02  2.61198543e-02  2.37978846e-02 -7.25415349e-02
  3.82564738e-02 -7.72304013e-02  4.45316406e-03 -2.37356219e-02
  4.08653244e-02  1.32322079e-02  4.02032137e-02 -1.04551157e-02
  5.27184904e-02 -4.91694547e-02  1.47013636e-02  2.26182323e-02
 -3.50186462e-03 -4.75960923e-03 -3.95741463e-02  3.32600363e-02
  4.17061523e-02 -2.54306290e-02  3.57711688e-03  1.46569135e-02
 -5.85453659e-02 -2.40640924e-03 -2.38232352e-02  3.25506069e-02
 -2.70914156e-02 -1.62454285e-02  2.20409781e-02  2.80802213e-02
  1.52627528e-02  5.40281385e-02 -9.44304653e-03 -2.00277064e-02
  4.46089506e-02  6.51688781e-03 -2.24132873e-02  2.69504990e-02
  8.77583749e-04 -3.38838547e-02 -2.96287071e-02 -6.16032034e-02
  1.99310221e-02  5.95693849e-02 -7.25017581e-03 -6.35849535e-02
 -5.81573993e-02 -7.28005171e-02  3.54723670e-02  2.18541697e-02
 -7.94192124e-03 -4.87738550e-02 -3.35335620e-02 -1.30845839e-02
  2.31378376e-02  6.46239370e-02  3.24157849e-02  4.80039120e-02
  2.15022191e-02 -7.43106427e-03  1.40167596e-02  4.42826189e-02
 -4.83206920e-02  3.22252400e-02 -2.02827901e-02 -2.66145896e-02
 -8.78073915e-04  9.49917361e-02  1.89478986e-03  1.21285189e-02
 -8.13150853e-02 -1.61639452e-02  4.97390069e-02 -3.99215668e-02
  1.49572408e-02 -4.17868122e-02 -3.36875170e-02  4.81470674e-02
 -1.58324037e-02  1.56875141e-02  2.18495633e-02 -3.51806618e-02
  6.50468934e-03  1.10523999e-02  4.29265760e-02 -1.54012060e-02
  2.59975716e-02  5.86488377e-03  4.88279499e-02 -3.00131962e-02
 -3.43508683e-02  1.91712775e-03  3.30060571e-02 -1.87581535e-02
 -2.22434364e-02  3.55370864e-02  5.04484493e-03 -1.12903388e-02
 -3.34629118e-02  3.41503532e-03 -2.14800406e-02  9.03618559e-02
  4.96117538e-03  4.01862748e-02  4.21510227e-02 -1.27715245e-02
 -7.07859248e-02  6.14282154e-02  5.28993607e-02  3.39036547e-02
 -1.47542330e-02  2.38582361e-02 -4.79311682e-02  2.27416623e-02
 -1.31440628e-02  4.13018875e-02 -2.37944024e-03 -9.28549003e-03
  5.65492213e-02  3.04030869e-02 -1.72704458e-02  3.30563337e-02
 -2.09110249e-02  8.54964834e-03  4.56526168e-02 -2.36255564e-02
  4.56717564e-03  2.30805259e-02 -8.86229973e-05 -5.03237918e-02
 -2.62526460e-02  6.96844161e-02  2.04131147e-03 -7.19069764e-02
  1.29748862e-02 -1.87662635e-02 -3.59980389e-02  1.20879095e-02
  1.93720013e-02 -3.76802720e-02 -6.38214219e-03 -1.61852855e-02
 -1.97670516e-02  3.84178758e-02 -2.03288672e-03  1.59438960e-02
 -6.85995519e-02  2.69215908e-02  9.83077846e-03 -4.05703187e-02
 -9.54030976e-02 -5.77240251e-03 -2.29973700e-02  1.75005179e-02
  1.31714977e-02  7.56175518e-02 -6.16343506e-03 -2.53701955e-02
  4.04252596e-02  5.26157767e-02  2.74033548e-04 -2.24496424e-02
  1.64278317e-02 -4.47414536e-03  1.05944224e-01  3.55184637e-03
  1.20874839e-02 -7.48517290e-02 -3.54742594e-02 -2.06305422e-02
  2.24177986e-02 -4.75749467e-03  2.50086058e-02 -9.00372770e-03
 -3.89444791e-02 -1.99082270e-02 -5.72004309e-03 -1.47870108e-02
  3.27726938e-02 -7.85182714e-02  5.92369474e-02 -3.07749026e-03
 -1.98311508e-02 -3.82619053e-02  1.21424608e-02 -4.79757152e-02
  3.14539522e-02  4.08829562e-02 -4.93436446e-03 -1.67420208e-02
 -2.79171169e-02  1.40225571e-02 -6.69869930e-02 -1.52829597e-02
  2.15427000e-02  3.21668349e-02 -7.20828995e-02 -3.60974856e-02
  1.54417185e-02 -9.24285967e-03  4.16387282e-02  1.56324320e-02
 -6.19271882e-02  7.20614791e-02 -6.73664035e-05 -6.93870187e-02
 -3.70738693e-02  1.65596958e-02 -1.27111105e-02 -6.08085357e-02
  1.13619613e-02  5.07137515e-02 -1.68668088e-02 -7.02242972e-03
  3.59158963e-02 -7.38557652e-02 -2.43584272e-02  1.00542735e-02
  6.90126792e-02  2.13153809e-02  1.65818003e-03  1.16468715e-02
 -2.64780205e-02 -4.29710858e-02 -4.30968031e-02 -2.43976004e-02
  4.50672321e-02  3.60913598e-03 -3.92286070e-02 -2.61767395e-02
 -3.34346580e-04 -1.88280586e-02  5.33170179e-02  9.26725625e-04
  2.22895946e-02 -2.38647386e-02 -7.30328336e-02  2.78318096e-02
 -2.38561295e-02  4.49721329e-02  5.74451834e-02  4.36018668e-02
  3.50409932e-02  5.02644740e-02 -2.35606786e-02  1.97257251e-02
 -5.98406866e-02 -1.83395110e-02  2.85566244e-02 -7.18553225e-03
  2.75760088e-02  5.89551497e-03  2.69819628e-02 -6.51339293e-02
  1.68035645e-02  1.02063958e-02 -3.93421836e-02 -1.39485504e-02
 -2.05422528e-02 -2.25610123e-03 -2.03367714e-02  8.85433424e-03
  1.28440354e-02  2.96388138e-02 -3.08841113e-02  3.45252044e-02
  1.64772160e-02  4.93553691e-02  9.36073717e-03  1.68202352e-02
 -2.83591785e-02 -1.99240586e-03 -4.41388935e-02 -3.36033069e-02
  4.18277830e-02  2.09378470e-02  2.46400014e-02  3.80553976e-02
  1.51006794e-02 -6.21293858e-03  4.91488092e-02 -6.55885180e-03
 -4.38439241e-03  2.48246323e-02  2.43650638e-02  1.74773801e-02
 -5.35094030e-02  2.43049897e-02 -2.37714946e-02  1.68177451e-03
 -9.22946446e-03 -2.41271555e-02 -2.21662987e-02 -4.19328846e-02
 -3.28688249e-02  4.73234430e-03 -5.20176836e-05 -8.45947361e-04
 -2.93353479e-03 -3.62657495e-02  1.84810273e-02 -8.47762544e-03
  2.92148776e-02 -2.67780479e-02  4.12020721e-02 -2.27215700e-02
 -1.39037892e-03 -5.10826148e-02  1.89602021e-02  1.36011234e-02
 -1.53560974e-02 -1.68813374e-02  1.29685672e-02 -6.44424150e-33
 -5.56907654e-02  1.46428235e-02  6.43340172e-03 -8.47905222e-03
 -3.19348574e-02 -2.95094419e-02 -2.61561032e-02 -5.31876693e-03
 -1.60289388e-02 -3.40920761e-02  1.36041071e-03  9.56176128e-03
  8.30424763e-03  1.49629898e-02  5.44115268e-02 -3.14474967e-03
  5.68521172e-02 -2.05008592e-02 -3.69692035e-03  5.56837544e-02
  2.27461923e-02  4.17907424e-02  8.92524794e-02  6.03280514e-02
 -3.97292860e-02  1.03592547e-02  1.15576852e-02 -3.78151871e-02
 -2.14343853e-02 -1.06578190e-02 -3.05756107e-02 -1.02130668e-02
 -2.99864169e-03 -1.13808893e-01 -3.27319019e-02  2.13894304e-02
 -8.92491192e-02  6.72277901e-03 -5.85639384e-03  1.90208238e-02
 -1.85510181e-02 -5.03566489e-02  3.07742879e-02  2.97235176e-02
 -3.14562954e-02 -5.44082560e-02  7.47663318e-04 -2.37322558e-04
 -5.54764308e-02  1.85154490e-02 -9.98514239e-03  1.53187532e-02
 -9.22537502e-03 -1.16992611e-02  6.38334081e-02  6.11612126e-02
 -2.10905448e-02  6.83205319e-04 -7.87463188e-02  2.44735833e-02
  5.04794829e-02  5.75811677e-02  4.16798890e-02  2.62102000e-02
  2.92652491e-02 -5.40985866e-03  3.94889191e-02 -3.91278677e-02
 -3.67674902e-02  2.92862467e-02 -1.83864906e-02  1.79198403e-02
  6.20750710e-02 -4.10905108e-02  4.19548079e-02  5.15123655e-04
 -2.70327535e-02  7.03894719e-03 -3.08407694e-02  7.42943212e-02
  5.36975712e-02  8.85443576e-03 -1.50463572e-02 -2.99831070e-02
  6.29039202e-03  3.22036049e-03 -1.40485941e-02 -1.41906617e-02
  1.98603142e-02  1.38026420e-02 -9.00824089e-03  4.66381945e-02
  5.55599444e-02 -2.71613300e-02  8.43525976e-02  5.11537232e-02
  7.79156573e-03  5.17918095e-02  1.40027236e-02  1.23165846e-02
 -1.04846871e-02  1.84122007e-02  4.38804515e-02  3.42093641e-03
 -1.08692376e-02 -4.15917675e-05 -8.49199016e-03  6.57263920e-02
 -4.14514355e-02 -3.06959450e-02 -4.79146279e-02 -2.93674786e-03
  2.13307794e-03  2.35339198e-02  5.33611700e-03 -2.14598924e-02
 -1.40629597e-02  2.29828265e-02 -5.44402078e-02 -1.63288265e-02
 -1.86239451e-03  9.44877882e-03  9.59460065e-03  4.74973172e-02
 -2.21728031e-02  1.27455853e-02 -8.16525444e-02  3.04877516e-02
  5.21020405e-02 -5.00587597e-02 -5.16974889e-02  6.28763586e-02
  3.04787051e-07  2.25319583e-02  5.99185284e-03  6.67532906e-02
  2.32214183e-02  3.08185052e-02 -9.32684261e-03  1.25118010e-02
  8.73891562e-02  2.61301640e-02 -2.91889329e-02  9.56557412e-03
  7.74933398e-03 -1.85509827e-02 -3.31881605e-02 -3.42034362e-02
 -7.91420564e-02 -4.27912772e-02  4.66735475e-02 -2.78662861e-04
  7.51759810e-03  1.99337825e-02  7.97356218e-02 -4.68142517e-02
  2.96715572e-02 -1.87422195e-03  5.16414307e-02  3.30648720e-02
  4.53205667e-02  4.14917953e-02 -1.61413848e-02  6.15371158e-03
 -2.30914354e-02 -6.19506501e-02  7.86123704e-03 -2.76052263e-02
  1.51813151e-02  1.14138527e-02  7.20754564e-02 -1.22690611e-02
 -5.65082282e-02  4.61875759e-02  1.86672583e-02 -1.79196410e-02
 -2.53401864e-02  2.21011862e-02 -7.20775574e-02 -4.87611927e-02
  1.24277808e-02 -3.64243835e-02  3.01212370e-02 -4.24268357e-02
  1.48728238e-02  5.29579744e-02 -2.55383961e-02  1.58059746e-02
 -7.48361787e-03  3.50358896e-02 -7.26529583e-02  5.85415261e-03
  1.68127310e-03 -5.19301668e-02  7.56954600e-04 -5.78240938e-02
 -5.28827943e-02  3.49427462e-02  6.00071065e-03 -7.07880333e-02
  2.77706477e-34  1.75655503e-02 -2.82716937e-02  5.91249764e-03
  2.29974166e-02 -1.70185755e-03 -6.34351298e-02 -4.13805991e-02
  4.17654291e-02 -4.10607463e-04 -9.28461924e-02 -7.31874779e-02]"
"We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot-product attention by masking out (setting to −∞) all values in the input
of the softmax which correspond to illegal connections. See Figure 2.
3.3
Position-wise Feed-Forward Networks
 In addition to attention sub-layers, each of the layers in our encoder and decoder contains a fully
connected feed-forward network, which is applied to each position separately and identically. This
consists of two linear transformations with a ReLU activation in between.
FFN(x) = max(0, xW1 + b1)W2 + b2
(2)
 While the linear transformations are the same across different positions, they use different parameters
from layer to layer. Another way of describing this is as two convolutions with kernel size 1.
 The dimensionality of input and output is dmodel = 512, and the inner-layer has dimensionality
dff = 2048.
 3.4
Embeddings and Softmax
Similarly to other sequence transduction models, we use learned embeddings to convert the input
tokens and output tokens to vectors of dimension dmodel. We also use the usual learned linear transfor-
mation and softmax function to convert the decoder output to predicted next-token probabilities. In
our model, we share the same weight matrix between the two embedding layers and the pre-softmax
linear transformation, similar to [30]. In the embedding layers, we multiply those weights by √dmodel.
 5
","[-1.53198652e-02  1.20475246e-02  6.33018091e-03  3.67250815e-02
 -9.44940746e-03  4.89784684e-03 -4.73698555e-03 -3.18286791e-02
 -9.40257534e-02  4.21073148e-03 -2.07791496e-02 -3.03757545e-02
  2.46819034e-02  8.50684941e-02  5.66198528e-02 -3.28884716e-03
  1.40420590e-02 -1.92183200e-02 -1.64870154e-02  9.76564083e-03
  3.44965002e-03 -1.14273410e-02 -9.78416670e-03  5.35532087e-02
 -3.91085260e-02  1.82374716e-02 -1.04789771e-02 -4.15991526e-05
  1.08864969e-02 -3.39867137e-02 -1.89466495e-02  2.62679476e-02
  3.95977497e-02  9.69383400e-03  2.13768112e-06 -1.31300604e-02
 -2.21504308e-02 -3.88181992e-02 -3.42422887e-03 -3.14705516e-03
 -8.39301646e-02 -5.39739616e-02 -4.26113829e-02 -5.12293354e-03
 -1.13279819e-02 -5.98335192e-02  6.46148771e-02  1.76970791e-02
  8.45622793e-02  7.39486143e-02  2.28027510e-03 -5.60002178e-02
  6.05978705e-02 -2.83889193e-02  1.60258375e-02 -4.73657660e-02
  2.72046495e-02 -4.96869236e-02 -6.62024915e-02 -2.75214445e-02
 -7.45334923e-02  5.19203283e-02  3.58464532e-02 -2.80298833e-02
  5.66491969e-02  1.83576252e-02 -3.16105084e-03 -6.49646893e-02
 -3.53123732e-02  8.09572190e-02 -5.78576960e-02 -3.39022577e-02
 -1.19907400e-02  1.66393362e-03 -2.78314371e-02 -5.33488393e-02
 -2.07253676e-02 -2.53200624e-03  2.24181358e-02  5.50694205e-02
  8.55686143e-03  5.03174365e-02  6.79829158e-03 -3.19428556e-02
 -1.58687830e-02  7.77305476e-03 -4.87148343e-03 -7.05394009e-03
 -5.38932867e-02  1.69351213e-02  5.07740043e-02 -2.04798160e-03
  6.43785819e-02  2.64417063e-02  3.05820219e-02 -6.40770933e-03
 -4.87055592e-02 -3.72692645e-02 -3.85593735e-02 -4.77226302e-02
  6.81236312e-02  3.40351835e-02 -3.35116349e-02  1.33116664e-02
 -6.91485703e-02  7.27298483e-02 -5.33615276e-02  4.01249668e-03
 -1.46780731e-02  1.92911401e-02  2.54277848e-02 -1.99901406e-02
 -4.75515127e-02  4.05674987e-02 -1.98272206e-02 -2.30814461e-02
 -3.58309858e-02  1.25488034e-03 -3.69200483e-02 -1.75492885e-03
 -1.06405253e-02  3.32395956e-02 -8.74652937e-02 -3.22844721e-02
  8.42095539e-03  5.23745455e-02 -1.56709412e-03 -2.23251823e-02
  6.39412319e-04 -2.54845303e-02 -4.33667153e-02  4.21973038e-03
  3.07178218e-02  1.51744364e-02 -2.99043674e-02  4.20627110e-02
 -7.20768375e-03  1.91748999e-02 -3.96639369e-02 -3.51162814e-02
 -2.01657489e-02 -8.32762755e-03  5.65717369e-02 -3.70212607e-02
  3.51603292e-02  1.08731426e-02 -2.15273052e-02 -4.36399616e-02
  1.80699006e-02 -2.40921546e-02  2.43539568e-02  6.81651831e-02
  9.63454321e-03 -4.21494767e-02  2.52850540e-02 -6.51135063e-03
  1.91021170e-02  6.57086670e-02  1.57080200e-02  3.22162025e-02
 -1.86972469e-02  3.91392875e-03  2.00373475e-02  3.24003585e-02
  4.97710407e-02 -1.44850621e-02 -7.01950714e-02 -2.68364679e-02
  1.89431105e-02  2.74037477e-02  7.58350044e-02  2.78719105e-02
 -2.00480614e-02 -2.94222832e-02  1.43007059e-02  5.12181446e-02
  6.19014092e-02  4.92527783e-02  6.83356300e-02 -1.41941672e-02
 -2.02728566e-02  3.58443111e-02  8.68622959e-03  7.37397671e-02
  4.19226475e-03  1.27248839e-02  4.85178977e-02  4.17473912e-02
 -1.51999323e-02 -2.61646379e-02  5.95102161e-02 -2.69687418e-02
  1.41882217e-02 -8.57932493e-02  4.90995161e-02  1.30607132e-02
 -8.01053345e-02  3.63637246e-02 -4.21782443e-03 -4.57210583e-04
  1.46689955e-02 -3.37699279e-02 -8.74256250e-03 -9.51826922e-04
  2.94252913e-02  5.64310001e-04 -3.38630937e-02 -9.10877995e-03
 -4.84828353e-02  2.09954958e-02  6.60094013e-03  1.49971601e-02
 -2.20068619e-02 -5.43981753e-02 -2.35412922e-02  4.69340235e-02
  5.69717214e-03  5.12283556e-02 -7.32995942e-02  4.48407531e-02
  4.05882560e-02  3.62846404e-02  3.02979518e-02 -4.39576758e-03
  1.17597694e-03 -3.03807762e-02 -2.24954286e-03  4.44411896e-02
  5.14477640e-02  3.81244421e-02  3.17720920e-02  5.73734455e-02
  4.71443012e-02 -4.48800214e-02 -5.49961021e-03  1.45200584e-02
 -1.12827703e-01 -7.24662095e-02  4.49003316e-02 -3.85975763e-02
  1.89414546e-02  5.61282933e-02  3.02786957e-02 -6.39429167e-02
  6.01807609e-02 -2.58350540e-02  4.25987244e-02 -3.75675298e-02
  1.43340454e-02  4.36006226e-02  8.95115174e-03  1.30225373e-02
  5.09904604e-03 -1.68942157e-02  2.14980412e-02 -1.27211716e-02
 -1.09511791e-02  1.39579521e-02 -3.98263521e-02  2.46335361e-02
  8.02176353e-03 -4.87514324e-02 -8.68515112e-03 -3.65532748e-02
 -4.60615382e-02 -2.16968805e-02 -6.55278709e-05  5.31640537e-02
 -4.52878661e-02 -6.92146225e-03  1.82732362e-02  3.90181923e-03
 -4.94979182e-03  2.01086886e-02 -2.25360785e-02 -2.40136143e-02
  6.15010224e-02  2.84181777e-02 -3.90552767e-02  2.00566333e-02
 -1.37926696e-03 -3.14322487e-02 -1.41579937e-02 -5.09004332e-02
 -9.09140427e-03  5.11898659e-02 -3.32246870e-02 -7.51347542e-02
 -5.54691069e-02 -7.61765912e-02  2.26985067e-02  3.02615594e-02
 -3.62862041e-03 -7.09379539e-02 -1.32554080e-02 -1.48710199e-02
 -2.09540408e-02  4.18550447e-02 -1.97831006e-03  2.19352581e-02
 -1.45651847e-02 -2.10025460e-02 -1.61756873e-02  4.94015170e-03
 -3.39682959e-02  2.51902901e-02 -2.86185499e-02  9.37827490e-03
 -2.49722581e-02  8.44402388e-02  1.30911954e-02  1.03382599e-02
 -5.92496544e-02  4.99091716e-03  9.47400089e-03 -4.30934429e-02
  3.03541031e-02 -8.83240625e-02 -5.04026264e-02  1.37502756e-02
 -1.69567466e-02 -3.64450701e-02  6.36173114e-02 -5.65021001e-02
 -1.28267612e-02 -4.79370283e-05  1.99677162e-02 -2.38635894e-02
  3.43914032e-02  2.02202965e-02  1.87132470e-02  1.11549413e-02
 -5.59332296e-02  9.54058301e-03  3.93212996e-02  1.38760470e-02
 -2.30662506e-02  1.32595124e-02  8.77456646e-03 -7.83259794e-03
 -2.57268548e-02  6.14614831e-03 -2.58423388e-02 -1.30880484e-03
 -1.46955587e-02  1.41386092e-02  1.59799624e-02 -1.03401328e-02
 -3.67184579e-02  4.19836380e-02 -8.83347262e-03  3.72586586e-02
 -3.72415073e-02  4.16769609e-02 -4.60281558e-02  4.65764105e-02
  3.76638435e-02  3.55820317e-04 -1.59939434e-02  6.68621901e-03
  1.72254629e-02 -5.01900166e-03 -1.19338743e-02  4.38091867e-02
 -2.86116730e-02  3.27848308e-02  1.89093240e-02  7.63490889e-03
  3.90440691e-03  2.60053314e-02  4.71648239e-02 -5.11650629e-02
 -2.56282855e-02  8.69177133e-02 -6.79213647e-03 -8.16297680e-02
  8.05769674e-03  7.41894590e-03 -7.34726433e-04 -1.00405049e-02
 -1.89736839e-02 -4.30536792e-02 -3.63721028e-02 -4.49346052e-03
  6.69654412e-03  4.03260924e-02 -2.89389514e-03  1.05963470e-02
 -8.64161402e-02  2.82005612e-02  5.82035296e-02 -3.14067639e-02
 -1.07727975e-01 -3.60408761e-02 -3.70727107e-02  1.35924276e-02
  4.05853242e-03  4.40770686e-02  1.22439144e-02 -1.03682012e-03
  4.29563262e-02 -1.45669347e-02  7.89985585e-04 -2.26423666e-02
 -4.44588102e-02  6.38816133e-02  9.35635045e-02  1.58819351e-02
  1.49025889e-02 -3.68023589e-02  1.22401789e-02 -3.31261903e-02
  1.70554966e-02  1.40001962e-03  2.10973192e-02 -1.65091679e-02
 -1.01491837e-02 -5.66202623e-04  5.03198728e-02 -2.89334394e-02
  4.22502942e-02 -5.45968004e-02  1.14164934e-01  6.48352364e-03
 -2.60955654e-02 -3.57549302e-02  2.07514670e-02 -1.72735639e-02
  4.21448201e-02  4.28032540e-02 -2.03714985e-03 -8.60373024e-03
 -3.66267674e-02  4.83462550e-02 -5.48770800e-02 -4.47391383e-02
 -3.34304646e-02  1.98157299e-02 -7.86679760e-02 -7.01864362e-02
 -2.37304568e-02  9.99931712e-03  6.12168573e-02 -1.09090349e-02
 -2.04455364e-03  9.97110456e-03 -1.70486160e-02 -2.14795265e-02
  1.52089098e-03  3.98591608e-02  1.07261157e-02 -3.49795334e-02
  3.20319682e-02  8.66873041e-02 -2.26669610e-02 -1.98649298e-02
  2.69319173e-02 -4.70611341e-02 -4.19547856e-02 -3.72072589e-03
  4.30053212e-02  1.40215475e-02  5.38628437e-02 -2.82938052e-02
 -1.31563516e-02  7.26139247e-02  4.42893011e-03 -2.72688027e-02
 -3.15472111e-03  4.81331535e-02 -4.24642563e-02 -1.35736428e-02
  3.53040881e-02 -4.00272161e-02 -1.67914815e-02 -1.80068891e-03
  2.71238107e-02 -8.73810984e-03 -5.60762286e-02  3.90474312e-02
 -2.98831109e-02  6.09909110e-02  1.76311266e-02  4.12049470e-03
 -1.42771518e-02  3.94262783e-02 -2.03858893e-02  2.42704321e-02
 -7.32685402e-02  3.82442623e-02  5.18825278e-02 -2.04810314e-02
  1.35462703e-02 -5.79726547e-02  2.86649521e-02 -3.63912643e-03
  1.45638213e-02  6.28171116e-02  1.85875110e-02  2.30039889e-03
 -2.72099711e-02 -2.08897442e-02 -1.14762476e-02  3.02942097e-03
  1.95479486e-02  1.96085405e-02 -4.62466143e-02 -2.57556024e-03
  2.08345912e-02  4.65041362e-02 -1.82474535e-02  5.67506300e-03
 -1.50375655e-02  3.43006141e-02 -3.78745534e-02 -5.12936944e-03
  4.77986336e-02 -2.52999808e-03  4.19130772e-02  2.05713101e-02
  5.62391616e-03  3.23831732e-03  4.56210561e-02 -4.57097031e-02
 -3.13788326e-03  4.91103269e-02  5.47307217e-03  3.54887429e-03
 -3.56235355e-02  4.89192307e-02  2.46724896e-02  9.53396969e-03
  6.05632413e-05 -1.78455492e-03 -1.05225379e-02  9.05071944e-03
  8.47250223e-03  1.51913622e-02 -3.52126323e-02  1.52702695e-02
  4.32260381e-03 -7.01311082e-02  1.65269412e-02  4.48990846e-03
  1.49047729e-02  1.09298425e-02  3.13125663e-02 -3.05842049e-03
 -6.08651945e-03 -1.35583030e-02  1.69390738e-02  1.97862592e-02
  3.40434611e-02 -2.26671845e-02 -1.98948644e-02 -6.68484315e-33
 -2.79711653e-02  1.08828992e-02 -7.42685096e-03 -1.90122202e-02
 -5.59578575e-02  1.52342673e-02 -8.21970403e-03  4.33879532e-03
 -1.37842391e-02  3.56168137e-03 -1.56978201e-02 -9.24043264e-03
  2.41518486e-02  1.99776813e-02  3.28155747e-03 -3.37721664e-03
  4.22692448e-02 -3.33723985e-02  1.00042289e-02  5.14313914e-02
 -7.63799937e-04  3.83170135e-02  6.62434474e-02  1.33879622e-03
 -1.46663208e-02  1.35840317e-02 -9.71393753e-03  1.08365435e-02
  2.54565142e-02  2.27829069e-02 -1.94289479e-02 -1.42995436e-02
  1.72066912e-02 -7.51628205e-02 -4.91387658e-02  1.74053758e-02
 -1.03550695e-01 -1.73381474e-02 -3.43544744e-02  1.57342441e-02
 -2.05067415e-02 -3.41470577e-02  9.15157422e-02 -4.72594006e-03
 -3.03671136e-02 -2.14005504e-02  2.32178885e-02 -9.06044710e-03
 -2.32214723e-02 -2.55369991e-02 -4.67993170e-02  2.90219318e-02
 -9.20482725e-03 -3.82501408e-02  4.41827774e-02  1.64145548e-02
  3.49926064e-03 -3.43074687e-02 -8.18756148e-02  3.53022404e-02
  4.25310433e-03  6.73178360e-02  5.13516068e-02  1.69651937e-02
  9.55901481e-03  1.39857465e-02  3.39126587e-02 -3.84859219e-02
 -5.27820364e-02 -1.31855253e-02 -5.59524493e-03 -1.08171105e-02
  6.00532107e-02 -4.41457257e-02  6.29756004e-02 -2.94784475e-02
 -3.85398827e-02  1.93062667e-02 -2.16075666e-02  5.23077734e-02
  3.31028402e-02  4.14362513e-02  2.71437690e-03 -1.98345399e-03
 -2.28652768e-02 -9.78675671e-03  1.57605857e-02 -2.48811059e-02
 -2.16498342e-03  2.70354934e-02 -1.89624634e-02  2.24041250e-02
  6.16164468e-02 -2.14252584e-02  1.26382848e-02  2.69790906e-02
  2.86240857e-02  2.84459163e-02 -9.96854529e-03  2.66336054e-02
 -2.53161993e-02  1.58431213e-02  2.40411274e-02  3.08749313e-03
  6.58407202e-03  1.13722002e-02  2.76843589e-02  4.24192473e-02
 -4.23153117e-02 -4.49550152e-02 -4.72776145e-02 -2.53381021e-02
  1.56477168e-02  2.80421190e-02  5.72653562e-02 -3.10483780e-02
 -6.15204731e-03  3.05055603e-02 -8.17169156e-03  2.81289406e-02
  1.76073611e-02  1.52364140e-02  1.30472248e-02  6.19158670e-02
 -6.15319386e-02 -9.74415615e-03 -7.01543093e-02  5.53062260e-02
  5.02561256e-02 -8.02881718e-02 -2.73048263e-02  4.34761010e-02
  2.95713988e-07  1.39462827e-02 -1.45869292e-02  7.68405423e-02
 -1.36700121e-03  1.82508472e-02  2.00458486e-02 -1.80393253e-02
  5.68281002e-02  2.65550353e-02 -2.13095825e-02  3.14875208e-02
 -9.78608709e-03  1.40894214e-02 -8.03174567e-04 -5.67340218e-02
 -1.22889197e-02 -4.12029326e-02  2.06712782e-02 -2.42153723e-02
 -9.79117211e-03 -2.64403387e-03  9.57654789e-02 -3.27374078e-02
  3.14719183e-03  6.02835044e-02 -1.94272492e-02 -1.76379317e-03
  5.70949316e-02  1.83546077e-02 -3.11273374e-02  2.51982361e-02
 -3.99708189e-02 -2.59359963e-02 -2.73919664e-02 -5.12865037e-02
  2.79591661e-02  1.01795951e-02 -2.60982662e-03 -4.62118313e-02
 -1.00446455e-01  3.54073718e-02  2.17297915e-02 -1.06422538e-02
 -2.05023102e-02  3.65230665e-02 -4.50810529e-02 -2.15062369e-02
  4.82339039e-02 -4.93698530e-02  3.81007828e-02 -2.65394673e-02
 -2.00408194e-02 -2.01486647e-02 -2.39076954e-03  4.78362218e-02
  9.08419397e-03  1.23266568e-02 -5.13010025e-02 -7.42242299e-03
 -1.15255155e-02 -4.41384949e-02 -7.14368094e-03 -4.78367768e-02
  1.02196606e-02  4.42607813e-02  3.91075038e-04 -3.54379229e-02
  2.83004168e-34  3.99344973e-02 -5.55541329e-02  3.62252966e-02
  1.38470717e-02  9.27877054e-03 -3.73387933e-02 -4.21873964e-02
  6.00493699e-02  1.58444960e-02 -5.01926206e-02 -9.14628059e-02]"
"Table 1: Maximum path lengths, per-layer complexity and minimum number of sequential operations
for different layer types. n is the sequence length, d is the representation dimension, k is the kernel
size of convolutions and r the size of the neighborhood in restricted self-attention.
 Layer Type
Complexity per Layer
Sequential
Maximum Path Length
Operations
Self-Attention
O(n2 · d)
O(1)
O(1)
 Recurrent
O(n · d2)
O(n)
O(n)
 Convolutional
O(k · n · d2)
O(1)
O(logk(n))
Self-Attention (restricted)
O(r · n · d)
O(1)
O(n/r)
3.5
Positional Encoding
Since our model contains no recurrence and no convolution, in order for the model to make use of the
order of the sequence, we must inject some information about the relative or absolute position of the
tokens in the sequence. To this end, we add ""positional encodings"" to the input embeddings at the
bottoms of the encoder and decoder stacks. The positional encodings have the same dimension dmodel
as the embeddings, so that the two can be summed. There are many choices of positional encodings,
learned and fixed [9].
 In this work, we use sine and cosine functions of different frequencies:
PE(pos,2i) = sin(pos/100002i/dmodel)
PE(pos,2i+1) = cos(pos/100002i/dmodel)
where pos is the position and i is the dimension. That is, each dimension of the positional encoding
corresponds to a sinusoid. The wavelengths form a geometric progression from 2π to 10000 · 2π. We
chose this function because we hypothesized it would allow the model to easily learn to attend by
relative positions, since for any fixed offset k, PEpos+k can be represented as a linear function of
PEpos.
","[-1.14528686e-02  1.47428596e-02  1.67495382e-04  5.44653237e-02
 -4.64596450e-02 -3.66411544e-02  3.82253714e-02 -2.02893894e-02
 -5.87904789e-02  2.11399980e-03 -9.25169792e-03  6.73013041e-04
  1.35345338e-02  2.06472706e-02 -3.06850066e-04 -5.68497404e-02
 -1.09213125e-03 -1.70558337e-02 -5.72852232e-02 -4.94139269e-04
 -5.80402762e-02 -4.25594300e-02 -1.33560051e-03  3.82412672e-02
  8.02990980e-03 -5.81616722e-03 -7.44532198e-02 -3.18917781e-02
  3.65734063e-02 -3.93372253e-02 -7.08898390e-03  4.52989675e-02
  5.67421801e-02  5.68653345e-02  1.90928995e-06 -6.39498886e-03
 -5.46164170e-04 -1.85956769e-02  1.17312614e-02  2.57642698e-02
 -1.88894589e-02 -4.14925329e-02 -4.62948605e-02 -2.51573678e-02
  2.37558242e-02  1.97182409e-02  3.85329910e-02  6.10314915e-03
  3.36235501e-02  7.62194321e-02  5.67604601e-03 -6.31684735e-02
  7.21295597e-03 -5.71431741e-02  9.49109439e-03  4.10120450e-02
  2.67707277e-03 -3.92824411e-02  8.66075698e-03  2.02408470e-02
 -4.61004525e-02  8.10110047e-02  5.02529293e-02  3.30129378e-02
  5.57245649e-02 -3.04931635e-03  3.34997661e-02 -2.24821903e-02
  7.36270100e-03  1.26488376e-02 -9.83208567e-02 -2.22913437e-02
 -2.69739944e-02  3.03637832e-02 -1.70980096e-02 -4.74803224e-02
 -2.04793978e-02  5.18500153e-03  2.87367124e-02 -1.96075775e-02
 -2.65184715e-02  5.49155883e-02  1.29388727e-03 -4.18693013e-02
 -7.06293504e-04  1.28775062e-02  6.27230294e-03 -2.27319486e-02
 -3.15842330e-02 -5.83164692e-02  3.80430967e-02 -1.17314346e-02
  1.39336651e-02  3.83945629e-02  6.94709495e-02 -5.51319262e-03
 -2.64680553e-02 -2.65447795e-03  3.54508101e-03 -7.51818568e-02
  8.52330625e-02  1.87037960e-02  4.73282486e-03  2.89260093e-02
 -2.70225741e-02  4.47164252e-02 -5.37372641e-02  5.56302117e-03
 -7.64895463e-03  5.88626452e-02  4.19507027e-02  2.47053318e-02
 -5.78659959e-02  3.03904153e-02 -8.83387215e-03 -3.30054536e-02
 -4.03251946e-02  4.66354641e-06 -4.30107443e-03  1.04164630e-02
 -1.71025395e-02  5.98033285e-03 -4.13463674e-02 -2.93553341e-02
  2.83715036e-02  1.07662054e-02 -2.51879245e-02 -3.04491352e-02
  5.58590051e-03  5.88890351e-03 -1.57681964e-02  2.04964187e-02
  2.29350012e-02  1.31286765e-02 -2.71308962e-02  4.56102490e-02
  3.01071592e-02 -5.14893271e-02 -2.57046353e-02  1.15315095e-02
 -3.02992240e-02 -3.09876204e-02  3.08279376e-02 -4.25772034e-02
 -1.14703048e-02 -1.58392824e-02 -2.65955236e-02 -1.93028450e-02
  3.57488282e-02  1.34159047e-02  2.84423865e-02  2.35394537e-02
  1.05079710e-02 -1.74811874e-02  5.52032776e-02  4.51959856e-02
 -2.85517122e-03  4.40465622e-02  3.30681242e-02  6.85506836e-02
 -2.25116182e-02 -6.97267577e-02 -2.13350708e-04  4.34774003e-04
  1.80970337e-02  1.52299379e-03 -5.05884588e-02 -4.62832637e-02
 -3.13988253e-02  3.23945954e-02  4.56080772e-02  4.88494150e-02
 -2.30510980e-02 -8.15202072e-02 -8.11720081e-03  5.74239306e-02
  5.54914810e-02  3.42499986e-02  5.56690432e-02  1.48022538e-02
  3.05343829e-02  3.10577583e-02 -5.58351749e-04  9.63805765e-02
  3.19174305e-02 -8.37218389e-03  9.44945496e-03  6.66340580e-03
 -3.77551205e-02 -3.46026644e-02  5.72681939e-03 -2.61906479e-02
  2.22336268e-03 -3.68955433e-02  3.10853831e-02 -9.83617548e-03
 -4.24317271e-02  6.01313543e-03 -3.27855423e-02 -1.55958263e-02
 -3.94401997e-02  2.56183520e-02 -7.51440413e-03  4.33416851e-02
  4.88093169e-03 -2.24484056e-02 -1.10826339e-03 -1.40567338e-02
 -1.73282921e-02  1.40359942e-02 -1.30485976e-02  2.89391186e-02
  2.04718485e-02 -3.54962684e-02 -3.67796272e-02 -5.11050643e-03
 -2.39424165e-02  5.68451770e-02 -1.34496689e-02 -1.05626835e-02
  1.61350276e-02  4.58863601e-02 -3.30932513e-02 -7.87893310e-03
  6.57267310e-03 -6.15584329e-02 -4.62355092e-02  3.39301415e-02
  3.88917699e-02  1.83489826e-02  2.77127326e-02  2.96623353e-02
  5.56144752e-02 -4.55706120e-02  8.97800922e-03 -3.14004272e-02
 -6.88934773e-02 -1.93907041e-02  1.69537999e-02 -1.66174006e-02
  7.91668799e-03  4.38283049e-02 -2.51398217e-02 -3.10480837e-02
  8.86796042e-02 -3.35741192e-02 -1.67961046e-02  1.50187397e-02
  1.44921709e-02  1.08667091e-02  1.42727001e-02  2.42347252e-02
  1.78162958e-02 -3.32476310e-02  6.05461821e-02 -4.74384148e-03
  6.93838531e-03  6.78663235e-03 -8.17850456e-02 -1.32093783e-02
 -1.59277115e-02 -3.46268080e-02  1.53268343e-02  1.61086079e-02
 -4.00556736e-02 -5.89235686e-04 -2.88000889e-02 -7.73166120e-03
 -3.52381766e-02 -2.12534890e-02 -1.19048217e-02 -2.71472391e-02
 -1.45279365e-02  3.22341099e-02 -2.53471415e-02 -2.27868259e-02
  2.77404115e-02 -2.31408924e-02  2.35117623e-03  1.87864266e-02
 -3.31079983e-03 -8.86252970e-02 -4.70182784e-02 -5.19703329e-02
  3.95438373e-02  6.61815554e-02 -2.19396092e-02 -5.89884557e-02
 -2.80788708e-02 -5.34255020e-02  1.20943543e-02  4.51493189e-02
 -1.91454533e-02 -5.80051690e-02 -1.74692236e-02  1.11334119e-02
 -4.88320692e-03  1.12682819e-01  4.96680960e-02  4.08243686e-02
  7.47351861e-03  1.51568204e-02  3.47271450e-02  2.72545386e-02
 -3.00820656e-02  1.12369992e-02 -3.53021198e-03  1.74879897e-02
  1.68271046e-02  9.17110071e-02 -1.05735759e-04  9.23794135e-03
 -5.30468188e-02 -2.84456164e-02  1.90698933e-02 -2.90612485e-02
  3.39955953e-03 -2.49474831e-02  3.62813799e-03  1.31500410e-02
 -1.32534867e-02 -4.39062454e-02 -4.64938954e-03  1.35507053e-02
  3.13716661e-03 -8.44905432e-03 -2.65443865e-02 -2.11503468e-02
  5.33999391e-02  4.10239659e-02  5.88071309e-02 -6.92944694e-03
 -2.10634284e-02 -1.62012447e-02 -2.78872973e-03  6.75466936e-03
 -2.36866586e-02  1.54359937e-02 -9.70601477e-03 -8.03750288e-03
 -4.12790626e-02 -1.04419710e-02 -5.67354187e-02  3.71901840e-02
  9.13030561e-03  1.39640458e-02 -2.93417126e-02 -1.47098349e-02
 -1.45492973e-02  2.12195534e-02  2.01036911e-02  3.57602015e-02
  2.84778848e-02  2.39152890e-02 -2.25891937e-02  7.82070868e-03
 -1.81081437e-03  3.76901440e-02 -2.67503932e-02  3.85523103e-02
  8.37055445e-02  8.77555832e-03 -4.47241729e-03  2.50551756e-02
 -7.42504075e-02  3.00784260e-02  1.03034340e-02 -2.64554136e-02
 -2.91112214e-02  3.11766323e-02  5.37146963e-02 -7.61390552e-02
  5.11729205e-03  6.43094480e-02  2.02719099e-03 -4.26517203e-02
  2.94346903e-02  2.80000046e-02 -2.44109780e-02  9.97350458e-03
 -1.01245064e-02 -3.43097188e-02  2.40115318e-02 -1.68306325e-02
 -2.53588054e-02  3.62376757e-02  3.15448307e-02 -3.62080010e-03
 -5.09578064e-02  2.67735012e-02  6.39702454e-02 -2.47800653e-03
 -8.66519138e-02  9.63710714e-03 -3.95052545e-02  2.62505710e-02
 -1.82050765e-02  2.78685726e-02 -2.32717115e-03 -2.66111568e-02
  4.83800620e-02 -1.35189379e-02  1.39582613e-02 -1.71129014e-02
 -1.57243535e-02 -3.16530578e-02  1.89794004e-02 -7.99856614e-03
  3.45623791e-02 -1.05770320e-01  7.16176536e-03  1.42082488e-02
  4.44676839e-02  4.17707674e-02  2.90749837e-02  1.69255193e-02
 -2.76628602e-03  1.05757415e-02  3.74922045e-02 -6.15809411e-02
  3.20861749e-02 -1.10994373e-02  7.32669383e-02  2.50273407e-03
  2.11850945e-02 -3.01455893e-02  3.15355659e-02 -4.18202505e-02
  1.86616145e-02  5.24514392e-02 -4.98296740e-03 -3.68171111e-02
 -5.60804531e-02  5.32311164e-02 -9.42589268e-02 -4.41197418e-02
  4.25363891e-04  6.63154423e-02 -6.28853813e-02 -4.28257473e-02
 -1.41826011e-02 -3.26198451e-02  7.98075199e-02  7.50348717e-03
 -2.07991451e-02  4.56661656e-02 -1.58921871e-02 -6.21396676e-02
 -2.35665515e-02  1.67047512e-02  9.46449302e-03 -7.88691640e-02
 -7.27802608e-03  1.44444527e-02 -3.92861111e-04  1.00791370e-02
 -6.84823468e-02 -9.53453854e-02 -3.07919737e-02  3.81867997e-02
  7.23671764e-02  1.38055785e-02  3.18453833e-02 -4.01462428e-03
  2.03762371e-02  4.84852456e-02 -4.60959151e-02 -1.13130556e-02
  3.86228412e-02  7.74134248e-02 -3.81255187e-02 -3.07995863e-02
  2.26476062e-02 -5.71904192e-03  3.94447185e-02 -2.43892180e-04
  3.43098445e-03 -1.66000780e-02 -8.11089110e-03  3.88450287e-02
 -7.44728446e-02  4.58278693e-02  4.34516631e-02  2.55633816e-02
  1.83809120e-02  4.38546054e-02 -1.78029239e-02  3.24626304e-02
 -5.55214100e-02 -6.76776748e-03  2.80560739e-02  7.76092568e-03
  5.75865097e-02 -4.49692570e-02  5.80214225e-02 -7.06878901e-02
  3.37029956e-02  9.37499255e-02 -2.57462822e-02  1.62819717e-02
 -5.45183793e-02  1.76231861e-02 -3.38399448e-02  2.95730587e-02
 -1.85647197e-02  1.48844784e-02  9.47997719e-03 -1.00358482e-02
  1.51260942e-02  6.33056164e-02 -2.36170664e-02  3.45209725e-02
 -3.50442529e-02 -1.65051222e-02 -5.66924503e-03 -1.12046171e-02
  8.76009911e-02 -1.55471265e-02 -6.90455548e-03  1.35974968e-02
 -6.62621623e-03 -2.43608542e-02  1.91452354e-02 -1.45069174e-02
  2.44094944e-03  2.26418744e-03  4.19004373e-02 -1.06076552e-02
 -3.33702452e-02  5.63257895e-02  2.96805743e-02  1.92373560e-03
  2.28227321e-02  1.04734125e-02 -3.08597907e-02  1.43634016e-02
 -3.85156348e-02  2.36451160e-02 -1.75019577e-02  1.65150873e-02
 -1.77683737e-02 -7.79020786e-02  8.79086275e-03 -1.86607894e-02
  2.61286404e-02 -3.23463678e-02  5.13131917e-02 -8.91230255e-03
  8.71839933e-03  3.19722556e-02  2.93968637e-02 -1.16834119e-02
 -2.47960091e-02 -4.27781455e-02 -8.59103538e-03 -5.60222718e-33
 -3.32372785e-02 -1.29296146e-02  1.07012260e-04 -7.76506378e-04
 -2.70896014e-02  4.32948507e-02 -6.47707842e-04  2.57188827e-03
  1.22522423e-02 -2.88146976e-02  1.57961417e-02 -8.37093405e-03
 -1.83815765e-03  4.27777432e-02  4.56240401e-02  1.45538710e-02
  4.60315272e-02 -1.57762673e-02 -2.24851947e-02 -6.05296670e-03
  3.12471464e-02  2.19542664e-02  1.29004410e-02 -1.82189941e-02
 -3.53961363e-02  5.06145805e-02  2.87368055e-02 -3.60746607e-02
 -1.63519371e-03  2.70749386e-02 -3.14320587e-02  6.94885384e-03
  1.67965586e-03 -6.50881901e-02 -1.16068702e-02 -3.40502127e-03
 -7.37258643e-02 -6.99167252e-02 -6.58653080e-02  3.08696218e-02
 -7.97588006e-02 -3.71041298e-02  4.52553518e-02 -2.43606493e-02
 -5.39844967e-02 -4.44750972e-02 -2.98616998e-02 -2.44096071e-02
 -3.82098518e-02 -7.78687419e-03 -2.88701691e-02  2.68094297e-02
 -4.95643914e-03 -4.51282151e-02  7.78251514e-02 -3.54317622e-03
 -2.83445567e-02  4.55179345e-03 -7.71318525e-02 -7.40213785e-03
  5.95316524e-03  1.21057734e-01  1.11861117e-02  1.80720333e-02
  3.66702452e-02  8.55634362e-03  8.69523212e-02 -2.59738509e-02
 -1.94904804e-02  2.58891769e-02 -3.00193019e-02  2.14537289e-02
  6.04846813e-02 -7.93153495e-02  7.57304206e-02  7.99388811e-03
 -2.53368169e-02 -2.21152548e-02 -1.46037424e-02  2.52939481e-02
  1.26258517e-02  3.20876613e-02 -4.53446209e-02 -5.44898771e-03
 -3.26916855e-03  2.45315162e-03  9.48663522e-03 -4.18783687e-02
  1.71152148e-02  3.34105790e-02  3.67621295e-02  1.34110609e-02
  2.55417749e-02  9.07982606e-03  5.41936792e-02 -5.67483250e-03
  4.44037840e-02  2.17993949e-02  3.96449976e-02  3.30755450e-02
 -2.32412498e-02  8.35453905e-03  9.07690171e-03 -5.79554541e-03
 -7.68217782e-04 -1.54265426e-02  3.91425267e-02  8.10031667e-02
 -3.85098904e-02 -4.30948325e-02 -2.33384129e-02 -3.00977603e-02
  1.71839129e-02  6.20542951e-02  5.94422296e-02 -2.54187416e-02
  8.75113066e-03  8.43818337e-02 -6.13200217e-02 -9.83906351e-03
  1.77196469e-02  4.77437396e-03 -3.50100063e-02  6.53467998e-02
 -1.70517992e-02 -8.96764337e-04 -7.63085857e-02  2.88491528e-02
  6.50037453e-03 -4.12550643e-02 -3.97176966e-02  3.95610780e-02
  2.87844784e-07 -3.49132121e-02 -3.91472504e-02  7.39660338e-02
  3.42622027e-02  5.01970835e-02 -3.38616170e-04  4.12209332e-03
  2.97770593e-02 -5.64907119e-02  5.52341528e-03  1.46523789e-02
  1.86069869e-02  1.68414284e-02 -2.62250658e-02 -4.02860157e-02
 -2.82669626e-02 -2.08979137e-02  4.60309535e-02 -7.59609276e-03
  2.05861833e-02  1.65895130e-02  9.19147730e-02 -1.70511957e-02
  3.67874615e-02  9.22454800e-03 -1.18944477e-02  3.44598293e-02
  4.56754975e-02  3.33714597e-02 -4.62333113e-02 -3.63795902e-03
 -1.05823958e-02 -5.25114425e-02 -2.85045374e-02 -3.39872651e-02
  8.54014326e-03  3.04061770e-02  6.08873367e-03 -7.45975273e-03
 -4.20164764e-02  3.89508009e-02  1.86543409e-02 -2.66920477e-02
 -2.33110674e-02 -1.95233840e-02 -2.64153425e-02 -7.01567009e-02
  9.29274783e-03  1.10295992e-02  1.28452471e-02 -2.99711842e-02
  1.45761110e-02 -2.75967661e-02 -6.79567084e-02  1.82779729e-02
 -2.37204768e-02  3.47917601e-02 -5.67642525e-02  1.22512672e-02
  6.65693078e-03  4.60851518e-03  7.99388159e-03 -8.38743746e-02
  1.77442533e-04  9.23540443e-02  5.34304082e-02 -6.98025376e-02
  2.21795419e-34  1.50374714e-02 -4.57685664e-02 -6.65909657e-03
 -2.34573372e-02 -5.28608495e-03 -4.18731160e-02 -3.92451435e-02
 -6.93437038e-03  3.57596911e-02 -2.12729834e-02 -6.01260699e-02]"
"We also experimented with using learned positional embeddings [9] instead, and found that the two
versions produced nearly identical results (see Table 3 row (E)). We chose the sinusoidal version
because it may allow the model to extrapolate to sequence lengths longer than the ones encountered
during training.
 4
Why Self-Attention
In this section we compare various aspects of self-attention layers to the recurrent and convolu-
tional layers commonly used for mapping one variable-length sequence of symbol representations
(x1, ..., xn) to another sequence of equal length (z1, ..., zn), with xi, zi ∈Rd, such as a hidden
layer in a typical sequence transduction encoder or decoder. Motivating our use of self-attention we
consider three desiderata.
 One is the total computational complexity per layer. Another is the amount of computation that can
be parallelized, as measured by the minimum number of sequential operations required.
 The third is the path length between long-range dependencies in the network. Learning long-range
dependencies is a key challenge in many sequence transduction tasks. One key factor affecting the
ability to learn such dependencies is the length of the paths forward and backward signals have to
traverse in the network. The shorter these paths between any combination of positions in the input
and output sequences, the easier it is to learn long-range dependencies [12]. Hence we also compare
the maximum path length between any two input and output positions in networks composed of the
different layer types.
 As noted in Table 1, a self-attention layer connects all positions with a constant number of sequentially
executed operations, whereas a recurrent layer requires O(n) sequential operations. In terms of
computational complexity, self-attention layers are faster than recurrent layers when the sequence
6
","[-1.02313363e-03  7.19857449e-03 -1.41670750e-02  1.67516973e-02
 -5.19393273e-02 -1.29190618e-02  5.64088002e-02 -1.25582367e-02
 -2.51547936e-02  1.70116033e-02 -2.98785735e-02 -1.69946980e-02
  3.74597497e-02  5.31175733e-03  3.23775448e-02 -6.25997968e-03
  1.46942325e-02 -1.88037916e-03 -4.79318909e-02 -2.42101238e-03
 -3.66304442e-02 -5.41003570e-02 -1.16005288e-02  2.42291782e-02
  4.83873300e-03 -6.41181879e-03 -4.04178314e-02 -2.33569257e-02
  1.95089802e-02 -6.28473982e-02 -3.82082723e-02  5.82917295e-02
  5.71121946e-02  4.49027829e-02  2.00197928e-06  6.01960300e-03
  1.73264313e-02 -3.08986418e-02 -3.55762430e-03  9.19802859e-03
 -3.84188369e-02 -2.32408065e-02 -4.13904898e-02 -1.20077962e-02
 -1.46895098e-02  6.15211157e-03  4.82259654e-02  4.33450891e-03
  1.17628137e-02  6.67953715e-02  3.03819310e-03 -3.65121216e-02
  1.38645368e-02 -5.71045503e-02  2.50663571e-02  2.51000021e-02
 -2.57014739e-03 -4.26519997e-02  4.79308888e-03  3.06228697e-02
 -5.87324239e-02  6.90535083e-02  5.88606261e-02  2.35248562e-02
  2.79412884e-02  4.89723198e-02  4.01987769e-02 -2.06127744e-02
 -1.57178529e-02  2.88179349e-02 -1.11830354e-01 -1.09806713e-02
 -3.00736073e-02  4.15515713e-03 -5.18226810e-03 -2.87103578e-02
 -1.27993077e-02 -5.73582668e-03  8.12220573e-03  3.00403070e-02
  1.26818055e-02  2.51252688e-02  1.97956935e-02 -6.73155561e-02
 -1.29116578e-02  2.31800266e-02 -1.79538934e-03 -2.49480624e-02
 -3.00222971e-02 -2.20867041e-02  3.94333676e-02 -3.35297622e-02
  2.67667398e-02  3.98022421e-02  6.83299154e-02 -5.51369134e-03
 -9.91967507e-03 -2.73656957e-02 -8.67365859e-03 -6.15163967e-02
  6.09372556e-02  6.11213967e-02 -1.65021885e-02 -1.09170843e-02
 -7.59941414e-02  6.07978366e-02 -4.27332968e-02  1.19225439e-02
 -1.42202871e-02  7.93458074e-02 -1.44388725e-03  9.56409704e-03
 -3.27358879e-02  3.63100357e-02 -2.36584228e-02 -5.21226041e-02
 -5.24661914e-02  3.45271709e-03 -1.93254240e-02 -2.75722501e-04
 -2.68961266e-02  1.88429523e-02 -5.03776856e-02  5.41845430e-03
  2.22365540e-02  4.42016125e-02 -3.83612476e-02  1.62301050e-03
  5.80365397e-03  6.71344297e-03 -4.24790345e-02 -3.32219061e-03
  3.49605829e-02  1.35650327e-02 -4.59597958e-03  6.44585341e-02
  1.36292530e-02 -5.16414717e-02 -3.11527885e-02  2.39076130e-02
 -5.05309626e-02 -2.22069900e-02  5.65540642e-02 -5.43197170e-02
  5.84854104e-04 -4.56283847e-03 -3.26576196e-02 -2.15831073e-03
  4.17821631e-02  4.55969805e-03  3.04137021e-02  5.27244173e-02
  3.94552164e-02 -3.78179438e-02  3.54364924e-02  1.30121419e-02
  3.50727811e-02  1.72559712e-02  2.62985602e-02  4.02246229e-02
 -4.43844572e-02 -5.33208698e-02  1.73336864e-02 -1.50882197e-03
  3.24043483e-02 -2.37773061e-02 -5.83517551e-02 -4.15130742e-02
 -1.15789496e-03  6.19948320e-02  5.51825985e-02  1.20105930e-02
 -1.99867059e-02 -6.31307513e-02  2.37621479e-02  7.77641684e-02
  9.72370878e-02  2.82359030e-02  5.73834814e-02 -2.34469213e-02
 -7.92062469e-03  5.01288958e-02 -1.69067234e-02  1.01273656e-01
  2.83151865e-02  1.02943908e-02  5.27232746e-03  1.25995036e-02
 -1.37970252e-02 -3.68717685e-02  2.05538999e-02 -1.82356928e-02
  3.00474418e-03 -5.68357259e-02  2.16199644e-02  2.60105822e-03
 -6.70850053e-02  3.97376018e-03 -1.68113336e-02 -6.14611711e-03
 -4.04527187e-02  2.04814021e-02 -5.49672311e-03  2.63520256e-02
 -1.29908202e-02 -2.15258002e-02 -1.73599236e-02 -1.84009317e-02
 -2.86501627e-02  3.77342775e-02  1.61527446e-03  3.38706374e-02
 -4.21972666e-03 -1.55631881e-02 -3.10380235e-02  9.84727778e-03
 -1.41470823e-02  7.62638822e-02 -2.00784523e-02  1.18202753e-02
  1.26906689e-02  4.14131768e-02 -2.18742993e-02 -6.69975125e-04
 -1.91078428e-02 -6.04277514e-02 -1.15305725e-02  4.75014523e-02
  4.01417725e-02  8.70902371e-03  1.39335338e-02  3.82610485e-02
  3.16495635e-02 -7.43023083e-02  3.14326212e-03 -1.96865648e-02
 -1.39978468e-01 -5.04703298e-02  2.46555135e-02 -2.64335144e-02
  3.35893743e-02  2.30615567e-02  2.58628130e-02 -5.31066433e-02
  7.17653707e-02 -6.87891170e-02 -1.26361446e-02  5.45544457e-03
  1.94253190e-03  3.28464471e-02  4.62153517e-02 -3.41598457e-03
  9.47647914e-03 -8.90429784e-03  2.18557827e-02 -1.30008310e-02
  4.10784110e-02  3.01068742e-02 -4.27526236e-02  2.30228715e-02
  1.85642783e-02 -1.74370594e-02 -2.59754043e-02  1.49488123e-03
 -5.88137805e-02 -8.23468715e-03 -2.70832777e-02 -3.41530293e-02
 -1.54935233e-02 -5.54447342e-03  4.11521345e-02 -3.70574482e-02
 -1.95853077e-02  1.89190079e-02 -1.20867472e-02 -4.03811261e-02
  4.88665365e-02 -2.36736033e-02  6.52366923e-03  6.50024489e-02
  1.34287942e-02 -6.00562654e-02 -5.32131121e-02 -5.38944453e-02
  7.17811985e-03  5.76905049e-02 -7.82174245e-03 -4.27684262e-02
 -3.38307507e-02 -4.18117978e-02  3.19786072e-02  4.50350009e-02
 -1.50198927e-02 -7.95059949e-02  1.46405790e-02  3.87772685e-04
  2.88810879e-02  6.41435832e-02  3.01272199e-02  2.03193035e-02
  1.03605054e-02 -8.28159135e-03  3.18896235e-03  2.31276639e-02
 -5.26331551e-02  5.61007410e-02 -2.76158825e-02  1.51901254e-02
 -3.00933793e-02  9.76382643e-02  1.18818437e-03 -1.71438185e-03
 -5.59251718e-02 -1.28970966e-02  2.75478028e-02 -2.84353327e-02
  3.41631025e-02 -3.32730003e-02 -3.32347006e-02 -7.90707953e-03
  4.49289009e-03 -3.61569934e-02  3.55347842e-02 -2.50701103e-02
  3.30503052e-03 -8.50723404e-03 -9.59110260e-03 -1.87963434e-02
  5.88025488e-02  4.95194979e-02  2.74261050e-02 -7.09078275e-03
 -4.06181365e-02 -6.57451013e-03  4.03467864e-02  2.75659608e-04
  4.40168520e-03  1.69249857e-03 -5.45924995e-03 -3.06488015e-02
 -2.79663913e-02 -1.74963307e-02 -2.17868332e-02  4.15804014e-02
  1.12194698e-02  2.83780508e-03 -3.15187755e-03 -2.64291633e-02
 -6.66386774e-03  1.13967741e-02  1.80253889e-02  6.45051077e-02
 -5.93523961e-03  1.19553730e-02 -1.31089138e-02  1.72025058e-02
 -3.83439399e-02  9.88135580e-03  1.31591025e-03  4.35223877e-02
  5.34300096e-02 -6.57602167e-03  1.57967210e-02  3.19203585e-02
 -5.30760549e-02  3.59582864e-02  1.06597354e-03 -4.38761339e-02
 -3.89623530e-02  1.59940179e-02  2.06733979e-02 -9.32670906e-02
 -2.44300049e-02  6.21870831e-02  1.34361326e-03 -2.45808121e-02
  2.22010873e-02  1.89316534e-02 -2.86750514e-02  1.67797003e-02
 -1.65833421e-02 -5.38985170e-02  9.55578592e-03 -1.46173574e-02
 -1.41301928e-02  8.43191240e-03  1.61198154e-02  8.94759595e-03
 -6.42995462e-02  3.35673168e-02  3.94364223e-02 -6.50048926e-02
 -6.33803979e-02 -2.61412729e-02 -3.64365838e-02  3.71668562e-02
 -6.94035599e-03  4.62209024e-02 -2.99951378e-02 -2.04447377e-02
  4.50930074e-02 -5.16092144e-02 -2.36014556e-03 -5.33263059e-03
 -3.51501182e-02  8.55161867e-04  3.76662314e-02  2.01610029e-02
  6.24261098e-03 -4.86189052e-02  2.45010592e-02  9.29415226e-03
  6.38884753e-02  1.05677834e-02  4.74008583e-02  2.45791860e-02
 -2.86352765e-02  3.56498500e-03  2.23122705e-02 -5.34519292e-02
  1.45737510e-02 -5.60297444e-02  6.11038432e-02 -8.20411951e-04
 -1.74118914e-02 -4.47690189e-02  2.68683247e-02 -3.16688046e-02
  2.16960050e-02  5.41720167e-02 -3.71598043e-02 -5.21159917e-02
 -1.25704594e-02  4.81131263e-02 -7.85943866e-02 -4.06362750e-02
  1.05381114e-02  4.16826606e-02 -8.72397944e-02 -5.04606143e-02
 -3.82655561e-02 -2.76465062e-02  8.95320848e-02  3.30879749e-03
  1.06226448e-02  2.26673521e-02 -1.15915965e-02 -3.70829776e-02
 -4.31022281e-03  3.41629200e-02 -4.96295700e-03 -2.71010194e-02
  1.79672167e-02  1.11616878e-02 -2.29832958e-02  2.54924898e-03
 -1.06539167e-02 -8.74792263e-02 -3.38869914e-02  3.65495384e-02
  1.74219646e-02  1.07474960e-02  2.51866169e-02  8.83535948e-03
  2.46090312e-02  8.76456574e-02  1.52347572e-02  5.27605787e-03
  1.70775242e-02  6.33348748e-02 -4.95650247e-02 -2.06829216e-02
 -1.98580511e-03  1.42153250e-02  4.30983305e-02  1.02261323e-02
  6.41848147e-03  3.28115025e-03 -1.61517411e-02  3.20232138e-02
 -2.86265220e-02  4.87569831e-02  3.81064974e-02  4.56190147e-02
  7.74603942e-03  4.79734279e-02 -2.84597147e-02  4.41080220e-02
 -4.19647694e-02 -1.87641755e-02  4.94174212e-02  4.32198904e-02
  2.81255897e-02 -3.63485962e-02  4.73165065e-02 -4.77550216e-02
  1.34438358e-03  8.19039196e-02 -2.39290558e-02  2.87133697e-02
 -3.41088809e-02  1.80982482e-02 -3.16357464e-02  2.77811419e-02
 -1.89407840e-02  1.73046663e-02 -2.81537138e-02  6.84119575e-03
  2.70660818e-02  5.15338629e-02 -2.62675099e-02  1.44028263e-02
 -4.60719801e-02 -8.19378838e-05 -9.80758946e-03 -1.84004065e-02
  8.53470862e-02 -3.74864079e-02 -1.03422925e-02 -1.08990436e-02
 -1.33636640e-03  8.05708580e-03  1.63075048e-02 -2.97134817e-02
  3.47410440e-02  1.34489285e-02  2.62491535e-02  8.87283683e-03
 -4.74001542e-02  6.01233244e-02  2.88470853e-02  3.31451818e-02
  2.08057724e-02  4.37217019e-03 -2.71875486e-02 -1.08641526e-02
 -1.64884899e-03 -7.70104490e-03 -2.49744356e-02 -1.63392723e-02
  6.29215920e-03 -5.60536496e-02  5.35054356e-02 -7.27815181e-03
  1.17317997e-02 -2.60825735e-02  4.35749143e-02  3.14545538e-03
  2.49345005e-02 -1.21693881e-02  2.42554024e-02  3.20052020e-02
  9.70938185e-04 -3.66326533e-02  1.42529758e-03 -5.98189092e-33
 -3.35204042e-03 -2.77668443e-02  1.66051146e-02 -1.90710891e-02
 -5.13297096e-02  7.23355124e-03 -2.24748384e-02  1.69774145e-02
  1.56919882e-02  1.73275992e-02 -1.30751925e-02  6.16980996e-03
  2.09281035e-03  1.69887803e-02  6.07004389e-02 -3.96450004e-03
  3.00853848e-02 -3.14626843e-02  1.93933882e-02 -8.34434014e-03
  5.23825735e-02  3.10707763e-02  5.40220365e-02 -3.50640155e-02
 -3.47936563e-02  3.35719697e-02  3.40692736e-02 -4.80145402e-02
 -1.29898982e-02  3.17502022e-02 -1.02250827e-02  1.38429645e-02
  1.41084054e-02 -7.99997151e-02 -2.04629153e-02  3.76387537e-02
 -7.98206851e-02 -5.53846695e-02 -5.58845922e-02  1.41726239e-02
 -6.22400269e-02 -4.43944447e-02  9.54981372e-02 -3.23397629e-02
 -1.56789795e-02 -2.58861575e-02 -2.19101254e-02 -3.53951380e-02
 -4.29442041e-02  1.15287267e-02 -5.96155301e-02  2.00603306e-02
 -3.46089806e-03 -2.04842240e-02  9.01969969e-02  9.20435879e-03
 -2.44656187e-02 -1.07835708e-02 -4.48202379e-02  1.98250473e-03
  9.10212006e-03  1.00767508e-01  1.03129400e-02  1.49942813e-02
  4.16711122e-02 -1.36033688e-02  8.50096717e-02 -3.57967727e-02
 -5.41070336e-03 -8.81389342e-03 -8.51984229e-03  2.42577604e-04
  8.69281739e-02 -5.21821491e-02  8.79806802e-02 -1.39700202e-02
 -8.24541003e-02 -2.92789843e-02 -2.31645461e-02  1.24498894e-02
  1.40648428e-02  3.82415652e-02 -4.16310728e-02 -1.05733040e-03
 -3.11469636e-03 -4.89290105e-03 -1.15261702e-02 -3.71480361e-02
  1.07416594e-02  2.56545078e-02  3.97445858e-02  4.96572331e-02
  3.02193835e-02  6.09221868e-03  2.65570395e-02 -2.04049912e-03
  2.38677487e-02  1.73415504e-02  3.65966298e-02  8.00062623e-03
 -5.78853488e-02  2.14436743e-02  3.71140521e-03  1.86064672e-02
  1.47101181e-02 -2.69471388e-02  3.46331932e-02  4.47072163e-02
 -4.18757498e-02 -5.85893393e-02 -4.69204895e-02 -3.12094968e-02
  1.37011483e-02  3.18121277e-02  7.32165650e-02 -4.69532833e-02
 -3.76293226e-03  3.78340892e-02 -2.48039495e-02 -3.23797879e-03
 -1.48024894e-02  2.78306101e-02 -3.15145552e-02  5.07438667e-02
 -1.61837488e-02 -2.03881953e-02 -6.97100982e-02  6.20052367e-02
  1.85699353e-03 -7.67468661e-02 -4.17327769e-02  3.81965823e-02
  2.96765620e-07  5.88084944e-03 -3.82820424e-03  7.51020908e-02
  2.47773379e-02  5.30615561e-02 -4.22561541e-03 -1.91147272e-02
  4.54491042e-02 -2.33056266e-02  1.34580964e-02  3.13669927e-02
  7.39239855e-03  1.12625246e-03  1.01602562e-02 -3.37643698e-02
 -3.24498750e-02 -4.21184860e-02  5.71068376e-02 -1.25424378e-02
  1.15514789e-02  5.54541731e-03  6.58599585e-02 -3.17892544e-02
  1.19010471e-02  2.57628262e-02 -6.20408542e-03  5.42561710e-02
  3.28599922e-02  5.33531941e-02 -3.40725295e-02  5.40215289e-03
 -7.03266868e-03 -5.12415394e-02 -1.79142021e-02 -3.29872295e-02
  2.11961921e-02  1.61095969e-02 -1.94646195e-02 -7.03701982e-03
 -6.65924400e-02  3.27297188e-02  1.95491035e-02 -1.16990565e-03
 -2.51979772e-02  2.49810005e-03 -9.07440633e-02 -4.60789092e-02
  3.37313004e-02 -1.47249270e-02  1.88636258e-02  1.90852932e-03
  6.75082114e-03  1.52230505e-02 -3.73733081e-02  1.48263313e-02
 -1.21395579e-02  8.24896526e-03 -5.42187914e-02 -6.97688479e-03
  3.73497009e-02 -3.07556838e-02  2.07590219e-02 -1.26699209e-01
  3.66549869e-03  7.57744759e-02  2.82272492e-02 -8.14043358e-02
  2.39939565e-34 -2.31261421e-02 -6.50185943e-02  1.68996938e-02
 -1.92776062e-02 -1.63249131e-02 -3.21449600e-02 -3.49148251e-02
  5.30641992e-03  3.86926197e-02 -2.53383592e-02 -6.43972829e-02]"
"length n is smaller than the representation dimensionality d, which is most often the case with
sentence representations used by state-of-the-art models in machine translations, such as word-piece
[38] and byte-pair [31] representations. To improve computational performance for tasks involving
very long sequences, self-attention could be restricted to considering only a neighborhood of size r in
the input sequence centered around the respective output position. This would increase the maximum
path length to O(n/r). We plan to investigate this approach further in future work.
 A single convolutional layer with kernel width k < n does not connect all pairs of input and output
positions. Doing so requires a stack of O(n/k) convolutional layers in the case of contiguous kernels,
or O(logk(n)) in the case of dilated convolutions [18], increasing the length of the longest paths
between any two positions in the network. Convolutional layers are generally more expensive than
recurrent layers, by a factor of k. Separable convolutions [6], however, decrease the complexity
considerably, to O(k · n · d + n · d2). Even with k = n, however, the complexity of a separable
convolution is equal to the combination of a self-attention layer and a point-wise feed-forward layer,
the approach we take in our model.
 As side benefit, self-attention could yield more interpretable models. We inspect attention distributions
from our models and present and discuss examples in the appendix. Not only do individual attention
heads clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic
and semantic structure of the sentences.
 5
Training
This section describes the training regime for our models.
 5.1
Training Data and Batching
We trained on the standard WMT 2014 English-German dataset consisting of about 4.5 million
sentence pairs.","[ 1.92722548e-02  1.51158199e-02 -5.22311777e-03  7.25084022e-02
 -3.65607552e-02 -1.05011873e-02  4.23130803e-02 -2.07656082e-02
 -1.06365681e-02 -2.95176059e-02 -8.41752812e-03 -3.60107943e-02
  6.41650753e-03  1.71281230e-02  2.94193383e-02 -7.59764612e-02
  2.61601359e-02 -4.64924378e-03 -1.15653733e-02  1.09452503e-02
 -8.44218954e-03 -2.53066915e-04 -1.05267414e-03  3.90079729e-02
 -2.40537599e-02 -2.74218265e-02 -3.02743763e-02  2.04100758e-02
  1.80972088e-02 -4.64817658e-02  3.18203587e-03  4.45100777e-02
  1.49368541e-02  4.46222685e-02  2.13049452e-06  2.13872734e-03
 -8.08127038e-03 -1.85891092e-02 -3.87825305e-03  2.76245270e-02
  6.17035339e-03 -5.65280132e-02 -5.60401659e-03 -1.27857970e-02
 -2.54565640e-03  1.10333627e-02  3.70141119e-02  4.07244489e-02
  4.46435846e-02  1.10273428e-01 -5.66838961e-03 -5.94828241e-02
  4.03625984e-03 -7.04186484e-02  3.83940595e-03 -1.88224427e-02
  1.29344378e-04 -2.94394679e-02 -2.29051759e-04  2.86920387e-02
 -6.03788048e-02  5.67300171e-02  3.23149264e-02  1.53309917e-02
  4.37858850e-02  3.31891179e-02 -2.02577990e-02 -5.66392345e-03
  1.15977862e-04  7.01954514e-02 -8.65981653e-02  3.37381847e-03
  3.40250251e-03 -9.76151321e-03  4.75409999e-03 -5.31252958e-02
 -3.03868987e-02  2.39565931e-02  1.36214765e-02  8.00330564e-03
 -2.42975466e-02  4.12045605e-02  1.67928506e-02 -4.47399309e-03
 -5.14417589e-02  1.12456828e-02 -2.77977251e-02 -2.46979631e-02
 -3.08024567e-02  1.03773235e-03  3.21525731e-03 -2.90793050e-02
  3.14959139e-02  2.86144670e-02  5.59714735e-02  1.27568226e-02
 -2.95867641e-02 -4.44306731e-02  1.09655662e-02 -8.75294730e-02
  2.81083733e-02  3.79235558e-02 -2.28514224e-02  3.22355777e-02
 -2.61179544e-02  5.21991253e-02 -3.24014165e-02  3.42118926e-02
 -4.41221185e-02  5.01445830e-02 -1.83037948e-02  2.95768883e-02
 -7.55927488e-02  2.52316147e-02 -4.22555953e-02 -3.67722735e-02
 -1.67074800e-02  3.23073589e-03  9.41210892e-03 -1.68375615e-02
  5.89788519e-03  3.53371771e-03 -4.69538122e-02 -3.41917016e-02
  2.32567284e-02  4.95287478e-02 -6.47666976e-02 -2.56943814e-02
  1.27378479e-02 -8.34700093e-03 -5.72808273e-02  1.82170458e-02
  4.65442538e-02 -2.14858502e-02 -1.49281891e-02  5.34001514e-02
  3.30600608e-03 -6.15025200e-02  8.29147000e-04 -4.99821268e-04
 -6.35435954e-02 -8.20072442e-02 -6.28474820e-03 -6.47221878e-02
  3.53250392e-02 -1.88872851e-02  5.16407052e-03 -1.83246527e-02
  1.86446961e-02  1.24293296e-02 -7.53152557e-03  5.20599447e-02
  5.32129817e-02 -1.17057199e-02  6.15545129e-03  1.65281277e-02
  2.92784981e-02  3.80172767e-02  5.47443368e-02  5.23228869e-02
 -1.03281345e-02 -1.86116379e-02 -8.88466090e-03 -2.74508493e-03
  8.39338265e-03 -1.18991053e-02 -4.24310043e-02  1.68253333e-04
 -1.50531596e-02  4.61729281e-02  4.28944305e-02  2.66834386e-02
 -2.93471329e-02 -4.41293269e-02  4.82456535e-02  5.82320653e-02
  5.50090373e-02  3.44716497e-02  5.20750917e-02  4.86497283e-02
 -2.12384351e-02  2.29786970e-02 -4.81671393e-02  6.17609471e-02
  5.54082431e-02  4.38199670e-04  3.13021466e-02  1.55579271e-02
 -4.01908197e-02 -4.16295752e-02  1.30407205e-02 -2.37449091e-02
  1.36202425e-02 -1.13085359e-02  2.91443132e-02  1.01482933e-02
 -5.17638437e-02  3.31987441e-02 -1.41277094e-03 -4.88514490e-02
 -9.61634330e-03  1.42724365e-02 -1.81540835e-03  5.65768145e-02
  7.12300092e-03 -1.50227249e-02 -2.39981320e-02 -3.50789204e-02
  4.45142807e-03  3.30975689e-02  2.40689646e-02  3.02392542e-02
  3.33284885e-02 -4.10785116e-02 -6.75170776e-03 -1.55049274e-02
 -1.63187459e-02  3.81556153e-02  7.13467039e-03  3.41783948e-02
  2.72734165e-02 -9.57178045e-03 -7.90116377e-03  2.93766111e-02
  3.44279334e-02 -2.98951808e-02  1.16052630e-03  3.81765217e-02
  3.41254435e-02  3.30806039e-02  1.15428958e-02  2.74042841e-02
  4.37516570e-02 -6.32422790e-02 -2.10079290e-02  4.02696012e-03
 -8.11246559e-02 -7.70998672e-02  1.03180585e-02 -1.95726231e-02
 -6.79057208e-04  1.75982304e-02 -4.49071117e-02 -2.86606271e-02
  4.84379120e-02 -5.80621660e-02 -5.41537767e-03  1.31841339e-02
  1.19363191e-02  4.96450551e-02  4.62552458e-02 -6.35089539e-03
  3.91277857e-02 -7.21258437e-03  2.99396063e-03 -3.66118550e-02
  2.70566475e-02  3.21899876e-02 -6.06091172e-02 -1.02200406e-02
  1.09590692e-02 -1.73940901e-02  5.19598695e-03  3.05590853e-02
 -2.90660188e-02 -2.91750282e-02 -5.14914766e-02 -4.87650633e-02
 -2.29343248e-04 -2.66197156e-02  2.19185986e-02 -3.11661744e-03
 -3.36075737e-03  1.69073027e-02 -3.98424454e-02 -4.03296053e-02
  3.03427316e-02 -9.61853843e-03  2.62690801e-03  3.35649662e-02
  8.73300899e-03 -2.64374427e-02 -4.71985675e-02 -4.54202741e-02
  9.99500602e-03  3.22786570e-02 -1.13225114e-02 -6.06088303e-02
 -4.46201265e-02 -2.27476712e-02 -5.12268161e-03  1.98141579e-02
 -1.58020724e-02 -7.98526630e-02 -1.50142740e-02 -3.23744193e-02
  5.34136072e-02  1.13548256e-01  3.87220345e-02  2.04663780e-02
  2.54103895e-02 -4.16907668e-03 -1.91484168e-02  4.48340364e-02
 -2.14923695e-02  4.67022210e-02 -3.22494507e-02 -7.03934534e-03
 -1.08003542e-02  6.74434528e-02  1.48466835e-02  2.79919542e-02
 -6.71305209e-02 -2.29169391e-02  5.37984399e-03 -2.55712997e-02
 -9.66075156e-03  5.10023907e-03 -8.41529854e-03  1.81697076e-03
 -2.57402696e-02 -2.94479951e-02  2.98020598e-02 -2.15693228e-02
 -9.86184832e-03 -2.93501504e-02 -1.88949537e-02 -4.10106704e-02
  1.23041376e-01  3.81597281e-02  3.36031355e-02 -1.12799101e-03
 -1.72186829e-02 -2.74804737e-02  2.57161837e-02 -4.15230915e-03
 -1.42835006e-02  3.64332274e-02 -2.35102139e-02  5.86381473e-04
 -3.68819796e-02 -3.38360779e-02 -3.03942133e-02 -2.01730877e-02
 -1.39437895e-02 -2.64015626e-02 -2.02501062e-02 -3.75796035e-02
 -3.36724855e-02  3.89569513e-02  2.10349262e-02  6.46516904e-02
 -2.30425429e-02  3.73021252e-02 -3.22963074e-02  3.82445417e-02
  7.42541626e-03  4.05702703e-02 -1.49079198e-02 -6.12742919e-03
  4.88925092e-02  4.99059632e-02 -1.23517560e-02  1.09663419e-02
 -4.39933762e-02 -8.09028652e-03 -6.22091233e-04 -3.08417790e-02
 -1.57431699e-02  1.63284671e-02  8.38317499e-02 -1.24149650e-01
 -1.59871764e-02  9.45335925e-02 -1.08353786e-04 -2.86961254e-02
  7.47423386e-03  4.68601584e-02 -1.21729653e-02  8.35242402e-03
  1.40903862e-02 -5.57182170e-02 -2.45896149e-02 -1.46143511e-02
 -3.40806111e-03  4.75835018e-02  6.04668912e-03 -1.38032986e-02
 -8.07770640e-02  4.26298790e-02  4.97296862e-02 -4.97939698e-02
 -6.55818358e-02 -2.94992258e-03 -5.27954064e-02 -9.89688467e-03
 -1.98624022e-02  1.11991502e-02 -4.48292773e-03 -2.58161612e-02
  1.67125985e-02 -6.18327735e-03  2.22571120e-02  1.25537477e-02
 -3.99614945e-02  3.40499021e-02  6.59646690e-02  3.07087544e-02
  2.55896840e-02 -3.09469886e-02  1.13626318e-02 -3.21366973e-02
  2.55832896e-02  2.77148820e-02  7.51252696e-02 -2.75722444e-02
 -9.45642963e-03  1.85586177e-02  1.00602219e-02 -4.48680632e-02
  1.15173645e-02  8.43724888e-03  5.65951616e-02  1.86009668e-02
 -2.12383065e-02 -3.69514152e-02  2.06758194e-02 -2.41780169e-02
  8.02267790e-02  4.16190848e-02 -2.24744063e-02 -7.48945028e-02
 -1.05867358e-02  4.73826984e-03 -8.76443610e-02 -1.45573672e-02
  1.51912635e-02  4.93789418e-03 -3.46609205e-02 -8.54075849e-02
 -8.10843930e-02  5.14946925e-03  5.48578538e-02 -2.02796124e-02
 -5.36600407e-03  1.21062342e-02  1.90629866e-02 -5.51520400e-02
  3.00673489e-02 -1.59600731e-02  2.20982060e-02 -4.80545796e-02
  4.57690144e-03  2.90036853e-03 -1.71866771e-02  1.35686267e-02
  2.42081098e-03 -1.30051032e-01 -4.23227921e-02 -1.72653992e-03
  6.82252571e-02  1.49716474e-02  6.28930703e-02 -1.41297011e-02
 -9.18031856e-03  3.58524919e-02 -1.28898527e-02 -4.65641767e-02
  8.17784667e-03  5.49362600e-02  4.84274904e-04 -2.39911359e-02
  4.99074310e-02  1.08946236e-02  7.45562166e-02 -2.47407355e-03
  2.25464869e-02 -3.05088665e-02 -4.43464555e-02  1.24846096e-03
 -4.09248769e-02  4.75612916e-02  3.40290852e-02  5.68683743e-02
 -8.13914277e-03  1.75951626e-02 -2.51989923e-02  1.71372704e-02
 -5.59923798e-02 -6.93658367e-03  4.77074981e-02 -3.01824156e-02
  1.01641957e-02 -1.01093156e-02  1.21007515e-02 -6.20380417e-02
 -2.37310752e-02  3.51806916e-02 -2.50217952e-02 -4.02782299e-03
  4.64177364e-03  2.45544724e-02 -3.47114690e-02  1.37161696e-02
 -9.65089165e-03  1.06877228e-02 -2.69274670e-03  3.27071249e-02
  1.37709416e-02  2.32421327e-02 -3.98153141e-02  2.03401223e-02
 -7.73242116e-02  8.77992250e-03 -3.07003185e-02  1.72626637e-02
  3.14043462e-02 -4.52540405e-02  4.08094935e-02 -1.35580320e-02
 -8.29926692e-03 -2.14397591e-02  3.77294831e-02 -2.58414121e-03
 -4.67042252e-03  6.07950380e-04  3.94589715e-02 -7.10022356e-03
 -2.87771467e-02  6.50910512e-02 -1.56707282e-03  2.36173347e-02
  4.54223827e-02 -1.10463996e-03 -5.32635748e-02 -3.43938102e-03
 -3.78014520e-02  7.90051930e-03 -1.10197505e-02  1.79324094e-02
 -6.68158755e-03 -4.33032364e-02  3.12302485e-02 -1.52768353e-02
  5.01340628e-02 -2.70753596e-02  4.59580645e-02  2.75569130e-02
  9.06458031e-03 -6.95915194e-03 -2.65640877e-02  3.95987891e-02
 -1.81749482e-02 -3.64087448e-02 -1.57466736e-02 -6.50434526e-33
 -6.06451230e-03 -1.23699643e-02 -7.76666496e-03 -2.32227538e-02
 -6.01851456e-02  2.26796940e-02 -4.11150418e-02  1.00786248e-02
 -5.94284106e-03  2.41382513e-02  1.03306887e-03  8.84478074e-03
  8.78967997e-03  2.20179502e-02  2.76524741e-02 -3.43215931e-03
  9.11277905e-02 -1.72542147e-02 -1.30980527e-02  2.63457149e-02
  2.23319940e-02  4.10581194e-02  5.13381809e-02 -9.89504997e-03
  4.94809728e-03 -2.96324994e-02 -9.64046828e-03 -6.65648980e-03
  1.59976631e-02  2.78761610e-02  6.70717191e-03  1.20352693e-02
  3.48363630e-02 -6.26705959e-02 -3.88908572e-02  3.04561034e-02
 -1.18957847e-01 -6.30307430e-03 -5.49765080e-02  2.55140122e-02
 -7.12428242e-02 -3.83336507e-02  7.08005801e-02 -2.65701562e-02
  2.39420310e-02 -4.96463478e-02  4.78111673e-03 -2.10551061e-02
 -4.34446372e-02  2.79998872e-02 -5.76670207e-02  2.03062035e-02
 -3.05758789e-02 -4.28262092e-02  7.48963878e-02  2.02438980e-02
  8.07586871e-03  6.08153315e-03 -5.66685013e-02 -1.30878715e-02
  8.46808031e-03  1.06429346e-01  1.12929568e-02  8.40693130e-04
 -4.96185618e-03  1.25845484e-02  3.80981527e-02 -2.28603613e-02
 -4.11771014e-02 -3.05074989e-03 -1.77586395e-02  2.49208082e-02
  6.82379827e-02 -5.31947939e-04  7.32553527e-02 -1.61840077e-02
 -7.03108832e-02 -2.15129722e-02  1.03729833e-02  3.69825028e-02
  1.49907339e-02  2.80822571e-02 -5.13916612e-02  1.03647904e-02
  2.23953975e-03 -3.86236385e-02 -8.38549808e-03 -3.39318626e-02
  2.49365773e-02  4.74504419e-02  1.03247364e-03  4.40939236e-03
  3.59462127e-02 -5.75160701e-03  5.32292761e-02  1.25928677e-03
 -1.17365234e-02  1.19562978e-02  3.78428325e-02  1.54002775e-02
 -5.20932600e-02  9.34381504e-03 -2.97074462e-03  2.45783199e-02
 -1.65409613e-02  4.96084569e-03  7.07841367e-02  2.83755399e-02
 -5.45532070e-02 -2.91672703e-02 -4.64621149e-02 -3.25797196e-03
 -2.05094162e-02  7.06048757e-02  3.86252254e-02  1.01205353e-02
 -8.95927753e-03  6.80870786e-02 -3.76532264e-02 -1.66949797e-02
 -5.54342009e-03  4.84814588e-03  8.42783879e-03  2.64747962e-02
 -3.31540443e-02 -3.46717681e-03 -6.01957738e-02  4.17542495e-02
  4.24765199e-02 -6.96196705e-02 -2.44701430e-02  4.31169756e-02
  2.85453439e-07  2.32409239e-02  1.62084382e-02  7.71160722e-02
  1.11817410e-02  3.20055038e-02  1.72056817e-02  6.70118898e-04
  6.57005981e-02 -5.41634448e-02 -3.09152674e-04  2.85214316e-02
  4.99697588e-02  4.86566015e-02 -2.90108416e-02 -9.50484574e-02
  4.77500912e-03 -6.48478717e-02  3.28287371e-02 -3.76570374e-02
 -2.68946192e-03  5.39495833e-02  1.08223535e-01  1.33691053e-03
  3.22431698e-02  1.73680298e-02 -1.42638199e-02  4.45406996e-02
  2.40781438e-02  3.14412899e-02 -2.02143937e-02 -3.33154364e-03
 -7.34445220e-03 -5.08725718e-02 -1.23003302e-02 -3.01504452e-02
  1.15964506e-02  3.47880572e-02  7.63581768e-02 -7.94207212e-03
 -1.51900770e-02  1.56387482e-02 -8.74074548e-03 -6.47337781e-03
 -2.93140952e-02  3.58216539e-02 -7.03901425e-02 -3.44131626e-02
 -3.03771277e-03  1.68792307e-02  4.14786972e-02  2.07989663e-02
  9.52110626e-03  4.40647782e-05 -1.68299279e-03  3.85319144e-02
 -5.18022552e-02  2.20040791e-02 -9.61771756e-02 -4.41368073e-02
  2.82651070e-03 -2.39359308e-02  3.46905850e-02 -8.85081664e-02
  1.72140822e-03  5.63650057e-02 -9.03803948e-03 -5.57879135e-02
  2.08926902e-34  2.17570607e-02 -2.56889127e-02 -1.52164949e-02
 -1.98402368e-02  7.80632161e-03 -2.96445545e-02 -4.96044122e-02
 -1.40584540e-02  2.50242129e-02 -4.92542535e-02 -5.65193146e-02]"
"Sentences were encoded using byte-pair encoding [3], which has a shared source-
target vocabulary of about 37000 tokens. For English-French, we used the significantly larger WMT
2014 English-French dataset consisting of 36M sentences and split tokens into a 32000 word-piece
vocabulary [38]. Sentence pairs were batched together by approximate sequence length. Each training
batch contained a set of sentence pairs containing approximately 25000 source tokens and 25000
target tokens.
5.2
Hardware and Schedule
 We trained our models on one machine with 8 NVIDIA P100 GPUs. For our base models using
the hyperparameters described throughout the paper, each training step took about 0.4 seconds. We
trained the base models for a total of 100,000 steps or 12 hours. For our big models,(described on the
bottom line of table 3), step time was 1.0 seconds. The big models were trained for 300,000 steps
(3.5 days).
 5.3
Optimizer
We used the Adam optimizer [20] with β1 = 0.9, β2 = 0.98 and ϵ = 10−9. We varied the learning
rate over the course of training, according to the formula:
lrate = d−0.5
model · min(step_num−0.5, step_num · warmup_steps−1.5)
(3)
 This corresponds to increasing the learning rate linearly for the first warmup_steps training steps,
and decreasing it thereafter proportionally to the inverse square root of the step number. We used
warmup_steps = 4000.
5.4
Regularization
We employ three types of regularization during training:
7
","[ 1.59288924e-02  6.93510324e-02  4.57700016e-03  3.85939218e-02
 -4.73594479e-02 -7.65067805e-03 -3.33654322e-03 -2.02669972e-03
 -8.61293003e-02 -6.38390332e-02 -3.78446747e-03 -3.06661204e-02
 -1.40106352e-03  2.98097357e-02  3.65174823e-02 -2.47623213e-02
  5.63655123e-02 -6.79010432e-03 -7.63281435e-03 -8.54335632e-03
  5.98424859e-02  3.96984909e-03  1.37607811e-03  6.90483451e-02
 -4.35749590e-02  7.98708200e-03 -2.58883052e-02  4.86117862e-02
  1.42375985e-03 -2.17867941e-02 -1.26584973e-02  4.28426117e-02
  1.55635672e-02  5.14581017e-02  2.10293138e-06 -4.72343117e-02
 -4.55952957e-02 -5.70834754e-03 -7.41836568e-03  1.77808329e-02
 -4.03409451e-03 -5.53047806e-02 -6.80145621e-03  3.75889502e-02
 -4.69406787e-03 -4.29563262e-02  5.49969487e-02  3.97034995e-02
  4.39963117e-02  9.60393175e-02 -1.67289861e-02 -4.29323651e-02
  3.09633631e-02 -2.37608645e-02 -3.51425074e-02 -4.45886552e-02
  2.30793916e-02 -3.43302116e-02 -3.32571976e-02  2.20859330e-02
 -4.69853431e-02  6.82424754e-03 -6.54923124e-03  2.47688536e-02
  2.76774857e-02  4.44425410e-03 -2.93380450e-02 -3.21717784e-02
 -3.17926295e-02  1.35848196e-02 -4.28926721e-02 -8.04301351e-03
 -3.15795951e-02  3.48141678e-02 -2.72099413e-02 -4.89807613e-02
 -2.55515762e-02  1.14604104e-02  2.92716119e-02  3.55840288e-02
 -1.56981349e-02 -2.67585088e-02  2.31531300e-02 -1.82183851e-02
 -4.82918434e-02  2.26823352e-02  1.92087155e-03 -4.74294201e-02
  1.75019037e-02  1.05985468e-02 -3.47470827e-02 -4.73658144e-02
  3.91357727e-02  1.59041416e-02 -1.40646929e-02  1.83731206e-02
 -4.89547029e-02 -4.27847207e-02  1.15350951e-02 -2.10163668e-02
  2.29120478e-02  3.09993234e-02  1.87620637e-03 -1.49217937e-02
 -5.45895211e-02  8.19848552e-02 -2.99749197e-03  9.83165298e-03
 -5.64824156e-02  1.90003179e-02 -5.29795773e-02  7.74833281e-03
 -9.40812752e-02  4.89401147e-02 -3.67929526e-02 -5.82171120e-02
 -4.43074293e-02 -6.14159666e-02  4.52663526e-02  2.28483696e-03
  2.73497142e-02 -4.18869546e-03 -1.84486602e-02  2.43944209e-02
  1.80726708e-03  1.77941304e-02 -5.70174009e-02  1.21412277e-02
  2.45036241e-02 -6.30304441e-02 -1.37066077e-02 -2.53414549e-03
  2.08216179e-02 -1.31527372e-02  1.24002816e-02  6.93394616e-02
 -4.06099781e-02 -4.53619723e-04 -4.65439670e-02 -2.54608020e-02
  1.29869429e-03 -5.45272678e-02 -3.65494490e-02 -6.26892075e-02
  4.53017838e-02  1.16288690e-02  3.27358954e-02  1.70327909e-02
  2.34431289e-02  1.21379560e-02 -4.23806757e-02  5.49155176e-02
 -2.99562234e-02 -1.21279601e-02 -2.35097541e-04  4.60655708e-03
  3.01021170e-02  1.05489276e-01  3.80283594e-02  2.92036086e-02
  2.21454706e-02 -5.62613481e-04 -3.08622774e-02  6.42817840e-02
  5.63858077e-02  1.30510526e-02 -2.75081396e-02 -4.25881073e-02
  5.57522103e-02  7.83289000e-02  5.07389344e-02  9.50618386e-02
 -5.62818721e-02  4.69910027e-03  4.83342744e-02  6.36408329e-02
  2.07809489e-02  4.60288487e-02  4.58091870e-02  6.53807493e-03
  3.45416889e-02 -4.16972674e-03  1.27524137e-02 -2.74270885e-02
  2.23659500e-02  1.21084508e-03  3.49057540e-02  4.69080992e-02
 -2.25287694e-02 -1.81615520e-02 -6.29024813e-03 -4.37465683e-02
  1.23472977e-02 -2.95656938e-02  3.39955054e-02  7.08131469e-04
 -7.63922408e-02  5.88583834e-02  2.43233554e-02 -4.60570753e-02
 -1.64432786e-02 -2.61035748e-02 -2.11135671e-02  5.89781702e-02
  1.62610170e-02  3.62441167e-02 -4.07070778e-02 -2.39554532e-02
 -3.37155685e-02  5.94619848e-03 -1.93390530e-02  1.86184549e-03
  3.47606763e-02 -7.61952177e-02 -8.10402166e-03 -3.43628298e-03
 -2.08766963e-02  3.74692678e-02 -1.25801913e-03  3.45020108e-02
  1.82492938e-03  2.88513340e-02 -3.16220298e-02  3.67558487e-02
 -2.43070144e-02  1.09117758e-03 -1.10761700e-02  6.80358149e-03
  1.77917015e-02  2.06999853e-02  8.79141688e-03 -1.39132258e-04
  3.61218490e-02 -7.03993961e-02 -5.19078923e-03  1.92442033e-02
 -4.61455956e-02 -4.18257788e-02  5.74743152e-02 -1.04185427e-02
  8.08615014e-02  4.15459573e-02 -2.28212308e-02 -5.10216579e-02
 -6.72115432e-03 -2.34135650e-02  4.69562337e-02 -4.21023834e-03
  3.75767238e-02  1.20466435e-02  3.54238823e-02  6.21432147e-04
  2.10431349e-02 -2.80730445e-02  1.91094689e-02 -2.92222463e-02
 -2.15579309e-02  4.55450416e-02 -3.81266288e-02 -2.42324290e-03
  1.05974600e-02 -5.04967868e-02  1.75854694e-02  2.88620591e-02
  1.48209604e-02 -3.60345207e-02 -3.75247304e-03 -7.34563991e-02
  6.82468060e-03 -1.62848756e-02  1.83351580e-02 -7.09622959e-03
  2.54332530e-03 -1.08348792e-02 -1.38431750e-02 -2.76574027e-02
  3.43641229e-02 -3.43234725e-02 -1.21610714e-02  3.22780747e-04
  4.94277552e-02 -4.17089686e-02 -3.41688953e-02 -1.43283140e-02
  7.21786357e-03  5.50179370e-02 -3.11366636e-02 -1.91696715e-02
 -4.06688750e-02  1.37575269e-02 -3.27270594e-03  2.65031233e-02
  1.69162806e-02 -9.32657495e-02 -9.53000970e-03  4.72759921e-03
  1.19983191e-02  4.56331745e-02  9.19070840e-03  1.62473824e-02
 -2.05185022e-02  1.99799985e-02 -5.51377013e-02  2.72376277e-02
  1.68897666e-03 -4.98091336e-03 -9.08568278e-02 -4.82713319e-02
 -2.96473154e-03  8.89929309e-02 -9.21217073e-03  1.51548963e-02
 -5.57516068e-02  1.64693762e-02 -4.73538414e-03 -6.38078004e-02
 -2.00738646e-02 -9.89760738e-03 -5.96149359e-03  1.22266803e-02
 -1.10234041e-02 -2.09215228e-02  6.09901780e-03 -6.27680644e-02
  7.66636804e-04 -6.05393499e-02 -5.91927266e-04 -8.53979215e-03
  3.35977115e-02  2.24226844e-02  5.00091650e-02 -2.56465767e-02
 -4.71770391e-02 -5.30024106e-03  1.18287001e-02  1.52714299e-02
  4.36476246e-03  1.58215612e-02  4.57900502e-02 -1.16226617e-02
 -3.86940241e-02 -3.87894101e-02 -1.52441701e-02 -9.25464835e-03
 -4.17753942e-02  2.00495659e-03  6.04584441e-02 -3.84494066e-02
 -6.16108701e-02  8.18608887e-03 -2.49929819e-02  3.99514772e-02
 -4.23075072e-02  1.49939489e-03 -3.37288119e-02  3.99606787e-02
  4.98650037e-02 -3.14882578e-04 -4.02029790e-02 -2.28704978e-02
  2.36069821e-02  4.44933139e-02  7.28317425e-02  3.46510066e-03
 -6.90956116e-02 -3.49658467e-02  2.65612900e-02 -3.66308466e-02
 -1.36078466e-02  1.39744561e-02  5.74537739e-02 -2.13480685e-02
 -1.21942097e-02  1.05214894e-01  8.26685596e-03 -4.30881754e-02
  2.15337723e-02  9.20955278e-03  3.16540897e-02  1.90626848e-02
 -7.58341420e-03 -7.69710168e-02 -2.60687359e-02  1.69721916e-02
 -2.98223668e-03 -6.63086865e-03  2.04639174e-02 -2.42968020e-03
 -8.09095204e-02 -2.27288678e-02  3.60192880e-02 -3.54837999e-02
  1.54730240e-02 -2.02842113e-02 -5.65466769e-02 -2.04590410e-02
  2.85922512e-02  5.26350550e-03  9.91372671e-03 -1.05976053e-02
  5.87866195e-02 -2.76018726e-03 -1.27549963e-02 -1.21257529e-02
 -7.35315606e-02  3.03644929e-02  7.69354627e-02  1.66375842e-02
 -5.32520516e-03 -5.22115314e-03  4.78320755e-02  2.65865866e-02
  4.08562683e-02 -3.93181816e-02  4.53811549e-02 -3.88888456e-02
  5.54898288e-03  3.99342179e-02  2.67681922e-03 -3.16246040e-03
  3.19863809e-03  2.14228015e-02  6.79778308e-02  3.01901959e-02
 -1.25752075e-03 -1.60935745e-02  8.45921412e-03 -3.38818715e-03
  4.93279994e-02  3.27578895e-02 -3.71632501e-02 -5.61567657e-02
 -1.96160879e-02  9.34457406e-03 -8.53092149e-02 -8.43391288e-03
 -1.88455370e-03  2.46221554e-02 -3.88247669e-02 -8.30833986e-02
 -2.18249429e-02  3.80138122e-03  6.63870275e-02  6.64119050e-03
  6.02938198e-02 -2.71329377e-02  5.83476201e-02 -3.72934528e-02
  9.40097682e-03  2.15436798e-02 -6.52547227e-03 -6.63379729e-02
 -1.82790328e-02  6.20284025e-03 -2.28383206e-02 -2.67365146e-02
 -1.31423548e-02 -7.57099316e-02 -5.63959926e-02 -2.82791313e-02
  4.03577127e-02  1.93973649e-02  7.71433935e-02  7.34021794e-03
 -5.79822958e-02  2.67520566e-02  3.75335664e-02 -2.74663251e-02
 -1.07960114e-02  6.70027509e-02 -1.66647900e-02 -2.58723702e-02
  2.31241621e-02 -2.38078809e-03  3.29234675e-02  4.59382311e-03
  5.90869561e-02  3.74459568e-03 -1.00262892e-02  3.17572840e-02
  9.55411978e-03  5.17821983e-02 -3.19435149e-02  4.54248441e-03
 -9.12119076e-03  4.44489159e-02 -2.12724041e-03  4.58652116e-02
 -3.78506333e-02  9.32141393e-03  5.30740358e-02  6.17303327e-03
  1.55657204e-02 -7.68054575e-02  3.70823108e-02 -3.30241546e-02
 -2.87263487e-02  3.59766558e-02  6.87359273e-03  3.57663967e-02
  3.53591554e-02  1.58748757e-02 -9.24772397e-03 -1.87594313e-02
  1.41478134e-02 -9.56159458e-03 -8.09519663e-02  1.85239501e-02
  2.13195272e-02  2.67728698e-02 -4.46050689e-02  2.89601162e-02
 -1.18405465e-02  1.50951808e-02 -3.74887399e-02 -9.72449221e-03
  7.63275027e-02 -1.05292667e-02  5.92067838e-02  3.86005244e-03
 -1.12758961e-03 -2.95856912e-02  3.44587564e-02 -5.43940589e-02
  3.93212168e-03  1.27339573e-03 -6.07297663e-03 -1.45335905e-02
 -1.06951445e-02  7.55254030e-02  5.97527716e-03  3.94290723e-02
  3.48280706e-02 -1.99873392e-02 -3.23563367e-02  1.81679502e-02
  1.51231289e-02  4.28536208e-03 -5.02932407e-02 -2.53791735e-02
  3.35933380e-02 -2.64355466e-02  4.40892540e-02 -2.42136642e-02
  2.96591260e-02  7.99152907e-03  3.92108224e-02  6.10595942e-02
 -7.55102746e-03 -1.33375200e-02 -2.23219991e-02  3.76145132e-02
 -1.74327958e-02 -1.89159736e-02  1.78816374e-02 -6.22442699e-33
  1.47674950e-02  3.91104221e-02 -4.10771230e-04 -3.34983543e-02
 -5.11005223e-02  1.35657033e-02  7.65422685e-03 -2.18114927e-02
 -2.32621543e-02 -4.33554314e-03 -1.31183015e-02 -2.59260088e-02
  3.01288236e-02  5.18741608e-02  6.72014663e-03  2.06525973e-03
  6.22628927e-02 -1.28889177e-02 -2.41919677e-03  2.10100617e-02
  2.63720956e-02  9.41831693e-02  4.73005027e-02 -3.58888805e-02
 -5.07836677e-02 -1.91342812e-02 -1.34468768e-02 -1.74106397e-02
  3.58921941e-03  8.74884725e-02 -2.03450248e-02  2.44358424e-02
  7.36002438e-03 -3.64870802e-02 -1.54601634e-02  1.17797498e-03
 -9.63995531e-02 -2.04874133e-03  1.76954642e-02  6.52534664e-02
 -4.55898941e-02 -5.96620180e-02  1.24151893e-02  1.01719024e-02
 -6.83446676e-02  1.32318176e-02 -1.14104140e-03 -3.08934711e-02
 -3.45987864e-02 -3.42756435e-02 -9.31319669e-02 -4.30759229e-03
  1.37761580e-02  4.17281426e-02  5.89316227e-02  5.48391007e-02
 -1.75332408e-02 -3.31893899e-02 -1.46945398e-02 -4.08091675e-03
  2.18529999e-02  7.25593120e-02  2.29967106e-02  2.79489700e-02
  4.98578325e-03  4.01703231e-02  8.40716362e-02 -4.81544398e-02
  3.29890922e-02  5.45192100e-02  7.09762946e-02  5.77126490e-03
  5.33163249e-02  8.23460333e-03  4.11319919e-02 -4.06609699e-02
 -9.12788361e-02 -3.19837257e-02  3.96777727e-02  3.17587592e-02
  3.94196287e-02  4.46766242e-02 -8.96991603e-03 -4.21886565e-03
 -3.46096829e-02 -2.16549281e-02 -1.10138431e-02 -4.76839952e-02
  3.69801372e-02  4.85355407e-02  1.16226298e-03 -2.02974007e-02
  4.47935499e-02 -2.17142552e-02  9.70517285e-03  2.17620675e-02
 -2.26725871e-03  2.05085967e-02 -2.24325210e-02  4.03799899e-02
 -6.31060898e-02 -5.60115501e-02  1.78079586e-02 -1.36388522e-02
  2.75943447e-02 -2.61695236e-02  5.52353188e-02  1.38329789e-02
 -4.52073440e-02 -2.57758726e-03 -3.48267481e-02  2.51788050e-02
 -8.91688373e-03  3.11859045e-02  3.44335660e-02 -2.22411677e-02
 -6.85025891e-03  3.39256153e-02 -2.30993871e-02 -2.83720680e-02
 -9.90247075e-03 -2.13203896e-02  3.60339023e-02  3.12654823e-02
 -2.00256668e-02  1.65460370e-02 -4.84582037e-02 -3.51540409e-02
  2.92987078e-02 -6.74569160e-02 -3.76175679e-02  3.14200670e-02
  2.75298987e-07 -9.36297514e-03  4.84648347e-02  5.13321012e-02
 -2.05146074e-02  3.64812464e-03 -9.51423589e-03 -4.58627418e-02
  2.74227373e-02 -6.84860582e-03  1.82943065e-02  9.76485945e-03
 -2.91392626e-03  4.72015776e-02 -1.96223985e-02 -8.41762498e-02
 -2.36705411e-02 -5.33564426e-02  1.56023782e-02 -5.69990203e-02
  3.80831696e-02  5.03010256e-03  1.35249197e-01 -3.77433449e-02
 -5.91399474e-03  1.73149146e-02 -4.56087552e-02  2.64345407e-02
 -2.11087428e-03  1.98461255e-03  1.47853512e-02 -8.33832193e-03
  2.25996226e-02  2.39297142e-03  8.97927210e-03 -1.93905924e-02
  1.08448481e-02  1.24005256e-02  4.22760770e-02 -3.01769972e-02
 -9.42313205e-03  2.20744032e-02  2.09369045e-02 -2.69595962e-02
 -2.30142549e-02  3.65995280e-02  1.51649676e-02 -2.37899534e-02
 -4.35254425e-02  8.51064175e-03  1.32882576e-02  4.01402265e-03
 -4.17367555e-02  1.67791788e-02  2.08943803e-02  5.05568907e-02
  8.35401472e-03 -2.69771721e-02 -6.80000111e-02  2.68996367e-03
  1.57733751e-03 -2.98199281e-02 -2.91590560e-02 -5.86278252e-02
  4.26124111e-02  1.45852920e-02 -2.60075480e-02 -2.78819688e-02
  2.96821301e-34  2.20122430e-02 -5.86984642e-02  1.23864114e-02
  5.37520424e-02  2.31221560e-02 -4.99773063e-02 -1.03016132e-02
  1.64616797e-02 -2.81190798e-02 -7.03077018e-02 -3.72773744e-02]"
"Table 2: The Transformer achieves better BLEU scores than previous state-of-the-art models on the
English-to-German and English-to-French newstest2014 tests at a fraction of the training cost.
 Model
BLEU
Training Cost (FLOPs)
EN-DE
EN-FR
EN-DE
EN-FR
ByteNet [18]
23.75
Deep-Att + PosUnk [39]
39.2
1.0 · 1020
GNMT + RL [38]
24.6
39.92
2.3 · 1019
1.4 · 1020
ConvS2S [9]
25.16
40.46
9.6 · 1018
1.5 · 1020
MoE [32]
26.03
40.56
2.0 · 1019
1.2 · 1020
Deep-Att + PosUnk Ensemble [39]
40.4
8.0 · 1020
GNMT + RL Ensemble [38]
26.30
41.16
1.8 · 1020
1.1 · 1021
ConvS2S Ensemble [9]
26.36
41.29
7.7 · 1019
1.2 · 1021
Transformer (base model)
27.3
38.1
3.3 · 1018
Transformer (big)
28.4
41.8
2.3 · 1019
Residual Dropout
 We apply dropout [33] to the output of each sub-layer, before it is added to the
sub-layer input and normalized. In addition, we apply dropout to the sums of the embeddings and the
positional encodings in both the encoder and decoder stacks. For the base model, we use a rate of
Pdrop = 0.1.
Label Smoothing
During training, we employed label smoothing of value ϵls = 0.1 [36]. This
hurts perplexity, as the model learns to be more unsure, but improves accuracy and BLEU score.
","[-2.66977325e-02  2.34259805e-03  5.74451033e-03  2.61128508e-02
  8.76077043e-04  5.92443952e-03  4.88547981e-02  1.46289458e-02
 -8.69745687e-02 -1.74601879e-02 -2.09398940e-02 -3.40514258e-02
  2.86915451e-02  4.43669371e-02  9.42330435e-03 -2.03380678e-02
 -2.17361096e-03 -4.97547770e-03 -1.67443696e-02 -4.26981524e-02
  4.43792716e-03 -1.35563510e-02 -6.10192213e-03  2.22609863e-02
 -3.81121365e-03  4.41947579e-02  3.54503305e-03  1.29955076e-02
 -1.80021790e-03 -6.10876828e-03 -3.46712805e-02  3.20114568e-02
  6.36369968e-03  5.38875982e-02  2.25698454e-06 -4.39348184e-02
 -2.49291137e-02  1.54694985e-03 -1.69543754e-02  4.18386720e-02
  2.00114399e-02 -3.49459536e-02 -6.49306402e-02  7.58440932e-03
  2.17701122e-02 -1.76311824e-02  8.28602165e-02  7.19537809e-02
 -2.12921482e-02  3.87891792e-02 -2.02696081e-02 -5.00129014e-02
 -3.35413381e-03  2.88213283e-04 -1.08070169e-02 -4.06133346e-02
 -1.17989210e-02 -2.17528082e-02 -6.23946264e-02 -1.50372982e-02
 -8.19496810e-02  5.86850271e-02  4.99482267e-02 -3.14488523e-02
 -2.18183883e-02  4.54139523e-02  2.05384046e-02 -4.70734723e-02
 -1.28135430e-02  3.20609063e-02 -5.78609332e-02  1.62308700e-02
 -7.82630742e-02  9.10714734e-03 -3.63741554e-02 -3.01918350e-02
 -5.76027930e-02  2.70470604e-02  3.67134064e-02  3.33730993e-03
 -1.85646173e-02  2.98242252e-02  2.41301116e-02 -5.75646274e-02
 -2.01581977e-02  1.36448015e-02  2.12496202e-02 -6.12371415e-02
  2.64091138e-02  4.53329682e-02  2.71086805e-02 -4.03583162e-02
  2.54000556e-02  2.68027245e-04  2.21150201e-02 -4.39273380e-03
  4.22993093e-04 -8.83994438e-03 -4.98301946e-02 -2.01415713e-03
  3.51375416e-02  6.21324703e-02 -6.30863011e-02 -1.48689421e-02
 -4.33318280e-02  7.47016966e-02 -5.71366064e-02  4.16309088e-02
 -2.03538816e-02 -2.60881092e-02  3.11224665e-02  6.88406732e-03
 -1.82706323e-02  9.18737426e-03 -1.38687231e-02 -1.48068340e-02
 -4.53774445e-02 -2.92800702e-02  7.44356913e-03 -3.24699609e-03
  3.63687240e-02 -6.65240281e-04 -9.08835903e-02  2.14087069e-02
 -9.75273270e-03  6.97594732e-02  3.01528983e-02 -9.76575725e-03
  1.14473756e-02 -5.69702946e-02  4.20509093e-03 -1.28250977e-03
  9.98254959e-03 -3.30671594e-02  1.39413336e-02  2.49855462e-02
 -1.06112100e-02  6.50599971e-03  1.35824960e-02  6.91616610e-02
 -3.25387120e-02 -2.96898596e-02  2.71466132e-02 -4.88688983e-02
 -1.15523487e-02 -1.61516725e-03  7.71749020e-03 -9.16461740e-03
  1.79990311e-03  3.12476116e-03  1.15432683e-02  1.95381250e-02
 -2.88550672e-03 -2.85044089e-02  2.66104937e-02  6.45329524e-03
 -1.02813477e-02  9.04995725e-02  2.10775640e-02 -1.06874825e-02
  1.09682214e-02 -5.55181876e-02  3.86236841e-03  6.83917701e-02
 -5.20147092e-04  3.79052274e-02 -3.45999561e-02 -7.93253109e-02
  2.28755902e-02  3.67770419e-02  8.24894980e-02  5.19978218e-02
 -2.80568656e-02 -5.22725545e-02  5.29910475e-02  2.42880881e-02
  8.07657838e-02  1.88440662e-02 -1.23278601e-02 -2.12527122e-02
  1.50815472e-02  4.24186550e-02  3.55404131e-02  5.16440570e-02
 -1.88906230e-02  5.15832193e-03  7.48845749e-03  9.13317651e-02
 -3.80208232e-02 -2.31618397e-02 -8.22272990e-03 -5.73062105e-03
  3.08487881e-02 -2.69666351e-02  4.22535501e-02  3.39889862e-02
 -4.07601595e-02  1.10379837e-01  1.59855671e-02 -7.04216287e-02
  1.60141790e-03 -5.01073226e-02 -1.22657111e-02 -2.87155099e-02
  1.69876963e-02  4.92518879e-02 -6.11116411e-03 -2.90819164e-02
 -3.45957279e-02  8.17810744e-02 -1.18784430e-02  1.81098673e-02
  5.22543974e-02 -6.38931319e-02 -1.21133514e-02 -1.09559773e-02
 -2.56973580e-02  3.12404539e-02 -5.40196449e-02  9.07073822e-03
 -9.34279244e-03 -1.49359535e-02 -3.27206712e-04  6.24462031e-03
 -2.79239956e-02  2.74457913e-02 -9.49861109e-03  2.77370550e-02
  1.46562140e-03  4.26132120e-02 -1.41897099e-02 -2.86323223e-02
  4.35277484e-02 -6.59711063e-02 -2.31913887e-02  1.73807759e-02
 -2.47296151e-02 -3.18239890e-02  2.90942285e-02 -1.23958662e-02
  2.71002594e-02  4.79710437e-02 -6.06524106e-03 -3.33884321e-02
  6.70630112e-03 -2.12122072e-02  4.51289453e-02 -1.30072460e-02
  3.39948870e-02 -3.46950404e-02  2.12156475e-02  8.80539510e-03
  2.29558107e-02 -4.10132557e-02  1.26060238e-02 -1.53668188e-02
  1.31118475e-02  1.97264291e-02 -4.99402732e-02 -3.39032002e-02
  1.13638036e-01 -1.55647146e-02  3.00746155e-03  2.80133281e-02
  8.10287148e-03  1.13436428e-03 -2.31171725e-03 -2.64372844e-02
  7.14990683e-03 -3.37944701e-02  2.96223201e-02  2.14848965e-02
  3.58444825e-02 -7.26644136e-03 -3.03857718e-02 -3.59304100e-02
  5.58081083e-03  4.67487657e-03 -1.39402859e-02  7.66221667e-03
 -4.15102858e-03 -4.30681482e-02  1.53459068e-02 -5.31514734e-02
  3.31884436e-02  4.41743806e-02 -2.75524817e-02 -1.89982187e-02
 -5.61055727e-02  1.62684526e-02  8.30759201e-03  2.01118402e-02
  1.41506437e-02 -1.12899736e-01 -8.50547949e-05  3.72542404e-02
  1.08378166e-02  5.42433560e-02  2.34509408e-02  3.23813595e-02
  2.57058013e-02  4.01736833e-02 -1.38111059e-02 -1.39377057e-03
 -5.99322803e-02 -4.31268252e-02 -7.31924176e-02 -1.07651362e-02
 -4.49042730e-02  7.60457516e-02 -5.02145402e-02  3.47554237e-02
 -5.96119836e-02 -2.49535292e-02 -3.82860703e-03 -4.20416594e-02
  1.63813327e-02 -1.42185278e-02 -1.99453458e-02  4.47570160e-02
 -1.87095744e-03 -7.45063042e-03  8.27701390e-03 -6.11726716e-02
 -2.27872077e-02 -6.73237368e-02  1.75982919e-02 -2.53273286e-02
 -1.12452507e-02 -3.09663787e-02  4.21325155e-02 -1.84018798e-02
 -4.11965027e-02 -3.10219489e-02  4.14057560e-02 -9.58773214e-03
 -1.62063576e-02  3.26339342e-02  3.61493006e-02 -2.30782945e-02
 -2.85338983e-02 -2.92825289e-02 -4.99291811e-03  7.24469200e-02
 -1.58994906e-02 -2.08609384e-02  2.98802704e-02 -1.10827815e-02
 -3.45734879e-02  3.27960104e-02  2.49251574e-02  4.44298461e-02
 -9.72848106e-03  1.27187660e-02 -1.78365633e-02  3.68216969e-02
 -4.29429114e-02  3.19591351e-02  4.34345119e-02 -9.56659671e-03
  3.91113944e-02  2.71301754e-02 -1.35838476e-04  2.30295938e-02
 -5.90936691e-02  1.96062010e-02  7.52690285e-02  4.24727947e-02
 -3.01999915e-02  2.71390714e-02  6.69945776e-02 -5.46414293e-02
 -1.84832085e-02  7.09731355e-02 -4.91247214e-02 -5.00015095e-02
 -2.45436048e-03  2.44601141e-03  5.59497699e-02  8.47545546e-03
  4.44643153e-03 -3.10118608e-02 -1.48362974e-02 -6.19345671e-03
 -5.36051951e-03  2.03351472e-02  5.48350960e-02  2.77391803e-02
 -1.09760217e-01  4.13094088e-02  1.73540711e-02  6.56016450e-03
 -8.76953267e-03 -3.91534194e-02 -3.22088301e-02 -1.29101546e-02
  8.36789310e-02 -1.94628872e-02  2.42879875e-02 -4.37329039e-02
  7.94812664e-02 -3.99855934e-02 -1.16032824e-01  5.62388403e-03
 -3.47709730e-02 -2.49144014e-05  5.40299900e-02 -3.56199848e-03
 -4.30457853e-02 -6.53493404e-02  2.45050043e-02  7.04444200e-03
 -1.14533899e-03 -1.14959842e-02  4.36113700e-02 -1.10537307e-02
 -1.37107782e-02  1.77671034e-02 -1.03879776e-02 -3.45456554e-03
  2.33848933e-02 -5.00452146e-02  7.70206004e-03 -1.18524227e-02
 -2.93567348e-02 -7.79346423e-03  2.21804120e-02 -3.27824652e-02
  3.77189443e-02  9.85360891e-03 -3.89845185e-02  2.00154949e-02
 -3.09262387e-02  3.15243937e-02 -5.77663109e-02 -3.37401181e-02
  9.34196264e-02 -2.01059151e-02 -1.13781244e-01 -2.03292444e-02
  4.56274115e-03 -2.90863868e-02  6.67031407e-02  2.33473908e-02
 -2.68345848e-02 -6.40095398e-03  2.51409914e-02  1.20529104e-02
 -1.49946054e-02  4.07979749e-02  3.21611986e-02 -5.60153052e-02
 -6.74477080e-03  1.02783274e-02 -2.14130655e-02 -2.43152194e-02
 -4.57993820e-02 -5.88976555e-02 -3.72421555e-02  4.84551154e-02
  3.34702246e-02  3.08089647e-02  4.96091247e-02  1.86393112e-02
 -1.85629372e-02  3.34775969e-02  7.37782684e-04  1.71411654e-03
  2.38046646e-02  4.07013185e-02 -1.00507185e-01 -1.57359224e-02
  1.45408036e-02 -2.65596099e-02  4.73311245e-02 -1.12156272e-02
  1.90568324e-02  3.17879096e-02 -2.93259863e-02  3.01946010e-02
 -8.98183137e-03  4.97339740e-02 -3.09647471e-02 -5.23058465e-04
  3.71325092e-04  6.03732094e-02 -3.61541510e-02  3.71015146e-02
 -1.88326109e-02 -3.72505784e-02  5.63957915e-02  3.09363250e-02
  4.36488576e-02  3.36211547e-02  3.07435766e-02 -3.92608978e-02
  3.22283246e-03  7.20145404e-02  1.02178948e-02  9.10819508e-03
  3.50904390e-02  2.20825393e-02 -8.78504664e-03  4.83145472e-04
  3.78146507e-02  1.94842331e-02 -2.24589575e-02  5.04040681e-02
  3.35945189e-02  1.62693933e-02 -3.45796609e-04  3.33986953e-02
 -1.98567361e-02 -1.92299224e-02 -2.70916335e-02 -6.42566681e-02
  3.65448184e-02 -7.19566317e-03  5.32806963e-02 -9.29475855e-03
 -1.03963027e-02  5.82329114e-04 -1.06498003e-02 -3.88235115e-02
  8.75087979e-04  6.18779808e-02 -4.64888513e-02 -3.91992973e-03
  1.64035931e-02  8.52257479e-04  2.25557461e-02  1.15521941e-02
 -3.41876261e-02  3.52161825e-02  1.05159460e-02  1.87987229e-03
  9.00794752e-03  1.34628760e-02 -1.05120242e-02 -1.88813098e-02
 -3.25475410e-02 -3.19182314e-02  2.82009430e-02 -8.75274464e-03
  3.56889926e-02 -3.95395868e-02  3.01056933e-02  4.11714427e-02
  1.59152877e-02 -1.46590099e-02  2.71704476e-02 -4.13653031e-02
 -3.73621210e-02  4.85718437e-03  4.15754430e-02 -6.63225153e-33
 -2.29416061e-02  3.61846201e-02  1.45118581e-02 -2.23574769e-02
 -2.34457683e-02  4.57422435e-02 -2.02096235e-02 -4.91726398e-02
 -1.29489796e-02 -1.50331445e-02 -8.47232435e-03 -1.55084478e-02
  2.55782530e-02  6.80224523e-02 -2.49765944e-02 -1.83417369e-02
  7.11128414e-02  7.03731179e-03 -3.99667174e-02  1.22645125e-03
  1.83329675e-02  3.95146757e-02  7.05704018e-02 -3.70955421e-03
 -6.41099960e-02  2.27874368e-02 -1.82770658e-02 -2.76634563e-02
  1.48786381e-02  5.66421710e-02 -2.13249158e-02  3.03327553e-02
 -4.26776055e-03 -6.21285774e-02 -1.99416503e-02 -1.82948671e-02
 -5.21095097e-02  3.93719785e-02 -7.62121156e-02  6.63263202e-02
 -3.92836295e-02 -7.00190756e-03  2.32166480e-02  2.53626313e-02
 -9.69196036e-02 -4.53299321e-02  7.02711055e-03 -1.77893993e-02
 -5.37242442e-02 -1.53497551e-02 -3.68038975e-02  6.47219317e-03
  2.59027723e-02  1.93346553e-02  4.04156931e-02 -5.66041796e-03
 -1.94318295e-02  1.66439489e-02 -8.37315470e-02  3.60359577e-03
  4.15433720e-02  4.49718572e-02  6.74991608e-02 -1.01970965e-02
 -4.53702081e-03  1.48553438e-02  5.17364927e-02 -1.22308312e-03
  9.05007310e-03 -5.58159873e-02  5.76461442e-02 -4.49468382e-03
  6.14802651e-02  5.06644952e-04  8.43914077e-02 -2.26565264e-02
 -2.24206019e-02  1.74051076e-02 -1.20253526e-02  3.47295664e-02
  1.23653673e-02  5.35735339e-02  4.39763069e-03 -3.28631848e-02
 -1.60225164e-02  2.22135782e-02  2.14009266e-02 -5.38436100e-02
  3.97999100e-02 -2.65003461e-02 -1.20732548e-04 -2.00046469e-02
  5.77433817e-02 -3.01836710e-02  5.21713234e-02 -3.52913812e-02
 -2.90301014e-02  6.59203306e-02 -2.61115059e-02  3.42319184e-03
 -4.71186899e-02 -2.73685902e-02  1.84310209e-02  2.83225738e-02
 -9.07140505e-03  1.82365719e-02  3.03517953e-02  5.57382666e-02
 -2.33218726e-02 -1.10664219e-02 -3.74863446e-02 -1.72803048e-02
  5.45286909e-02  4.00328003e-02  2.20595449e-02 -1.79446861e-02
 -3.04931169e-03  1.90010183e-02 -1.01891942e-02  5.84409991e-03
 -1.70203857e-02 -1.92406066e-02  5.60976751e-02  4.18808572e-02
 -6.53855354e-02  5.90206450e-03 -5.71815223e-02  4.94918507e-03
  4.59955819e-02 -5.24338186e-02 -5.78492768e-02  4.23703641e-02
  2.84959441e-07  2.46970356e-02  3.17768492e-02  4.66576666e-02
 -1.29395751e-02 -5.52752288e-04  1.85002983e-02 -2.23085657e-02
  9.79721360e-03  5.71611449e-02 -2.13668458e-02 -2.02990677e-02
  9.73743573e-03  3.99302542e-02  1.45896489e-03 -2.47196723e-02
 -7.72458017e-02 -4.14399169e-02  2.87219994e-02 -1.73397399e-02
  4.19491157e-03 -1.12780528e-02  1.03538141e-01 -3.45894396e-02
 -4.26496714e-02  2.47276742e-02  1.80574749e-02  2.39005350e-02
  5.47828560e-04  1.80217065e-02 -2.72838250e-02  2.92449854e-02
  5.27630970e-02  6.76606200e-04  4.54725400e-02 -2.95699257e-02
  1.24150505e-02  4.83863130e-02 -1.25736343e-02 -3.93105820e-02
 -9.84703656e-03  9.52254049e-03  5.44729196e-02 -2.99488679e-02
 -5.01891486e-02  2.08340399e-02 -2.87860748e-03 -5.00631034e-02
 -4.73158918e-02 -5.55179827e-02 -1.32209500e-02 -1.21028181e-02
 -3.83212641e-02 -1.24512073e-02 -4.60059289e-03  7.56061450e-03
  1.42574739e-02 -2.75954567e-02 -4.50371988e-02  1.91906895e-02
  8.39676056e-03 -2.03683320e-02 -3.88048664e-02 -4.55466807e-02
  1.10877668e-02  2.62583252e-02 -1.28366621e-02 -3.82751450e-02
  3.11003341e-34  1.66192520e-02 -8.10725708e-03  3.96341905e-02
  2.67301407e-02 -2.04973877e-03 -6.37290627e-02  5.45772016e-02
 -1.83528382e-02 -7.35275224e-02 -4.72769402e-02 -4.49424312e-02]"
"6
Results
6.1
Machine Translation
On the WMT 2014 English-to-German translation task, the big transformer model (Transformer (big)
in Table 2) outperforms the best previously reported models (including ensembles) by more than 2.0
BLEU, establishing a new state-of-the-art BLEU score of 28.4. The configuration of this model is
listed in the bottom line of Table 3. Training took 3.5 days on 8 P100 GPUs. Even our base model
surpasses all previously published models and ensembles, at a fraction of the training cost of any of
the competitive models.
 On the WMT 2014 English-to-French translation task, our big model achieves a BLEU score of 41.0,
outperforming all of the previously published single models, at less than 1/4 the training cost of the
previous state-of-the-art model. The Transformer (big) model trained for English-to-French used
dropout rate Pdrop = 0.1, instead of 0.3.
 For the base models, we used a single model obtained by averaging the last 5 checkpoints, which
were written at 10-minute intervals. For the big models, we averaged the last 20 checkpoints. We
used beam search with a beam size of 4 and length penalty α = 0.6 [38]. These hyperparameters
were chosen after experimentation on the development set. We set the maximum output length during
inference to input length + 50, but terminate early when possible [38].
 Table 2 summarizes our results and compares our translation quality and training costs to other model
architectures from the literature.","[ 2.64390595e-02  2.46613715e-02 -2.96813960e-04  6.94149453e-03
 -3.11395898e-02  7.84305297e-03  6.96455538e-02 -3.36870900e-03
 -5.25844991e-02 -1.85643379e-02 -4.33188714e-02 -6.00828044e-02
  4.13583517e-02  1.36224851e-02  2.95173936e-02 -5.13445698e-02
  2.17634719e-02 -8.78226850e-03 -3.17205526e-02 -5.60176373e-03
 -8.43742024e-03  6.64183265e-03 -1.35800894e-02  4.59898375e-02
 -6.29459694e-03  3.43118683e-02  9.31361038e-03  5.89316301e-02
  4.56437357e-02 -3.15778479e-02 -4.72025387e-02  3.11995130e-02
  1.72117748e-03  7.07341582e-02  2.26967222e-06 -5.31690754e-02
 -4.20003049e-02  2.78811879e-03  5.03373798e-03 -1.57386400e-02
  5.00307307e-02 -7.73580819e-02 -1.19642746e-02  2.70541701e-02
 -1.33235957e-02 -2.81495433e-02  8.02248418e-02  3.92051041e-02
 -8.42968933e-03  9.14280117e-02 -2.02334095e-02 -4.51130420e-02
  8.31831887e-04 -3.88573371e-02  1.38210543e-02 -5.91802485e-02
 -1.15941754e-02 -3.32060046e-02 -4.84798364e-02  1.73029378e-02
 -4.20548655e-02  7.09015876e-02  9.12248623e-03  6.27319608e-03
 -8.68001208e-03  1.25921778e-02 -6.32758252e-03 -4.97310832e-02
 -2.63764579e-02  3.11587434e-02 -9.65435430e-03 -1.29914293e-02
 -2.90419646e-02  1.65174529e-03 -2.74268538e-02 -3.66448537e-02
 -5.25711663e-02  3.21554095e-02  1.77126173e-02 -2.60649845e-02
  2.38861647e-02  4.80128303e-02  3.54287736e-02 -3.90682779e-02
 -4.87144142e-02 -2.49859095e-02  4.59086038e-02 -4.02911529e-02
  1.13121914e-02  1.63019747e-02 -1.41313896e-02 -3.42349336e-03
  4.35452946e-02 -5.51365502e-03 -1.04158539e-02  1.79714933e-02
 -2.67955810e-02 -3.19855139e-02 -1.76942088e-02 -8.46884120e-03
  1.93166099e-02  6.83694556e-02  1.21145323e-02  2.10887305e-02
 -1.61503572e-02  7.48234615e-02 -4.12993059e-02 -2.58580316e-02
 -1.02882013e-01 -1.82139035e-02 -2.98403166e-02  3.43359523e-02
 -4.59098369e-02 -4.36111987e-02 -4.53305021e-02 -2.41889451e-02
 -5.65215014e-02 -2.97196321e-02  4.63988930e-02 -3.23585570e-02
  5.77732064e-02 -1.78453363e-02 -9.36291739e-02  1.53562855e-02
  1.16601419e-02  9.04393569e-02  2.79983622e-03 -2.79316939e-02
  7.47038983e-03 -7.17890859e-02 -1.44751100e-02  2.12866049e-02
 -1.56385694e-02 -5.40814437e-02  6.38721418e-03  8.77943113e-02
 -2.39617508e-02 -3.88702527e-02  1.94468945e-02  2.56073847e-02
 -3.21683139e-02 -7.46151581e-02  2.23779865e-02 -7.33331367e-02
  6.02902658e-02  2.69367006e-02  3.29425782e-02  9.88876726e-03
  2.76202597e-02 -1.94770414e-02  8.30169022e-03  3.58095132e-02
  4.81585460e-03 -1.37929721e-02  6.41618520e-02 -1.27605943e-03
 -3.76232713e-02  6.42814264e-02  2.38827206e-02  2.66684461e-02
 -5.62245477e-05 -1.66712254e-02 -1.29694594e-02  6.36539459e-02
 -1.60614867e-02  2.69644875e-02 -1.08030848e-02 -3.70591767e-02
  1.84103251e-02  7.44240880e-02  3.52356173e-02  5.18580452e-02
 -2.21461281e-02  1.95271689e-02  7.61978328e-02  4.61004563e-02
  5.41319288e-02  3.85660678e-02  1.91242769e-02 -4.22134064e-03
 -1.62849948e-02 -1.36920353e-02  2.91356992e-04  4.09552455e-02
 -5.55329435e-02 -1.28532639e-02  1.42013198e-02  4.86193486e-02
 -1.12060485e-02 -2.73144990e-02 -9.09934472e-03  9.76154814e-04
  2.46986318e-02 -2.75491271e-02  4.68230769e-02 -2.77231738e-04
 -5.42484149e-02  7.53756687e-02  7.38038728e-03 -4.83049862e-02
 -1.95084121e-02 -1.17537575e-02 -1.40123218e-02  3.09579261e-02
  5.76529726e-02  2.64756158e-02 -1.17536010e-02 -2.52311472e-02
  8.10819399e-03  7.18206540e-02  5.65691479e-02  5.01329154e-02
  4.29272316e-02 -6.86192513e-02 -1.50790839e-02  2.47346386e-02
 -1.42192999e-02  3.61656747e-03 -8.31611548e-03  3.71902846e-02
  2.73201223e-02 -8.68590549e-03 -7.30791017e-02  3.37442979e-02
 -3.12562957e-02 -9.65255592e-03 -4.60769836e-04  8.48819409e-03
 -3.26557201e-04 -7.79455574e-03 -1.75290983e-02 -1.81800360e-03
  1.91192236e-02 -6.77958354e-02  1.07946079e-02  4.54959646e-02
 -2.99707297e-02 -2.81396694e-02  1.53325181e-02 -4.22916897e-02
  2.25836728e-02  1.03552248e-02 -4.55208030e-03 -3.85896713e-02
 -1.64685436e-02 -6.23516515e-02  2.22085300e-03 -1.31090591e-02
  5.43664172e-02  4.24524769e-04 -3.26559599e-03 -4.02627029e-02
  3.74709778e-02 -3.03570391e-03  1.70854647e-02 -2.09028739e-02
 -3.88860032e-02  2.41494421e-02 -4.37661260e-02 -2.53919959e-02
  5.53184859e-02  3.65387462e-03  5.93861053e-03  4.46171090e-02
  1.30988667e-02 -1.00617688e-02 -1.93995163e-02 -5.25942929e-02
  3.99554931e-02 -5.58269862e-03  1.78354438e-02  4.55482192e-02
  4.72798459e-02 -2.93642725e-03  4.67179489e-04 -1.37233026e-02
  1.72571838e-02  7.71276467e-03  7.26837025e-04 -1.89185664e-02
  6.68965280e-03  1.31459180e-02 -2.51230840e-02 -3.51296254e-02
  3.54020786e-03  4.13839221e-02  2.03914866e-02 -3.80980112e-02
 -5.09954095e-02  7.02395067e-02 -2.74965838e-02 -3.53259058e-03
  2.44834065e-03 -8.41986164e-02  1.86401866e-02 -1.78303700e-02
  6.96128905e-02  6.04369529e-02  4.06807736e-02 -2.06153112e-04
  2.03080326e-02 -4.96449927e-03 -3.23663093e-02 -1.90744922e-03
 -3.46626379e-02 -3.00235376e-02 -4.61871997e-02 -5.38734868e-02
  1.68055166e-02  3.26360315e-02  1.54933790e-02  3.18149105e-02
 -5.53702302e-02 -2.13015191e-02 -2.61313934e-02 -3.19002531e-02
 -2.99420615e-04  3.19979861e-02  2.44095759e-03  3.50247361e-02
 -1.06020272e-02 -3.09028197e-02  3.28768529e-02 -4.23426144e-02
  3.69165489e-03 -7.73593113e-02 -2.90885218e-03 -6.04781695e-03
  4.25894186e-02 -1.30908024e-02  3.83080021e-02 -4.04903814e-02
 -1.13225272e-02 -1.25555526e-02  1.45164365e-02  1.47102857e-02
 -1.51054496e-02  2.77116522e-02 -2.03600470e-02 -1.53143052e-02
 -3.24815474e-02 -1.94782857e-02 -8.35646875e-03  2.65775695e-02
 -1.89283956e-02 -3.93547975e-02  2.74773240e-02 -1.81803349e-02
 -9.13430303e-02  1.83759201e-02  3.71746942e-02  8.40644017e-02
 -3.60710397e-02 -1.00119300e-02 -2.43469700e-02  1.92937199e-02
  5.77129936e-03  2.73490455e-02  3.94081287e-02 -8.01323354e-02
  1.29843587e-02  2.00734064e-02  1.44730946e-02 -2.13969816e-02
 -6.40830249e-02 -4.21269052e-02  4.17383239e-02  1.76900276e-03
 -5.20276204e-02 -1.47228306e-02  8.47602785e-02 -5.93978576e-02
 -2.40277825e-03  1.16605274e-01  4.09628358e-03 -3.63073945e-02
 -1.68554317e-02 -8.52646597e-04  2.69472022e-02  3.18159466e-03
  2.37066578e-02 -5.61954118e-02 -2.52039060e-02 -4.84055793e-03
  3.06864735e-02  1.64448824e-02  5.36929555e-02 -2.25383812e-03
 -7.54823089e-02  3.40383798e-02  5.96567057e-02 -1.50435781e-02
 -1.95723493e-02 -1.17423646e-02 -4.80226688e-02 -4.89841029e-02
 -7.68982526e-03 -1.82821555e-03  7.29767093e-03 -5.41598443e-03
  1.22016305e-02  1.61895156e-02 -6.23702817e-02  1.98894311e-02
 -7.20751807e-02  1.92579366e-02  6.33793920e-02  3.38164903e-02
 -1.43148545e-02 -5.63897155e-02  4.21644654e-03 -1.06990419e-03
  4.37836945e-02 -2.94847414e-02  3.14508453e-02  3.73662193e-03
 -9.38414037e-03 -1.04740942e-02 -4.43358580e-03  4.75235254e-04
 -3.15160403e-04  1.92480218e-02  4.07619812e-02 -5.09146973e-02
 -7.32783321e-03  3.23204882e-02  1.80043448e-02 -3.84054007e-03
  5.04947379e-02 -2.83806905e-04 -5.32538891e-02 -6.53859368e-03
 -1.34000089e-02 -2.85138143e-03 -9.19584259e-02 -1.44424317e-02
  4.47093276e-03 -3.37968580e-02 -4.14052829e-02 -7.28103444e-02
 -1.33998161e-02  4.78808815e-03  9.01818573e-02  2.89897341e-02
  3.98963271e-03 -2.38688923e-02  6.53938763e-03 -3.29259746e-02
  5.66254593e-02  7.29513646e-04  2.80622803e-02 -5.32290824e-02
  1.59371104e-02  4.82391287e-03 -4.51491959e-02  5.52344369e-03
  6.24401495e-02 -8.91527161e-02 -5.24422377e-02 -6.78817695e-03
  6.54407442e-02  2.91073564e-02  8.24114773e-03  2.27980711e-03
 -1.28890537e-02  2.19467152e-02 -1.12882107e-02 -2.58713644e-02
  2.19001658e-02  1.52669214e-02 -5.17110340e-02 -2.18173582e-02
  1.71988476e-02  1.27655622e-02  2.23723222e-02  2.01427229e-02
  6.17617220e-02  7.29367230e-03 -3.28666940e-02  2.02995799e-02
  1.34601062e-02  4.68712822e-02 -3.48626338e-02 -3.08903307e-02
 -3.77293192e-02  3.20774801e-02 -1.13630285e-02  3.27811241e-02
 -2.89279409e-02 -8.96032341e-03  6.41384274e-02  3.93323898e-02
  1.58101469e-02 -8.15903861e-03 -8.21407768e-04 -5.41999564e-02
 -4.56126034e-02  5.14157340e-02 -1.96691062e-02  1.24361962e-02
  2.28931662e-02  3.13795693e-02 -9.43463016e-03  1.68305691e-02
  8.52066465e-03  1.22817056e-02 -2.27121376e-02  6.90438822e-02
  2.19907835e-02  4.62168679e-02  1.42956025e-03  3.90990861e-02
 -4.46190573e-02 -4.21434594e-03 -1.45590706e-02 -2.45799255e-02
  5.40753081e-02 -1.15799892e-04  1.17627762e-01 -8.23046360e-03
 -1.16409361e-02 -4.52071987e-02  3.24326679e-02 -3.20164301e-02
  1.10048307e-02  7.98696373e-03 -1.97614580e-02  7.42581487e-03
  1.13061967e-03  2.88682543e-02 -3.12712342e-02  2.21900586e-02
  1.27980709e-02  3.03702615e-03 -3.93408909e-02 -6.78473897e-03
 -1.16902718e-03 -3.67705226e-02 -3.37848589e-02 -2.41322257e-02
 -3.73115879e-03 -1.28583871e-02  3.12962085e-02 -2.37745303e-03
 -4.08103457e-03 -3.18636745e-02  1.81755293e-02  6.53876960e-02
 -3.81363668e-02 -2.15075035e-02 -2.16602478e-02  2.56376863e-02
 -2.11470556e-02 -7.74977030e-03 -2.27749106e-02 -6.55360802e-33
 -3.14049125e-02  1.94846839e-02  3.34877074e-02 -2.61038318e-02
 -5.51520213e-02  1.17602581e-02 -3.63314860e-02 -1.79122575e-02
 -1.03210500e-02 -5.26475022e-03  1.68932322e-02 -1.36623075e-02
  3.36133651e-02  6.88880542e-03  1.60274263e-02  4.12885658e-02
  5.12246341e-02  1.29581597e-02 -4.89389114e-02  5.02863387e-03
  4.62133028e-02  6.22945800e-02  9.69905332e-02 -2.60202792e-02
 -3.20405811e-02 -7.85586704e-03 -2.06001960e-02 -1.11787273e-02
 -1.17140785e-02  2.75310241e-02  2.91877869e-03  1.19388895e-02
 -5.15311817e-03 -4.56107743e-02 -2.86517534e-02 -3.27343307e-02
 -7.31509998e-02  1.95482466e-02  5.27062453e-03  5.27248383e-02
 -2.75729634e-02 -5.26045375e-02  3.01302113e-02 -2.91765723e-02
 -5.30527309e-02 -2.44360082e-02  3.50666023e-03 -6.21246882e-02
 -5.17527498e-02 -1.58007815e-02 -8.52131248e-02  6.31626369e-03
  3.38556548e-03  1.32474340e-02  1.67261213e-02  6.59270138e-02
 -4.14590985e-02 -9.97536909e-03 -9.04301256e-02  1.73773244e-02
  1.79961491e-02  7.35573620e-02  5.22905812e-02 -9.73364525e-03
  4.20267275e-03  1.47751160e-02  4.48243506e-02 -2.15884596e-02
  4.34558913e-02 -2.09015422e-02  5.61555363e-02 -1.83423795e-02
  8.27549770e-02  2.57044993e-02  4.49770056e-02 -2.12386828e-02
 -2.69161351e-02  2.33974569e-02 -2.69006100e-03  3.64043452e-02
  3.33534703e-02  3.55243906e-02 -7.61823962e-03  1.40437139e-02
 -2.38613691e-02  5.22504153e-04 -4.79162531e-03 -3.33870314e-02
  2.44657416e-02  2.56157760e-02  4.55245515e-03 -8.57573561e-03
  1.07614309e-01  3.09901452e-03  8.52806494e-02 -1.81628559e-02
 -9.85666644e-03  1.78561714e-02 -4.82995436e-02  3.23523730e-02
 -4.08340469e-02 -3.73390615e-02  4.48058806e-02  4.17817831e-02
  8.36157333e-03 -1.86618418e-02  1.17355650e-02  3.70652042e-02
 -4.48163673e-02 -4.65216069e-03 -4.96139489e-02 -6.97380304e-03
  1.20250916e-03  5.47221042e-02  2.35866010e-02 -2.08858922e-02
  1.51598477e-03  9.49419569e-03  6.64277514e-03 -2.18737628e-02
 -3.68236862e-02  6.23572106e-03  4.16824184e-02  4.44032811e-02
 -7.48299360e-02  3.67927812e-02 -3.23068611e-02 -4.83608618e-03
  3.81176770e-02 -5.68355285e-02 -4.81900834e-02  4.06225212e-02
  2.98867434e-07  5.55697121e-02  6.24591671e-02  1.76132880e-02
  3.68802920e-02 -1.38009563e-02 -5.03522460e-04 -3.13317887e-02
  1.03134401e-02  3.30411419e-02  3.32468934e-02  3.04759722e-02
  2.36649644e-02  9.34073031e-02  8.31688568e-03 -5.43919243e-02
 -3.73322628e-02 -4.26033065e-02  3.49980220e-02 -4.90957573e-02
 -1.38095012e-02  3.20961140e-02  1.14086419e-01 -2.64209639e-02
 -1.91740375e-02 -3.39734508e-03 -1.26730185e-04  7.34943748e-02
 -1.60045195e-02 -2.10266262e-02 -1.58231370e-02  1.71513669e-02
  2.02679951e-02 -4.83491272e-02  3.14337946e-02 -2.93424372e-02
 -5.92524325e-03  3.88815142e-02  3.30490768e-02 -2.60731410e-02
 -1.93088353e-02  5.24392910e-02  2.94685401e-02 -3.30069587e-02
 -3.93261276e-02  1.27178039e-02 -2.24328563e-02 -8.52440204e-03
  1.25624379e-02 -2.40229573e-02  1.61821656e-02  3.71876769e-02
 -5.31184673e-02  1.29248039e-03  5.28603466e-03  4.50332686e-02
  1.37429107e-02 -2.95460261e-02 -2.03061439e-02 -7.58204423e-03
 -2.28599142e-02 -1.92015804e-02 -3.79267000e-02 -5.14036566e-02
  2.22522463e-03 -2.16575665e-03 -2.94086169e-02 -3.86506915e-02
  2.95545522e-34  4.58390787e-02 -2.37394348e-02  1.31955231e-02
 -1.59057397e-02  3.64853702e-02 -3.57776769e-02 -2.29746476e-02
 -1.17308786e-02 -4.47975807e-02 -7.41685778e-02 -4.75988388e-02]"
"We estimate the number of floating point operations used to train a
model by multiplying the training time, the number of GPUs used, and an estimate of the sustained
single-precision floating-point capacity of each GPU 5.
6.2
Model Variations
To evaluate the importance of different components of the Transformer, we varied our base model
in different ways, measuring the change in performance on English-to-German translation on the
5We used values of 2.8, 3.7, 6.0 and 9.5 TFLOPS for K80, K40, M40 and P100, respectively.
 8
","[-1.93396453e-02 -3.28882113e-02 -2.29758564e-02  3.97545546e-02
  3.88099696e-03  9.99426004e-03  5.75036258e-02  1.29444627e-02
 -6.96834177e-02 -2.71911249e-02 -7.45425234e-03 -5.88218197e-02
  8.12966153e-02  1.44223112e-03  2.50892676e-02 -6.61380515e-02
  4.71578874e-02 -6.20360905e-03 -7.13569745e-02 -2.87139639e-02
 -1.73501056e-02 -4.84675616e-02  1.32721318e-02  2.57229302e-02
 -1.10056950e-02  5.80409251e-04  7.80824199e-03 -1.93420909e-02
  1.92280058e-02  8.75434745e-03 -1.95984188e-02  1.43961143e-02
  1.68780256e-02  4.68578935e-02  2.11449651e-06  4.28287406e-03
 -3.07075772e-02  3.42654549e-02  3.67126544e-03  4.62938435e-02
  7.86488727e-02 -3.85292098e-02 -3.97585817e-02  2.42145397e-02
  2.51713418e-03 -2.09850795e-03  4.21065278e-02  1.70621574e-02
 -2.82894932e-02  2.56972946e-02 -1.49350020e-03 -3.89890000e-02
  9.40238964e-03  6.18456164e-03 -2.47676056e-02 -4.16343361e-02
 -5.46336584e-02  2.64641512e-02 -2.85018552e-02 -1.04291532e-02
 -4.08126339e-02  3.80747542e-02  2.14256495e-02  2.18514679e-03
 -5.53710461e-02  2.35663410e-02 -1.33247348e-02 -3.23574543e-02
 -1.72009785e-02  8.50644254e-04 -5.07776737e-02 -4.97861765e-03
 -3.43696997e-02 -3.34607949e-03 -5.25895767e-02 -3.03132888e-02
 -3.23589109e-02  3.87744159e-02 -1.17206313e-02 -4.16436344e-02
  2.79319938e-02 -1.23832736e-03  8.83481558e-03 -2.90281530e-02
 -2.67502982e-02  5.71514815e-02  2.02284493e-02 -8.18230957e-03
  1.24447662e-02  4.92281094e-02 -7.27088451e-02 -2.88991891e-02
  2.81523447e-02 -7.20567489e-03 -2.24927347e-02  1.28859794e-02
 -5.65431081e-02 -5.18816076e-02  4.12102463e-03 -8.73459950e-02
  5.91363832e-02  7.67856911e-02  4.59737983e-03  4.50185174e-03
 -3.78876738e-02  8.24406445e-02 -5.78042008e-02 -8.04788060e-03
 -5.66119403e-02  1.80644225e-02  3.26655284e-02 -4.26111929e-03
 -1.64347794e-02 -6.02478301e-03 -5.26578501e-02 -3.31598260e-02
 -3.72801423e-02 -6.66074175e-03  2.79925559e-02 -1.12220421e-02
  2.64121741e-02  7.27714784e-03 -6.46805987e-02  3.35102417e-02
 -1.49257248e-02  8.33695978e-02 -1.86110996e-02 -3.36841159e-02
 -8.10105260e-03 -6.65592924e-02  1.43374112e-02 -2.36405265e-02
 -1.53100127e-02 -1.98453553e-02  2.55063344e-02 -2.56434036e-03
  1.76375676e-02 -4.82087163e-03 -4.48406674e-03  3.12635838e-03
 -4.73038107e-03 -3.80203873e-02  2.78813881e-03 -4.29949351e-02
 -5.72028942e-03  5.75739183e-02  3.74111831e-02  3.27502117e-02
  1.71719324e-02  3.86981629e-02  2.76692491e-02  1.46449199e-02
 -1.33211473e-02 -1.85186043e-02  4.07732651e-02 -2.19890978e-02
 -1.04861064e-02  7.55255148e-02  3.35365385e-02 -2.94810720e-03
  6.11607358e-03 -3.74773107e-02 -2.21900307e-02  2.28968989e-02
 -9.06153768e-03  1.15955919e-02 -1.82262789e-02 -3.57568152e-02
  1.68085936e-02  3.67871448e-02  2.56948974e-02  4.25423570e-02
 -3.10286451e-02 -4.33649383e-02  4.73168939e-02  2.97175143e-02
  2.00340040e-02  6.08485043e-02  3.58042270e-02 -3.63922566e-02
  2.65505183e-02 -2.37291697e-02 -1.82697270e-02  2.74273138e-02
  1.48201147e-02  2.93339416e-02  2.09653787e-02  5.95079772e-02
 -1.96320773e-03 -3.00403964e-02 -1.29826134e-02 -1.77003480e-02
  5.26652532e-03 -4.75830361e-02  2.31831279e-02  1.18951546e-02
 -6.36979565e-02  9.55679119e-02  4.45445243e-04 -7.99858496e-02
 -5.29424474e-02 -4.04142067e-02 -2.40228418e-03  1.14137940e-02
  4.50701825e-02  3.52911688e-02 -1.47316530e-02 -2.48832852e-02
 -3.48178409e-02  5.46392240e-02  7.25189894e-02  3.18724252e-02
  2.87729464e-02 -2.11606026e-02  2.52631237e-03 -2.04961421e-03
 -1.02322642e-02  1.08559495e-02  7.54176592e-03 -5.19201672e-03
  1.36776210e-03 -3.94198708e-02 -3.00691202e-02  6.08491991e-03
 -1.46055198e-03  7.25653535e-03  3.03789577e-03 -6.01572171e-03
 -4.90747020e-02  1.07920971e-02  1.16173718e-02 -3.30422670e-02
  3.01716961e-02 -1.48895597e-02  2.99326587e-03  5.87037113e-03
 -5.33207245e-02  9.95080918e-02  6.95148110e-02  4.26991694e-02
  5.34654073e-02  8.67515709e-03  3.61469411e-03 -2.08251122e-02
 -6.53548492e-03 -4.51985262e-02  2.77780686e-02  2.15766896e-02
  4.47767526e-02 -2.55206134e-02  3.68008837e-02  7.17841135e-03
  4.38598692e-02 -1.18555566e-02  3.88363302e-02 -1.20533165e-02
  1.27994623e-02  3.31295244e-02 -3.37748900e-02 -4.26330082e-02
 -5.28628379e-03 -1.12876631e-02 -2.26996606e-03  3.38929929e-02
 -2.90300604e-02 -3.98111157e-03  3.28962468e-02 -7.88776055e-02
 -8.26166105e-03 -1.95854176e-02  3.21259275e-02  5.54229617e-02
  1.07219461e-02  2.57842317e-02 -5.87627152e-03 -1.66586891e-03
 -5.30123152e-03  8.03189538e-03  1.86393224e-02 -7.90864881e-03
  4.93597565e-03  5.70391817e-03 -1.40092953e-03 -3.45105231e-02
  7.69925490e-03  9.22986567e-02  3.86867300e-02 -8.92258307e-04
 -4.94214818e-02  5.25706895e-02  1.09906271e-02  3.39175537e-02
  2.06352696e-02 -5.22763915e-02  9.69376974e-03  3.62483673e-02
  4.41818461e-02  5.81575520e-02  1.17255021e-02 -3.38459248e-03
  2.10044831e-02  9.41097923e-03 -4.64890115e-02  8.53348244e-03
 -2.26582866e-02 -5.66602238e-02 -2.26216335e-02 -3.16161127e-03
 -4.14386541e-02  9.87377688e-02 -4.47931439e-02  3.37851308e-02
 -3.59274149e-02 -4.58893515e-02 -2.62925588e-02 -1.46159036e-02
  6.36311099e-02  3.62717994e-02  2.45898459e-02  1.18264314e-02
  5.04370965e-03 -4.63309065e-02 -8.39778502e-03 -5.57570420e-02
 -6.64648786e-03 -4.20754105e-02  2.63798758e-02  2.53508091e-02
 -3.29163764e-03  9.82897263e-03  3.91707420e-02 -6.84260428e-02
  1.45609519e-02  1.33019956e-02  3.72980386e-02  1.33232735e-02
 -2.21104454e-02  7.55085945e-02 -4.32759011e-03 -1.29986443e-02
 -7.21403062e-02 -3.40517238e-02  4.11905115e-03  5.74375540e-02
 -2.30980795e-02  4.74803383e-03  2.46733632e-02 -6.23721145e-02
 -3.56433168e-02  8.13939236e-03  6.84619918e-02  7.47434646e-02
 -4.42134626e-02 -5.97193465e-02 -1.91833498e-03 -1.79660264e-02
 -2.64261495e-02  2.36503780e-02  2.29325816e-02 -3.62752527e-02
 -1.00622997e-02  2.28911098e-02  3.02554406e-02  1.14603657e-02
 -1.08639501e-01 -4.18565460e-02  3.05013079e-02  3.75186000e-03
 -3.08885016e-02  3.05042192e-02  1.40615683e-02 -5.56208938e-02
 -6.30595023e-03  3.03197782e-02  1.64675084e-03 -1.17651960e-02
  9.49966314e-04  1.26644559e-02  1.86461359e-02  1.55927120e-02
  6.31066188e-02 -6.19422458e-02  2.62345038e-02  1.45030934e-02
  3.77772897e-02 -4.72614355e-02  1.57838035e-02  1.17076356e-02
 -9.54426080e-02 -9.13974829e-04 -1.23085612e-02 -2.34356131e-02
 -6.03169389e-02 -4.24503684e-02 -1.88108217e-02 -2.44650580e-02
  4.29725498e-02 -1.20951813e-02  1.33807603e-02  4.96481592e-03
  3.28004844e-02 -3.49167176e-02 -2.66471263e-02 -1.72633976e-02
 -2.10300516e-02 -2.71882750e-02  3.74721512e-02 -6.47085626e-03
 -2.64422260e-02 -8.02668929e-02  1.51043886e-03  5.45070693e-02
  2.83832457e-02 -4.80425507e-02  4.59878556e-02  3.08148209e-02
 -8.65091197e-03 -2.14125169e-03 -3.13521214e-02 -5.53833507e-03
  2.30840296e-02 -5.45714200e-02  3.53539996e-02 -2.17896365e-02
  8.08177330e-03  5.03444448e-02 -8.30813125e-03 -4.45158444e-02
 -5.41285984e-03 -2.50352584e-02 -4.64380607e-02 -3.04931346e-02
 -8.76347423e-02  4.52494174e-02 -3.91193479e-02 -3.94046456e-02
 -9.32887010e-03  3.66542339e-02 -5.53032197e-02 -3.25646512e-02
  2.18292847e-02 -5.26187308e-02  5.03962897e-02  3.18039320e-02
 -4.96020466e-02  7.86836352e-03  2.06718873e-02 -4.23287190e-02
  2.34755129e-02  1.18906703e-03  7.09236935e-02 -1.06022298e-01
  1.47252101e-02  2.79034153e-02 -2.27972940e-02 -2.14759354e-02
  3.69769931e-02 -9.11917761e-02 -3.74643244e-02  6.81103021e-02
  8.24636966e-02  2.66763773e-02 -1.32014835e-03  2.39710510e-02
 -3.91761735e-02 -4.53520985e-03  6.04306199e-02 -8.59610140e-02
  4.75437455e-02  2.17419434e-02 -5.49992844e-02 -3.24021056e-02
 -1.83727648e-02  2.45276541e-02 -1.42159537e-04  3.18623148e-02
  3.22712213e-02  7.83281308e-03 -3.96994911e-02  1.63688213e-02
  3.39529850e-02  5.22438325e-02 -2.79772710e-02  2.53523141e-03
  2.96788737e-02  2.26071663e-02 -3.54423467e-03  3.84110846e-02
 -3.10939196e-02 -5.29648550e-02  1.87386386e-02 -1.44017278e-03
 -1.01631852e-02  3.34598217e-03  6.67750090e-02 -4.42463048e-02
 -5.03026275e-03  7.61777069e-03  1.97186805e-02  1.78904813e-02
 -2.59701498e-02  1.26825704e-03 -1.23937009e-02 -5.78150600e-02
  6.23868266e-03  5.06036691e-02 -3.11089624e-02  4.43817042e-02
  9.76825133e-03 -1.70533266e-02 -1.73563492e-02  3.24824825e-02
 -2.05863435e-02 -5.13444655e-02 -4.68987264e-02 -3.96515913e-02
  2.66766567e-02 -1.14019366e-03  2.62867473e-02 -2.16463301e-02
  1.61986370e-02 -2.28540543e-02 -6.18725666e-04 -1.79524033e-03
  4.45536748e-02  2.24846415e-02 -1.74342655e-03 -6.94176927e-03
  2.03977041e-02 -2.83001899e-03 -7.74896666e-02  3.61586572e-03
 -2.45892094e-03 -2.43574157e-02  3.14074056e-03 -2.13543251e-02
 -4.44991440e-02 -4.92843650e-02 -1.68094542e-02 -3.12537402e-02
 -3.69322561e-02 -2.24536769e-02  5.47494516e-02  5.74993305e-02
  2.76976712e-02 -5.82691096e-02  2.83634849e-02  5.88258319e-02
 -2.05571242e-02 -1.78002976e-02  2.17559584e-03  2.11806758e-03
  1.72532108e-02  4.74353582e-02  1.01696141e-02 -5.93983504e-33
 -2.83628013e-02  2.91603561e-02  5.87200969e-02  3.60811315e-02
  1.70827601e-02  1.48309581e-02 -7.46362330e-03  1.77708101e-02
 -2.06293687e-02 -8.49354640e-03 -4.50928323e-02 -2.65041720e-02
  2.28441823e-02 -1.04923882e-02 -1.78500842e-02  5.49643394e-03
  5.44631332e-02  1.80272385e-02 -4.27331254e-02 -1.20553980e-02
  3.05824317e-02  4.16768789e-02  8.44786912e-02 -3.17345075e-02
 -4.46272902e-02  1.53608508e-02  9.42343194e-03 -4.12555635e-02
 -2.66755727e-04  2.57110409e-02 -1.69683173e-02  4.72404622e-02
 -7.01374561e-03 -1.02920532e-01 -1.38053447e-02 -6.82190657e-02
 -6.50498345e-02  8.49608239e-03 -6.40334701e-03  6.37370199e-02
  5.81158809e-02 -2.37448197e-02  3.25948708e-02  1.03507098e-02
 -4.66724522e-02 -5.17361574e-02 -6.19054399e-03 -8.45933042e-04
 -4.26875167e-02 -2.64263805e-02 -3.40803117e-02  2.47153416e-02
  5.16138710e-02  6.00908995e-02  4.02593203e-02  3.36351283e-02
 -4.44585904e-02 -2.16290653e-02 -8.26694444e-02  1.54881608e-02
  7.56095722e-02  7.91950449e-02  5.67061156e-02 -2.96299026e-04
  3.43768001e-02  1.42601943e-02  3.63274105e-02  2.98143923e-02
  2.31808331e-03  7.74123706e-03  8.39771852e-02 -1.21624256e-02
  5.28605618e-02  2.45425422e-02  8.62764046e-02 -2.01839395e-02
 -2.21446566e-02  2.76997052e-02 -1.52290240e-02  2.55595949e-02
  3.01638413e-02  2.02753767e-03 -7.99648184e-03  4.68094880e-03
 -1.18222032e-02  1.89602263e-02 -6.45787129e-03 -5.53346314e-02
  5.27496962e-03  1.38001936e-03 -2.13999599e-02  4.06247638e-02
  3.42349969e-02 -3.93302515e-02  5.76214679e-02 -4.14503999e-02
  3.26867327e-02  6.92594498e-02 -1.45693049e-02  1.01771383e-02
  2.07944773e-02 -6.50592670e-02 -3.54386531e-02 -3.73863010e-03
  3.03124841e-02  2.95270095e-03 -5.93062211e-03  6.77004009e-02
 -6.14946447e-02  2.13937815e-02 -7.57481949e-03 -1.80610977e-02
  4.11735699e-02  4.80223969e-02  1.60978958e-02  1.89659931e-02
 -3.86608881e-03 -3.00285668e-04 -5.62815443e-02  1.75368763e-03
 -3.57832536e-02  3.03303706e-03  1.88901629e-02  4.66872342e-02
 -5.28296679e-02 -2.30474435e-02 -4.17813845e-02  7.16876090e-02
  1.37369214e-02 -6.25712574e-02 -7.26841018e-02  2.51282249e-02
  2.80219467e-07  2.84576751e-02  4.28309403e-02 -1.81715339e-02
  1.07456204e-02 -4.34912108e-02  6.06222637e-03  2.25285683e-02
 -2.61167064e-02  5.68553880e-02  1.17606204e-02 -8.70463531e-03
 -9.30351578e-03  2.21934095e-02  2.45157182e-02  1.49426330e-02
 -5.84791228e-02 -3.16575952e-02  7.78876841e-02  2.42918497e-03
  8.15723033e-04 -4.43820581e-02  1.00900427e-01 -2.34456267e-04
  1.59261632e-03  5.05408570e-02  7.89275113e-03  2.89209113e-02
 -3.36524695e-02  2.75372192e-02 -1.03325248e-02 -3.29139782e-03
  2.37905439e-02 -1.94384996e-02  3.65199447e-02 -1.38092972e-02
  3.07861506e-03  3.53303887e-02  5.37267700e-02 -4.07470725e-02
  5.75029440e-02  3.07114162e-02 -3.09710559e-02 -3.85072902e-02
 -7.97971934e-02  6.12682849e-03  8.00631242e-04  1.23574063e-02
 -1.61316860e-02 -1.20577337e-02 -8.30714591e-03  1.45057468e-02
 -3.75847630e-02  4.32462171e-02  1.92280300e-03  2.58277114e-02
 -3.42050171e-03 -1.48666194e-02  1.09213591e-02 -2.31405310e-02
  1.46306481e-03 -3.14338803e-02 -5.38336337e-02 -7.10028112e-02
 -1.64272077e-02 -2.36829114e-03  3.37320752e-02 -3.26479003e-02
  2.96198082e-34 -1.48415670e-03 -9.89011489e-03  2.09591109e-02
  1.66077986e-02  9.58677568e-03 -4.04197052e-02  5.22998571e-02
 -3.54632549e-02 -3.89147513e-02 -4.14742939e-02 -3.03773023e-02]"
"Table 3: Variations on the Transformer architecture. Unlisted values are identical to those of the base
model. All metrics are on the English-to-German translation development set, newstest2013. Listed
perplexities are per-wordpiece, according to our byte-pair encoding, and should not be compared to
per-word perplexities.
 N
dmodel
dff
h
dk
dv
Pdrop
ϵls
train
PPL
BLEU
params
steps
(dev)
(dev)
×106
base
6
512
2048
8
64
64
0.1
0.1
100K
4.92
25.8
65
(A)
1
512
512
5.29
24.9
4
128
128
5.00
25.5
16
32
32
4.91
25.8
 32
16
16
5.01
25.4
(B)
16
5.16
25.1
58
32
5.01
25.4
60
(C)
2
6.11
23.7
36
4
5.19
25.3
50
8
4.88
25.5
80
256
32
32
5.75
24.5
28
1024
128
128
4.66
26.0
168
1024
5.12
25.4
53
4096
4.75
26.2
90
(D)
0.0
5.77
24.6
0.2
4.95
25.5
0.0
4.67
25.3
0.2
5.47
25.7
(E)
positional embedding instead of sinusoids
4.92
25.7
big
6
1024
4096
16
0.3
300K
4.33
26.4
213
development set, newstest2013. We used beam search as described in the previous section, but no
checkpoint averaging. We present these results in Table 3.
","[-1.63602992e-03 -7.12923845e-03 -4.93239332e-03  2.35494990e-02
 -5.06484620e-02 -1.56672450e-03  3.44660245e-02  2.00501755e-02
 -9.69466344e-02  1.17165660e-02 -1.71542335e-02 -4.97423746e-02
  4.29971889e-02  3.61754536e-03  2.71075014e-02 -3.09874173e-02
  2.21686773e-02 -6.93773059e-03 -7.72882476e-02 -1.72842965e-02
 -1.82386786e-02 -3.57561596e-02 -6.44957414e-03  3.46662439e-02
 -7.81518780e-03  4.18088697e-02 -3.77352163e-02  2.13289391e-02
  2.52298955e-02 -2.12296695e-02 -4.06500287e-02  5.40053137e-02
 -4.79227910e-03  9.33131278e-02  2.18485934e-06 -2.09203698e-02
 -4.10178863e-02  6.89896522e-03  4.19854699e-03  2.11936925e-02
  8.15353841e-02 -4.80007157e-02 -4.36319225e-02 -2.38340639e-04
 -9.74922441e-04 -2.89456584e-02  8.77851173e-02  4.10106443e-02
 -1.28419511e-02  8.35811794e-02 -1.97084676e-02 -6.24053329e-02
 -5.41853625e-03 -1.58265755e-02 -2.59521359e-04 -6.72072843e-02
 -1.66471675e-02  5.90981962e-03 -2.12052818e-02  5.93564138e-02
 -5.99167310e-02  7.70658776e-02  4.95806616e-03 -3.45627218e-02
 -2.75829807e-02 -3.40112229e-03 -1.38916634e-03 -5.19067422e-02
 -2.18915883e-02  2.32899953e-02 -4.97535057e-02 -1.59119871e-02
 -2.05239840e-02  2.06865612e-02 -3.87501158e-02 -1.04546165e-02
 -3.78628299e-02 -1.20631205e-02  8.74164887e-03 -2.10243296e-02
 -1.37010645e-02  4.64203162e-03 -5.16358437e-03 -7.47436509e-02
 -8.07229355e-02 -1.68364565e-03  4.40918803e-02 -5.62358797e-02
  4.36047092e-03  9.81134828e-03 -1.06520476e-02 -3.15398276e-02
  4.16913331e-02 -4.48433775e-03 -2.17784941e-02  8.17298703e-03
 -2.31778789e-02 -5.89530952e-02 -6.51960634e-03 -6.58114925e-02
  4.87108231e-02  4.95248325e-02  8.79292004e-03  1.04910368e-02
 -2.11122986e-02  7.80904442e-02 -8.36351663e-02  2.87064034e-02
 -8.29775035e-02  5.70503471e-04 -1.12190926e-02  4.94369725e-03
 -5.91286086e-02 -1.64593086e-02 -2.18734946e-02 -5.21626994e-02
 -3.14035304e-02 -8.10220744e-03  6.44692332e-02 -3.66628692e-02
  3.44173647e-02 -1.11256139e-02 -7.50461519e-02  9.17236600e-03
  1.89574901e-02  8.76623541e-02  5.46931848e-03 -5.28196916e-02
  1.08127836e-02 -2.69252826e-02 -2.57581174e-02  1.43508315e-02
 -1.82406872e-03 -3.36209796e-02 -6.33717934e-03  5.20533733e-02
 -6.79394836e-03 -2.47431565e-02  4.32700254e-02  2.86190230e-02
 -4.90233004e-02 -3.46641093e-02  1.96439773e-02 -4.86876741e-02
  2.36585718e-02  5.39694726e-02 -1.12590343e-02  2.92038396e-02
  2.39877924e-02  1.18009495e-02  1.21600041e-02  4.75144796e-02
  2.19863094e-02  9.45902243e-03 -6.74481690e-03 -3.73335090e-04
 -1.75571926e-02  8.52498487e-02 -2.16761651e-03  1.98967159e-02
  1.14713246e-02 -2.86183879e-02 -1.43990470e-02  5.52734844e-02
 -1.97889283e-02  2.88044866e-02 -2.19558030e-02 -6.38842359e-02
  2.35671829e-02  2.45779566e-02  4.15155590e-02  6.21362738e-02
 -2.22805422e-02  9.11200605e-03  4.61295992e-02  5.49833588e-02
  9.57250968e-02  1.90482158e-02 -1.29926475e-02  6.75993366e-03
  1.63438823e-02  2.61420310e-02  2.82526352e-02  1.19060371e-02
 -4.21287818e-03 -5.09421807e-03 -4.67466284e-03  8.36012289e-02
 -7.75210233e-03 -2.21432699e-03 -1.07610859e-02  6.31977897e-03
  2.67781205e-02 -6.10292815e-02  5.70369847e-02  3.50320004e-02
 -7.29124621e-02  8.92308801e-02 -9.90520511e-03 -8.07564184e-02
 -2.86545269e-02 -2.40327232e-02 -4.80531678e-02 -3.66568682e-03
  6.13679029e-02  1.73969045e-02  3.00630509e-05  2.17903014e-02
 -2.72098109e-02  9.04591233e-02  6.23256862e-02  5.40123321e-02
  7.87956757e-04 -5.32782525e-02 -3.55070233e-02  6.64669201e-02
  1.03051895e-02  1.56895630e-02 -6.96696632e-04  2.92997397e-02
 -4.02669975e-05 -6.46896020e-04 -1.92609872e-03  1.08723026e-02
  8.09503370e-04  3.93684506e-02 -2.85815075e-02  2.50882003e-02
  2.65367189e-03  3.89018618e-02 -8.63270892e-04 -4.02614661e-03
  3.84372324e-02 -4.47275862e-02 -1.51977111e-02  5.20210452e-02
 -6.91756001e-03 -2.13150568e-02  3.39095220e-02 -4.01867852e-02
  3.08784787e-02  6.14265678e-03  1.67928319e-02 -3.86973247e-02
  1.40877524e-02 -1.00509234e-01  3.60109620e-02 -1.23374779e-02
  8.13132003e-02 -3.37498933e-02  2.52554920e-02 -2.79156081e-02
  4.48265225e-02 -2.06113569e-02  4.35560010e-02 -4.56142053e-02
 -2.51431335e-02  4.46217880e-02 -3.05244792e-02 -5.03880903e-02
  5.84112555e-02 -1.04909297e-02 -3.68312071e-03  3.18474136e-02
  7.25526456e-03  1.25943674e-02 -5.20767383e-02 -1.14471028e-02
 -1.44214882e-02 -9.44282860e-03  1.59877986e-02  4.89682592e-02
  4.29411232e-02  2.65087560e-02 -1.63382303e-03 -9.55806393e-03
  2.81447433e-02  2.36863028e-02 -2.21417714e-02  1.97548401e-02
  8.55468796e-04 -5.71509115e-02 -1.90169998e-02 -2.52620112e-02
  1.19758174e-02  4.44349088e-02  1.62035022e-02 -3.17802355e-02
 -1.02595277e-01  6.08374290e-02  1.31356362e-02  3.11205573e-02
  1.14155542e-02 -1.01371616e-01 -4.36159375e-04 -1.07815312e-02
  3.14342268e-02  2.74714604e-02  2.07958706e-02 -4.14353126e-04
 -7.35872658e-03 -8.91862251e-03 -2.83842962e-02  1.97971426e-03
 -5.17648160e-02 -1.60935184e-03 -4.83721644e-02 -2.45705824e-02
  5.77741722e-03  6.98965937e-02  6.07853290e-04  3.05839423e-02
 -5.97719960e-02 -4.14226018e-02 -2.06609648e-02 -2.94910818e-02
  2.60927286e-02  1.38067603e-02 -2.39838380e-02  2.66790688e-02
 -1.33847352e-02 -2.32840446e-03  1.52314045e-02 -4.64921743e-02
 -1.18514113e-02 -8.50428417e-02  4.20024991e-02 -2.50415262e-02
  3.45060579e-03 -1.44437840e-02  4.66015413e-02 -4.95137759e-02
 -2.04577390e-02 -1.80969536e-02  5.12484945e-02  8.43207259e-03
 -3.97622995e-02  4.50378247e-02  2.70568989e-02 -1.98905426e-03
 -4.90604825e-02 -1.59746949e-02 -2.75691412e-02  4.27178666e-02
  3.74317938e-03 -4.66524288e-02  6.55752867e-02 -5.58282696e-02
 -7.32256547e-02  7.33702034e-02  4.11101356e-02  3.75968181e-02
 -1.92736089e-02 -9.62711312e-03 -4.58499417e-02  3.91225815e-02
 -2.26090383e-02  1.18883206e-02  5.07394485e-02 -2.67709978e-02
  3.01845875e-02  1.68253798e-02  9.38550662e-03  5.63809043e-03
 -6.12364523e-02 -9.94810276e-03  6.09829687e-02  2.96898186e-03
 -5.19546345e-02 -9.77876317e-03  4.90838364e-02 -3.84105034e-02
 -5.94057562e-03  7.47731403e-02 -4.50087199e-03 -5.51064871e-02
 -1.17766215e-02  1.67379971e-03  1.33411493e-02  5.51653327e-03
  2.49498114e-02 -6.70252517e-02  1.63350627e-02 -4.74131608e-04
  5.24423691e-03  2.78025270e-02  4.44873646e-02  1.42966481e-02
 -9.41921771e-02  3.28782424e-02  2.46904679e-02 -1.65232476e-02
 -5.42254373e-02 -1.70652345e-02 -2.81658638e-02 -7.76051730e-03
  6.91891415e-03  3.18148844e-02  1.39569340e-03 -2.19942201e-02
  1.57323014e-02  2.46506128e-02 -3.69257890e-02 -3.08058783e-02
 -5.17435744e-02 -1.78869832e-02  4.50872034e-02  3.10008917e-02
 -1.33905225e-02 -9.09794196e-02 -2.26949644e-03  3.38842347e-02
  2.04098914e-02  1.94802135e-03  2.02501602e-02  4.84638922e-02
 -2.15540119e-02 -1.69396624e-02 -2.02918760e-02 -1.31196203e-02
  1.33427093e-02 -7.18101561e-02  2.12643389e-02 -3.95427085e-02
  2.44241115e-02  2.60395687e-02  4.67481390e-02 -3.75779383e-02
  2.96244808e-02 -1.77383446e-03 -2.63820942e-02 -6.75435411e-03
 -1.64086558e-02  6.40969500e-02 -6.04212061e-02 -5.52011169e-02
  1.84071828e-02 -6.73464360e-03 -7.17127547e-02 -6.65458143e-02
  3.96058112e-02 -3.91401462e-02  9.31831151e-02  4.41034958e-02
 -2.39272192e-02 -1.90319996e-02  3.49441031e-03 -3.75427082e-02
 -2.29525752e-02  2.14446988e-02  2.24773046e-02 -9.40930471e-02
  2.90108062e-02 -2.34846398e-03 -1.63590871e-02 -1.12821562e-02
 -1.31445928e-02 -7.49258175e-02 -4.15816754e-02  6.45099878e-02
  1.93621889e-02  4.21977304e-02  5.28988079e-04 -3.00799869e-02
 -2.27071084e-02  9.83640901e-04  1.15167641e-03 -1.98921952e-02
  4.02184874e-02  1.19585106e-02 -4.18643653e-02 -2.34794505e-02
  2.19463254e-03  6.20566448e-03  9.71272308e-03 -2.31680628e-02
  3.63559537e-02  3.16983238e-02 -3.95380817e-02  2.01606601e-02
  2.47517647e-03  5.37011214e-02 -5.78334602e-03  1.27912546e-02
 -5.76913124e-03  4.23044860e-02 -4.17090096e-02  2.20891889e-02
 -3.19848992e-02 -3.38514373e-02  4.34949845e-02 -1.78139731e-02
  2.36061849e-02  2.22676136e-02 -9.15333815e-03 -2.58323066e-02
  1.03785610e-02  4.59540002e-02 -1.27089377e-02 -2.27358658e-02
  2.87460256e-03  9.96843912e-03  3.27511393e-02  1.25743747e-02
  1.54647008e-02  3.98904905e-02 -2.73747463e-02  4.86445278e-02
  1.05429310e-02 -3.07433587e-03 -7.44626904e-03  4.06547114e-02
 -4.31606844e-02 -2.63193715e-02 -2.71884110e-02 -4.86656316e-02
  7.27428049e-02  1.95957441e-02  8.47748369e-02 -1.90769844e-02
 -2.13165185e-03  2.23482363e-02 -7.47758802e-03  7.04325922e-03
  4.54408675e-02 -9.98511259e-03 -1.14503456e-02  1.93139985e-02
  1.13244290e-02  2.01888569e-02 -6.10030815e-02  1.22529501e-02
 -7.71415280e-03 -1.06689315e-02 -2.95721949e-03  1.50149676e-03
 -1.41622350e-02 -3.92039195e-02 -1.97710600e-02 -4.38124463e-02
 -4.08332907e-02 -3.29031758e-02  3.73173393e-02  3.35067548e-02
 -2.29495391e-03 -3.22544873e-02  2.92324070e-02  4.23648804e-02
 -7.36484397e-03 -1.22811086e-02  2.25269590e-02 -2.86631230e-02
  1.01479585e-03  8.88430234e-03  8.56827945e-03 -6.08170435e-33
 -1.79677401e-02  2.18460951e-02 -4.48474148e-03  1.13154366e-03
 -5.56337908e-02  1.66075304e-03 -3.30885202e-02 -9.45294555e-03
 -1.70930717e-02 -2.07483601e-02 -1.76464543e-02  4.63780994e-03
  3.50522436e-02  5.04870294e-03 -1.42847635e-02  3.69914286e-02
  5.34568727e-02  3.22345109e-03 -3.22069936e-02 -1.13547463e-02
  4.62566353e-02  3.75908352e-02  6.37218207e-02 -1.85299590e-02
 -3.74950431e-02  1.69583429e-02 -2.35388149e-02 -1.80891324e-02
  1.10123781e-02  1.98042169e-02 -5.68008469e-03  8.74418402e-05
 -2.65757516e-02 -6.83889538e-02 -1.63880941e-02 -2.71102488e-02
 -2.30066944e-02  2.53015459e-02 -2.73772758e-02  8.51737037e-02
  2.37630252e-02 -1.82876904e-02  1.22979833e-02 -3.11143789e-02
 -7.78467357e-02 -3.78744584e-03 -1.10271238e-02 -1.89121477e-02
 -3.54425199e-02  7.99991656e-03 -4.67842072e-02  1.49988923e-02
  2.69495416e-02  2.48860195e-03  9.84310545e-03  2.54697446e-02
 -2.77103875e-02 -1.07972778e-03 -3.46654728e-02  3.57678384e-02
  6.17296249e-02  9.32403877e-02  4.37481552e-02 -7.25629972e-03
  1.80511456e-02  2.12390441e-02  9.65429395e-02 -1.82243641e-02
  3.89499106e-02 -3.11674923e-02  5.18856309e-02  1.52142840e-02
  8.76940563e-02 -3.91271012e-03  4.00513895e-02 -7.84183107e-03
  1.88052710e-02  3.42297293e-02 -9.52340756e-03  5.55556156e-02
  3.99457552e-02  3.73812430e-02 -4.67450470e-02 -6.78785471e-03
 -5.23597049e-03 -1.66332405e-02 -9.41057596e-03 -5.86049408e-02
  6.08728826e-03  7.60351494e-03 -1.03722084e-02 -4.09366610e-03
  5.78502826e-02 -5.04533723e-02  6.84668273e-02 -1.53694004e-02
 -2.47371960e-02  5.93941733e-02 -3.71766090e-02  1.05276667e-02
  1.58479605e-02 -4.91571762e-02  5.25193550e-02  3.28375846e-02
 -1.15035186e-02 -2.65558399e-02 -2.73933038e-02  5.48887476e-02
 -4.83289510e-02  3.52339563e-03 -9.95195657e-03 -2.25715395e-02
  6.45964546e-03  1.99506618e-02  3.32913846e-02 -3.90898734e-02
 -2.65180413e-03  1.11014992e-02  3.34448516e-02 -2.15548892e-02
 -3.16476189e-02  2.34949961e-02  4.04239744e-02  5.68139292e-02
 -4.25104983e-02  3.26969922e-02 -5.96886389e-02  1.62228178e-02
  1.72620174e-02 -7.60795176e-02 -6.17892481e-02  4.04774211e-02
  2.88008835e-07  6.25177547e-02  5.69842346e-02  5.96295930e-02
  4.15006205e-02 -1.03853699e-02 -2.19304375e-02 -2.03814823e-02
  7.19953980e-03  2.28716973e-02  2.59248670e-02  3.26761440e-03
  1.10013783e-02  3.63739207e-02  8.88686627e-03 -1.36195114e-02
 -2.18470339e-02 -3.38768363e-02  2.83267889e-02 -4.51744981e-02
 -1.51532935e-02  2.62834970e-02  1.04847439e-01 -5.70408218e-02
 -1.82119533e-02 -8.19724612e-03 -2.22448187e-04  3.12134810e-02
  2.99655348e-02 -4.16812953e-03 -4.23061196e-03  1.34462053e-02
 -7.22008338e-03 -3.82480025e-02  2.59593762e-02 -2.47047320e-02
  3.52616571e-02  4.43282202e-02  1.20602194e-02 -5.08948276e-03
 -5.14086001e-02  4.12388630e-02 -7.22214300e-03 -3.30012739e-02
 -5.23708910e-02  2.10848246e-02 -2.07603741e-02  2.79765693e-03
  2.34214477e-02 -2.78677829e-02 -1.59070697e-02  9.67962015e-03
 -2.96196770e-02 -2.19753501e-03  8.04796536e-03  3.47846970e-02
  7.07556913e-03 -6.93501113e-03 -2.21361164e-02 -8.55674967e-03
 -1.71306450e-02 -3.17083038e-02 -4.26958352e-02 -3.72538157e-02
  1.33454921e-02  1.89977083e-02 -4.58417321e-03 -4.52537201e-02
  3.20028314e-34  3.82263325e-02 -1.02621028e-02  4.84646810e-03
  7.78959785e-03  2.18792958e-03 -3.24958414e-02  2.74525229e-02
  1.07550318e-03 -3.46088819e-02 -9.63507146e-02 -4.78759818e-02]"
"In Table 3 rows (A), we vary the number of attention heads and the attention key and value dimensions,
keeping the amount of computation constant, as described in Section 3.2.2. While single-head
attention is 0.9 BLEU worse than the best setting, quality also drops off with too many heads.
 In Table 3 rows (B), we observe that reducing the attention key size dk hurts model quality. This
suggests that determining compatibility is not easy and that a more sophisticated compatibility
function than dot product may be beneficial. We further observe in rows (C) and (D) that, as expected,
bigger models are better, and dropout is very helpful in avoiding over-fitting. In row (E) we replace our
sinusoidal positional encoding with learned positional embeddings [9], and observe nearly identical
results to the base model.
 6.3
English Constituency Parsing
To evaluate if the Transformer can generalize to other tasks we performed experiments on English
constituency parsing. This task presents specific challenges: the output is subject to strong structural
constraints and is significantly longer than the input. Furthermore, RNN sequence-to-sequence
models have not been able to attain state-of-the-art results in small-data regimes [37].
 We trained a 4-layer transformer with dmodel = 1024 on the Wall Street Journal (WSJ) portion of the
Penn Treebank [25], about 40K training sentences. We also trained it in a semi-supervised setting,
using the larger high-confidence and BerkleyParser corpora from with approximately 17M sentences
[37]. We used a vocabulary of 16K tokens for the WSJ only setting and a vocabulary of 32K tokens
for the semi-supervised setting.
","[ 2.23426968e-02  7.93273374e-02  1.47139579e-02  1.02444990e-02
 -3.69573124e-02 -8.93794559e-03 -1.44090015e-03 -1.90789215e-02
 -7.24374726e-02 -5.31918108e-02 -9.63360257e-03 -4.43548784e-02
  4.42752093e-02 -1.60304252e-02  3.51620913e-02 -5.31307720e-02
  4.38555926e-02 -2.48946110e-03 -1.41464602e-02  3.12512554e-02
  1.96914524e-02 -9.38284863e-03  1.76479910e-02  7.10335076e-02
 -4.75808978e-02 -1.94729138e-02 -2.27806102e-02 -1.21252974e-02
  1.92451645e-02 -2.53889826e-03  5.63660916e-03  5.75618595e-02
  1.00441335e-03  4.83722985e-02  1.88200522e-06  8.90149735e-03
 -1.53302299e-02 -3.27601680e-04 -1.66288689e-02 -1.17075285e-02
  6.81147575e-02 -4.75756899e-02 -1.87097602e-02  1.50193414e-02
 -1.09513653e-02 -1.86021514e-02  5.43900169e-02  3.70214619e-02
  6.24977909e-02  1.18537515e-01 -5.18181501e-03 -6.37663528e-02
  5.65458983e-02 -5.17629310e-02 -5.60150831e-04 -1.56287535e-03
  3.09340060e-02 -3.18596661e-02  5.77830290e-03  2.97780745e-02
 -1.18945520e-02  2.72583440e-02  3.80726047e-02  1.22515000e-02
 -7.22264638e-04  3.17883193e-02 -3.64962369e-02 -9.36930627e-03
  5.87450806e-03  2.78282836e-02 -6.48333207e-02 -3.68393660e-02
 -5.45705343e-03  2.32768096e-02 -1.87443551e-02 -2.50130985e-02
 -2.45440528e-02  5.15501313e-02  1.81575969e-03  1.02072852e-02
  5.49605414e-02  6.17615972e-03 -3.52685293e-03 -1.37482546e-02
 -3.49627435e-02  3.04374713e-02  1.67058427e-02 -5.70891052e-02
 -9.83761065e-03  2.24251840e-02 -3.15245017e-02 -3.67301106e-02
  1.90828834e-02 -1.33190136e-02  1.94399413e-02  3.54869664e-02
 -4.41568829e-02 -4.42872792e-02 -8.09937902e-03 -7.82017410e-02
  3.37635651e-02  4.64144312e-02 -1.90078020e-02  2.08479143e-03
 -6.54536299e-03  5.85202798e-02 -4.83061448e-02  3.25631052e-02
 -3.79600190e-02 -5.76563040e-03 -4.69102450e-02  1.61610041e-02
 -4.26284671e-02  3.98280993e-02 -5.59584387e-02 -3.57119888e-02
 -3.09811886e-02 -1.98736619e-02  2.26302072e-02  1.64598157e-03
  5.79289645e-02  1.34524070e-02 -8.54099244e-02  9.88908811e-04
  1.70936827e-02  7.91273639e-02  2.85381125e-03 -8.08969792e-03
  1.19813224e-02 -4.45094444e-02 -3.87488194e-02  4.27139997e-02
  2.41172127e-03 -4.88169678e-02 -3.12590152e-02 -2.33498449e-03
  3.65952350e-04 -4.14449684e-02 -1.47765568e-02  1.52223064e-02
 -7.53416866e-02 -4.48790714e-02  2.63469964e-02 -5.76957278e-02
  2.12729350e-02 -1.85802318e-02 -8.49348772e-03 -2.11249422e-02
  1.41850254e-02  4.53793406e-02  7.91580789e-03  5.07312119e-02
  4.77106944e-02 -2.31762994e-02 -2.53943615e-02  2.67638359e-03
  1.79543085e-02  5.06202877e-02  3.83664705e-02  3.30919437e-02
 -7.34571042e-03 -2.88347807e-02 -2.25764103e-02  1.73629988e-02
 -9.27674002e-04 -2.52873935e-02 -2.24260073e-02 -9.86663275e-04
 -1.63976829e-02  3.17262411e-02  7.12188706e-02  4.41672839e-02
 -1.66347958e-02 -2.26363093e-02  4.94188257e-02  2.65941136e-02
  5.18706143e-02  3.72155607e-02  4.57729697e-02 -6.21641928e-04
 -3.61224860e-02  3.33365388e-02 -3.90986018e-02  4.93635889e-03
  2.40121000e-02  4.69099469e-02 -1.87136997e-02  1.94836929e-02
 -1.15676932e-02 -8.58395919e-03 -1.17116384e-02 -2.86476295e-02
 -1.91457272e-02 -3.93981263e-02  3.91732864e-02  1.68169327e-02
 -7.57954344e-02  8.69191736e-02 -1.27616804e-02 -6.73854202e-02
 -1.77563913e-02 -1.07615199e-02 -1.82193890e-02  1.19352024e-02
  1.07883373e-02  5.93416719e-03 -2.74812635e-02 -1.98038369e-02
 -6.07303949e-03  6.91659003e-02  3.47153060e-02  2.06294898e-02
  9.09524038e-03 -4.96917255e-02  5.52778225e-03  2.34472957e-02
  2.29602959e-02  3.99525948e-02  9.26530641e-03 -8.45601689e-03
  2.74607763e-02 -1.66735146e-02 -7.76297040e-03  2.91257855e-02
  3.92520986e-03 -5.57173602e-03 -1.95458047e-02  9.53011680e-03
  4.68910523e-02  3.44475619e-02  1.34187788e-02  3.61149833e-02
  4.02921364e-02 -5.68963587e-02  3.43119726e-02 -2.08064448e-03
 -9.89811942e-02 -4.53462005e-02  7.15441070e-03 -1.07943099e-02
 -4.39473474e-03  7.36491084e-02 -1.85101796e-02 -5.68704084e-02
  1.80815179e-02 -7.62778148e-02  2.30099186e-02 -2.90484168e-02
  1.06126601e-02  1.89606883e-02  4.37211953e-02 -2.84582265e-02
  7.51035064e-02 -1.74420495e-02  2.30123792e-02  8.65937863e-03
 -3.19505576e-03 -6.44343998e-03 -5.23954853e-02 -2.36554146e-02
 -1.31073799e-02 -1.98221635e-02 -5.18147601e-03  3.48266819e-03
 -2.90939119e-02 -2.12005749e-02 -4.92640585e-02 -5.26382402e-02
  8.97528790e-03 -2.14217901e-02  5.91563694e-02  4.30596545e-02
  2.25153286e-02  2.95872297e-02  2.65852246e-03 -2.49727871e-02
 -1.99125782e-02 -2.04691757e-03  1.27547830e-02  4.45027053e-02
  1.25113782e-02 -4.08073105e-02 -5.30148931e-02 -2.78763138e-02
 -3.42369601e-02  5.12761883e-02 -2.85354797e-02 -3.89916748e-02
 -5.19578680e-02  2.80976575e-02  4.25633118e-02  3.22553515e-02
 -4.28520516e-03 -7.50659704e-02 -1.22658070e-03 -2.50733383e-02
  5.17227575e-02  7.36823007e-02  9.26459115e-03  3.49638052e-03
 -4.75227972e-03 -1.57049317e-02 -4.35421579e-02  1.75221227e-02
 -1.46106537e-02  3.02602127e-02 -4.97204736e-02 -2.55847704e-02
  2.64394917e-02  1.09267257e-01 -8.67512822e-03  1.45910941e-02
 -4.84469756e-02 -8.79052933e-03 -3.35898483e-03  1.15282810e-03
  4.03303653e-02 -1.68135837e-02 -5.18770665e-02  6.15565479e-03
 -2.39267591e-02  2.21774261e-03  2.97659859e-02 -5.95020577e-02
 -3.97073589e-02 -7.66746029e-02  1.80725418e-02 -3.60470712e-02
  4.20629159e-02  4.02597673e-02 -4.62455815e-03  3.84641998e-03
 -6.37836158e-02 -3.06604654e-02  1.32884821e-02 -2.28588320e-02
 -5.97824436e-03  6.89947605e-02 -7.79881375e-03  2.35929955e-02
 -5.68790957e-02 -3.42311710e-02 -2.52301544e-02 -4.04991210e-02
 -9.88188386e-03  2.89522130e-02  5.46689965e-02 -1.47790117e-02
 -2.09782217e-02  5.70096225e-02  4.25717374e-03  5.43213822e-02
 -7.30786053e-03  1.36343651e-02 -3.24021280e-02  5.37233353e-02
  1.47834159e-02  7.48092681e-02  8.47244076e-03  2.34120358e-02
  1.41281076e-02  1.70194134e-02  1.36477435e-02  3.11332345e-02
 -9.37550589e-02 -2.09744442e-02  7.67260930e-03 -5.03181480e-02
 -1.97904464e-02 -8.28522071e-03  4.21687365e-02 -8.55531394e-02
 -5.72660975e-02  1.00587927e-01 -7.30297202e-03 -3.84281203e-02
 -4.02788632e-03  2.81349868e-02  1.22570554e-02 -6.30655931e-03
  2.55044624e-02 -5.16942404e-02 -2.02869941e-02  8.37508496e-03
  1.44847045e-02  3.35967131e-02 -2.39513516e-02  1.83872245e-02
 -1.49494559e-01  2.84884777e-02 -3.07135982e-03 -5.12589179e-02
 -5.77917881e-02 -1.55648021e-02 -2.09068321e-02 -3.07203755e-02
  1.32985599e-02  2.91424487e-02 -3.27490978e-02 -5.62052056e-03
  2.69874278e-02 -3.52294855e-02 -5.17031215e-02  4.06405609e-03
 -3.29347439e-02  6.07383158e-03  8.82110968e-02  2.45341808e-02
  2.28398875e-03 -5.91525324e-02  1.71315074e-02 -3.50846723e-02
  1.26900794e-02  3.21413651e-02  9.37059708e-03 -1.12451501e-02
 -1.12787904e-02  4.15593153e-03 -1.15759717e-02 -3.46962363e-02
  3.10122631e-02 -4.04787697e-02  4.76012304e-02  3.73477465e-03
 -9.20911413e-03 -1.41814435e-02  3.44431438e-02 -7.86924455e-03
  5.74818365e-02  4.56423573e-02 -1.79315824e-02 -5.82349002e-02
 -7.53058167e-03  4.30468358e-02 -9.42662880e-02 -1.97949703e-03
  4.78736609e-02  2.01205853e-02 -4.32306230e-02 -1.05645761e-01
 -4.33252081e-02 -1.07309152e-03  5.45100234e-02 -1.56052010e-02
 -2.71948576e-02  2.37364192e-02 -6.55533560e-03  5.55798691e-03
  2.65597235e-02  7.46720796e-03  3.26372241e-03 -5.30625656e-02
  1.92404501e-02  2.29226947e-02  3.09772808e-02 -1.86749287e-02
 -3.97365466e-02 -8.43156651e-02 -1.33522032e-02  4.96577621e-02
  3.92807797e-02  2.19123662e-02  4.21010591e-02 -2.24879514e-02
  6.87298132e-03 -2.99044903e-02  1.55816926e-02 -3.52041908e-02
 -6.57087751e-03  3.79015021e-02  1.13627790e-02 -7.99556915e-03
  1.73361078e-02 -2.79405992e-03  2.73280814e-02  8.31511337e-03
  4.45202366e-02 -2.20784880e-02 -1.54025983e-02  2.43409052e-02
 -4.99791792e-03  7.35101253e-02  1.12073747e-02  3.60338911e-02
  2.64055487e-02  3.36906947e-02 -1.72985140e-02  2.56034117e-02
 -3.35774645e-02 -3.01512815e-02  4.32168543e-02  1.02403266e-02
  1.21374009e-02  2.38319095e-02  8.93449970e-03  1.04179084e-02
 -1.74927898e-02  6.19543009e-02  1.50653580e-02  5.25046606e-03
 -1.56016722e-02  4.27075243e-03 -4.55345921e-02 -1.90764107e-02
  2.98121758e-03  4.53036577e-02 -3.27489153e-02  1.55258821e-02
  1.18774157e-02  1.16700167e-02 -9.50507703e-04  4.16649133e-02
 -7.48471990e-02  2.70029083e-02 -2.93277353e-02 -2.56501902e-02
  3.84968109e-02 -4.12603654e-02  5.40708788e-02 -2.24500336e-02
 -1.57580571e-03 -2.21244455e-03  7.58563541e-03  1.43220578e-03
  1.14233838e-02  5.09258471e-02  8.76445230e-03  2.16089771e-03
 -3.30881178e-02  6.26514778e-02  2.31500491e-02  7.93753564e-03
  2.58721299e-02  1.90584722e-03 -4.14803997e-02 -3.71613055e-02
 -1.23638464e-02 -2.29912698e-02 -3.82371731e-02 -1.82165205e-02
 -2.61086896e-02 -3.93492617e-02  1.44193936e-02 -5.85163303e-04
  2.73251403e-02 -1.27508231e-02  3.99811491e-02  1.92570593e-02
  1.20701001e-03  2.19653267e-03  6.60415040e-04  2.16491912e-02
  1.47834877e-02 -4.34741043e-02 -5.70713133e-02 -5.98043073e-33
 -4.26035784e-02  1.48107354e-02  4.11639269e-03 -4.88748923e-02
 -3.95499617e-02  1.37265902e-02 -4.56644297e-02 -1.46057745e-02
 -2.18934100e-02 -1.39441127e-02 -2.34196465e-02 -6.74598711e-03
  2.84074731e-02  7.23548159e-02  5.62773161e-02 -2.85931909e-03
  5.45319021e-02  3.07300128e-03 -3.57979350e-03  1.25958977e-04
  4.04418297e-02  3.80611159e-02  5.82123660e-02  2.14448310e-02
 -1.46020027e-02  1.43333068e-02 -5.46798948e-03 -9.13683418e-03
 -3.05333728e-04  5.72399795e-02  1.20959748e-02  1.40407411e-02
  2.80925222e-02 -8.41557905e-02 -4.07236069e-02  7.28335157e-02
 -7.08590820e-02  2.06546555e-03  7.52338255e-03  2.55411007e-02
 -2.02837563e-03 -4.11704034e-02  6.57659993e-02 -1.13453111e-02
  1.42562343e-02 -1.92207024e-02  3.49025987e-03 -2.89213918e-02
 -3.00936792e-02  4.69574193e-03 -5.93252331e-02  1.85220465e-02
  2.76724733e-02  1.12081924e-03  2.47061085e-02  5.85882552e-02
 -1.35052083e-02  3.65845971e-02 -7.14899674e-02 -2.84322817e-02
 -1.31710600e-02  1.07982799e-01  9.27594025e-03 -1.78319775e-03
 -1.37755992e-02 -1.53968739e-03  2.01054551e-02 -1.20218191e-02
 -2.48437058e-02  1.71948317e-02  3.06570856e-03  3.85131873e-02
  7.83790573e-02  2.17777826e-02  5.29549830e-02  1.18545881e-02
 -3.35713550e-02  5.98618388e-03  8.78866389e-03  9.46626440e-02
  7.92486500e-03  8.94615368e-04 -3.90673988e-02 -1.15460064e-02
  3.21694203e-02 -2.07953453e-02 -1.02537302e-02 -2.10975856e-02
  3.10859922e-02  1.67627651e-02  9.00705066e-03  4.62930985e-02
  5.50619252e-02 -4.29142825e-02  1.98766924e-02  1.58284814e-03
  1.44889383e-02  2.94702910e-02 -2.36553531e-02 -7.12410500e-03
 -5.22385836e-02 -2.62666363e-02 -7.16998475e-03  6.64151236e-02
 -1.91425660e-03  1.08695601e-03  2.92015690e-02  1.93168018e-02
 -5.81137501e-02 -1.45001272e-02 -3.60412076e-02  2.05887612e-02
 -3.52133140e-02  1.01873241e-01  4.53946479e-02 -1.55362096e-02
  1.11766793e-02  2.75972635e-02 -2.27166340e-02  2.30281125e-03
  1.06662363e-02 -1.04472262e-03  2.87499614e-02  2.89668087e-02
 -1.44939702e-02  8.45026597e-03 -2.13067085e-02  5.77203706e-02
  1.99231263e-02 -1.24321897e-02 -1.52747203e-02  4.04189900e-02
  2.72784007e-07  5.20760752e-02  2.15725098e-02  7.23317415e-02
 -1.76169872e-02  2.43865680e-02  1.64696239e-02 -1.17216622e-02
  3.99977081e-02 -5.21489084e-02 -1.33336727e-02 -7.45157804e-03
 -6.79921880e-02  6.65428042e-02 -8.77508987e-03 -1.23155512e-01
 -5.05303852e-02 -8.99759233e-02  3.55980508e-02 -4.53267731e-02
 -4.51550027e-03  3.42396349e-02  1.22044206e-01 -4.00889404e-02
 -6.91563822e-03 -2.22797077e-02  7.93424994e-03  2.99310517e-02
  2.14986224e-03 -8.55353568e-03 -5.41988527e-03  1.79709382e-02
 -8.18174519e-03 -1.95697360e-02 -6.63217017e-03 -2.95112059e-02
  2.41232235e-02 -5.83942002e-03  7.07565993e-02  1.92052908e-02
 -2.99369749e-02  1.20001389e-02 -2.17297059e-02  1.79016625e-03
 -6.20385893e-02  1.73372217e-02 -9.07844827e-02 -1.54329548e-02
 -2.69270670e-02 -4.31198217e-02  4.48248647e-02 -3.24106701e-02
  1.32568767e-02 -1.00722844e-02 -1.58866588e-02  3.42183299e-02
 -2.85348427e-02 -1.85763650e-02 -4.63776030e-02 -2.43717209e-02
  1.71543881e-02 -4.15601842e-02 -4.84493125e-04 -5.20574041e-02
 -3.23522883e-03  3.68672051e-02 -1.29916193e-02 -7.08663166e-02
  2.62462243e-34  1.01107405e-02 -1.40301706e-02  1.67018063e-02
  3.65903713e-02  1.06402095e-02 -1.88497417e-02 -1.35961510e-02
  6.15094323e-04 -7.76555529e-03 -8.27029496e-02 -4.30016927e-02]"
"We performed only a small number of experiments to select the dropout, both attention and residual
(section 5.4), learning rates and beam size on the Section 22 development set, all other parameters
remained unchanged from the English-to-German base translation model. During inference, we
9
","[ 1.30485334e-02 -4.68126731e-03 -1.75173059e-02  2.37246212e-02
 -2.11524703e-02  2.40294002e-02  8.61278400e-02 -2.99055018e-02
 -6.17126301e-02  3.10959499e-02 -3.81033942e-02 -5.64680919e-02
  1.00058457e-02  1.33637842e-02  3.37779969e-02 -3.86726260e-02
  5.48275523e-02 -3.18090022e-02 -4.71877791e-02 -1.94489323e-02
 -1.03269992e-02 -1.86612345e-02 -1.83626469e-02  1.94320586e-02
  1.93600412e-02  2.93829665e-02  1.72461644e-02  4.18769987e-03
 -8.50928202e-03 -8.56347941e-03 -3.29531506e-02  3.98769937e-02
  2.07375418e-02  5.37807792e-02  1.88400088e-06 -7.21575469e-02
  2.30196561e-03  8.84885527e-03 -2.89578345e-02  8.71260837e-03
  5.80510758e-02 -4.06876840e-02  2.60793231e-03 -2.17896468e-05
  2.33285734e-03 -1.61507365e-03  6.96797818e-02 -1.32681814e-03
 -5.78389736e-03  4.59603667e-02 -4.08045575e-03 -4.28676568e-02
  6.01908471e-03 -4.02003042e-02  6.35762215e-02 -5.92596494e-02
 -9.65202972e-03 -1.74767605e-03 -5.78285158e-02  8.61866400e-03
 -4.51384559e-02  5.80951460e-02  5.57091124e-02 -4.77458443e-03
 -2.56599598e-02  2.47049686e-02 -1.91299729e-02 -6.25559911e-02
 -1.94132663e-02  1.38997566e-02  3.25574391e-02 -2.33536381e-02
 -3.55262980e-02 -7.68330367e-03 -1.07029267e-02 -3.13112549e-02
 -8.77534151e-02  2.02066191e-02  1.92831154e-03 -1.53490687e-02
  8.33371058e-02 -2.19939891e-02 -1.08381482e-02 -4.25986834e-02
 -5.28939581e-03  8.73717200e-03  3.61424647e-02 -4.10552882e-02
  1.72649976e-04  5.37462346e-02 -2.98712179e-02 -2.17091739e-02
  1.60140805e-02 -6.02137623e-03  1.22587532e-02  4.46692295e-02
 -4.38226908e-02 -3.20766531e-02 -1.54816136e-02 -4.94053401e-02
  3.06525044e-02  4.66466919e-02 -1.46052567e-02 -3.22883530e-03
 -1.76903047e-02  1.01532400e-01  7.95990881e-03  3.46621275e-02
 -8.08412284e-02 -9.84924100e-03 -4.74876724e-03  1.37722343e-02
 -6.20165505e-02  7.36694969e-03 -1.57495998e-02 -4.99003939e-03
 -5.92593104e-02 -1.36292111e-02  4.89989445e-02 -8.74713622e-03
  1.96897169e-03 -3.75131443e-02 -1.32149801e-01  1.82879642e-02
 -6.92040240e-03  7.63006583e-02 -1.43883824e-02 -2.94072460e-02
  5.45625854e-03 -8.71667117e-02 -4.92754541e-02  2.76529174e-02
 -3.66320983e-02 -6.04095981e-02 -3.42933536e-02  5.48482165e-02
 -2.96640955e-02 -3.62006836e-02 -1.53949223e-02  7.10225780e-04
 -1.77820269e-02 -6.14410453e-02  2.90118158e-02 -6.09585717e-02
  1.70208123e-02  7.18477294e-02 -6.82123471e-03 -5.49976751e-02
  1.21553405e-03 -9.97384544e-03  3.09849600e-03 -2.23686304e-02
  1.26043726e-02 -1.88491698e-02  3.77467275e-03 -1.12911854e-02
 -6.26730472e-02  7.68665746e-02 -1.68965720e-02  2.27437820e-02
 -1.75655019e-02 -6.77148812e-03 -1.82986557e-02  3.46619412e-02
  2.12931801e-02  2.76442822e-02 -4.14113365e-02 -3.42238136e-02
  7.60981301e-03  1.87782515e-02  6.95163533e-02  6.58975821e-03
 -2.01083887e-02  9.79880057e-03  3.08772586e-02  6.08342402e-02
  5.67520447e-02  2.06792057e-02  2.83812750e-02 -9.19335708e-03
  7.32692145e-03  5.89691363e-02 -2.42560077e-02  2.87439656e-02
 -3.30735259e-02  5.97288972e-03 -3.18467692e-02  2.17341054e-02
 -4.54690084e-02 -3.36525068e-02 -4.57997434e-03  2.25438401e-02
  2.65166275e-02 -2.97107175e-02  5.90116456e-02  3.74157652e-02
 -3.27466428e-02  6.20647483e-02  4.13066819e-02 -4.64212187e-02
  4.21676897e-02 -7.84574513e-05  6.88247290e-03 -1.46238077e-02
  2.86921896e-02  3.40969004e-02 -3.30990320e-03  1.18619986e-02
  2.75905766e-02  9.32477415e-02  1.14940695e-01  4.13482748e-02
  1.24025308e-02 -3.48734520e-02 -8.11951887e-03 -1.24930423e-02
 -2.25967169e-03 -4.31264564e-03 -2.83102933e-02  7.58466544e-03
  6.76480215e-03 -1.69523265e-02 -8.25734586e-02  4.69031222e-02
 -5.07761128e-02 -1.88078114e-03 -5.89709170e-02  1.30833022e-03
  1.11656282e-02 -1.91086140e-02  9.42914188e-03  7.37324636e-03
  2.75191497e-02 -1.92294884e-02  3.95862423e-02  5.12573235e-02
 -5.23474067e-02 -5.90482242e-02  3.47770634e-03 -1.48247462e-02
  1.45384176e-02 -3.36446986e-02  5.36450697e-03 -1.51403863e-02
  4.04096805e-02 -5.92213348e-02  5.68837374e-02  6.08727755e-03
  5.69193810e-02 -7.61779957e-03  8.46064370e-03 -4.15416770e-02
  5.18845096e-02 -2.08574496e-02  3.33945230e-02 -4.25330587e-02
 -3.32702097e-04  3.13390605e-02 -3.44947204e-02 -4.38924544e-02
  3.13210338e-02 -3.11168339e-02 -1.98195763e-02 -5.06271259e-04
  8.81106406e-03 -2.72400826e-02  4.23620604e-02  3.11361924e-02
 -7.28070736e-03 -7.32144201e-03  5.67998178e-02  5.94893992e-02
  1.38433808e-02  4.13213437e-03 -1.00586610e-02  7.36943865e-03
  3.80875878e-02 -1.08476030e-02  4.91142273e-02 -2.07491890e-02
 -6.15403382e-03  4.05805744e-02 -3.93669084e-02 -5.07536642e-02
  3.04701328e-02  4.22963500e-02  2.44986247e-02 -3.30968387e-02
 -6.14254326e-02  8.94646198e-02 -2.52880342e-02  4.36796900e-03
  1.23858014e-02 -6.69034198e-02  2.11695358e-02  6.06583059e-03
  6.34681880e-02  4.05613147e-02 -1.21574085e-02  8.32852907e-03
  2.91047487e-02  2.71089394e-02 -3.17794792e-02 -2.78249159e-02
 -4.85688820e-02 -1.11321406e-02 -3.58707011e-02 -4.31399308e-02
 -1.16517069e-02  7.65429661e-02  2.85568889e-02  1.03571936e-02
 -6.30435422e-02 -2.30583474e-02 -4.77169007e-02 -2.91242786e-02
 -1.46927256e-02 -3.23032233e-04 -2.22744104e-02  9.46047809e-03
 -2.37981565e-02 -4.53136303e-02  5.12788184e-02  1.68594299e-03
  6.20577077e-04 -9.26433951e-02  4.20751125e-02  7.27027142e-03
  6.56784931e-03  1.15557071e-02  1.94724910e-02 -1.70041993e-02
 -4.08029854e-02 -4.14960533e-02  3.22932601e-02  1.09477583e-02
  1.15578240e-02  3.99170406e-02 -4.00453098e-02 -1.12923728e-02
 -1.67451948e-02  2.23087929e-02 -1.13325780e-02  2.98789516e-02
  6.33508316e-05 -9.59688239e-03  1.98173095e-02  3.07589620e-02
 -5.85394502e-02  4.31608921e-03  7.46534318e-02  6.38787076e-02
 -3.71778011e-02  1.78993717e-02 -2.54198834e-02 -1.85253288e-04
  1.90492719e-02  4.24448168e-03  1.01457043e-02 -9.16799009e-02
 -1.50331547e-02  1.71506666e-02  3.35447257e-03  2.43405588e-02
 -1.43530173e-02 -1.34813031e-02  3.53372805e-02 -6.67894352e-03
 -3.71082537e-02  1.66135896e-02  7.15284944e-02 -4.05936465e-02
 -4.83417474e-02  4.79019769e-02 -7.12332083e-03 -5.48796207e-02
 -9.19440575e-03 -3.56096104e-02  7.20925396e-03  3.11587937e-02
 -8.11126269e-03 -2.23560873e-02  9.36986471e-04 -7.20042549e-03
  1.83012635e-02  3.62365656e-02  3.40624265e-02  2.13978020e-03
 -9.71249714e-02  2.34465096e-02  3.98623049e-02 -8.57309252e-02
 -2.46635880e-02 -1.72231463e-03 -1.27503909e-02 -3.18895676e-03
  2.51639187e-02  3.31788249e-02 -1.19000478e-02  3.63048492e-03
  2.57740300e-02  2.09535342e-02 -4.55341749e-02 -2.56833155e-04
 -5.24417013e-02  1.93408336e-02  2.83885896e-02 -4.24739067e-03
 -1.08753787e-02 -3.11863218e-02  4.40323129e-02 -5.55617660e-02
  1.31772161e-02 -3.86772119e-02  4.91325706e-02  3.74821201e-02
  1.15260519e-02  4.77992930e-04  1.90925074e-03  2.35607903e-02
  4.79270751e-03 -2.89993249e-02  4.67139222e-02 -4.46383357e-02
 -3.27777863e-02  2.47249305e-02  3.46759446e-02 -2.80728638e-02
  3.93852331e-02  4.33926061e-02 -3.91060412e-02  3.17122079e-02
 -4.27113362e-02 -4.30103671e-03 -4.15910669e-02 -5.06219594e-03
  3.40073109e-02 -4.58801277e-02 -4.40057255e-02 -6.89239874e-02
 -2.33881045e-02 -1.15135703e-02  6.92137778e-02  2.04344634e-02
  6.69726077e-03 -3.45424749e-02 -5.04740514e-02  3.61255333e-02
  4.75476421e-02  1.23884808e-02 -5.18679153e-03 -5.32450527e-02
 -4.97323973e-03 -2.45615933e-03 -5.84186651e-02 -3.29437628e-02
  1.64689142e-02 -4.90393788e-02 -4.79843840e-02  3.29873599e-02
  5.83425090e-02  3.69001590e-02 -1.58387963e-02 -2.89640035e-02
 -2.38415170e-02  6.90501509e-03 -4.55825292e-02  1.47714065e-02
  1.68096088e-02 -1.11691672e-02 -1.56598017e-02  3.74878640e-04
  9.85189527e-03  2.32460778e-02  1.58615895e-02  3.84926945e-02
  3.53688858e-02  2.41392124e-02  3.57847195e-03  5.59599465e-03
  3.81322764e-02  3.61136869e-02  2.44615879e-03 -5.82287498e-02
 -4.29788604e-02  2.83106212e-02 -1.62070859e-02  3.73859257e-02
  2.90296949e-03 -3.57219763e-02  2.14999244e-02  1.47755053e-02
  1.51822185e-02  1.00821285e-02 -2.63835732e-02 -1.43867014e-02
 -4.86981235e-02  6.30886666e-03  5.38021103e-02  3.28336768e-02
  5.11148246e-03  3.80497761e-02 -2.32273340e-02 -8.57405923e-03
 -1.83815677e-02  3.24471779e-02 -2.03318242e-03  7.21177906e-02
 -6.28255354e-03  3.62810604e-02  3.18553634e-02 -2.27784347e-02
 -1.31757148e-02 -1.87991317e-02 -3.61286029e-02 -1.81866065e-02
 -2.65806448e-03  7.71837076e-03  9.09027159e-02 -1.71563067e-02
 -4.72909911e-03 -1.13189844e-02  1.06668714e-02 -3.62130553e-02
 -1.97840277e-02  1.42729022e-02 -1.97026487e-02  2.68773157e-02
 -3.00854053e-02  2.82380134e-02  4.49509872e-03  1.05477646e-02
 -2.52654403e-02  1.80552322e-02 -2.29050517e-02 -3.30011249e-02
  1.85515117e-02 -2.36181971e-02 -3.75657156e-02 -1.10149262e-02
 -2.14291625e-02 -3.89177315e-02 -6.28917711e-03  2.72902511e-02
  2.41443757e-02 -1.59740560e-02  4.19822074e-02  5.22415973e-02
 -4.96171191e-02 -3.50095369e-02 -9.01032519e-03  3.09697017e-02
  7.85780139e-03 -7.51916226e-03 -1.45397801e-02 -6.23200599e-33
 -2.82459110e-02  1.88316796e-02  4.76256870e-02  1.34500982e-02
 -2.81206071e-02 -9.26787965e-03 -6.49642423e-02 -1.27968471e-03
 -4.30275090e-02 -3.24396119e-02  3.08593884e-02  1.89014443e-03
  2.22957265e-02  1.06321210e-02  1.56364292e-02  2.04138998e-02
  2.86657475e-02 -1.02781327e-02 -2.99731456e-02  1.58880129e-02
  4.54007573e-02  2.09262110e-02  1.50247395e-01  6.71053422e-04
  3.70704643e-02 -8.04094225e-03  3.95425549e-03 -2.22874116e-02
 -2.47088298e-02  1.06415972e-02 -1.14358426e-03  4.66671325e-02
  1.31630991e-02 -6.58414140e-02 -3.44416723e-02 -6.92089200e-02
 -4.15477566e-02 -1.62528586e-02  3.85301299e-02  2.85141915e-02
 -1.38223004e-02 -2.32754424e-02  6.89197481e-02 -2.41700709e-02
 -4.71608602e-02 -1.16028627e-02 -1.49974623e-03 -9.49809700e-03
 -7.21860379e-02  5.40307052e-02 -1.26858488e-01 -2.31721587e-02
  3.30419764e-02  7.53557216e-03  7.79175991e-03  6.92018196e-02
 -2.92230323e-02 -2.39004730e-03 -5.22827990e-02  2.81463563e-02
  3.80198993e-02  8.04293379e-02  5.23584969e-02 -3.17371264e-02
  6.04192168e-03 -6.07674383e-03  6.30183369e-02 -4.21795063e-03
  8.29011574e-02 -4.37402911e-02  9.04897973e-02 -2.21846495e-02
  6.23093881e-02  7.47826369e-03  7.03421608e-02  8.35577957e-03
 -1.63471289e-02 -6.89484878e-03  1.08938059e-02  1.03116222e-01
  4.75198291e-02  1.49547085e-02 -2.16454323e-02 -5.39414072e-03
 -1.14540970e-02 -4.67167124e-02 -1.80217847e-02 -3.88904400e-02
  1.63861196e-02  1.22427545e-03  1.30002340e-02 -9.90285818e-03
  8.25346708e-02  1.78702120e-02  6.39403239e-02  2.16865516e-03
 -2.73586456e-02  3.54758315e-02 -3.12686712e-02  2.22510900e-02
 -7.09301531e-02 -1.92077253e-02  3.18218465e-03  2.57598292e-02
 -5.40004484e-03  1.91177148e-02  2.62112282e-02 -9.06486157e-03
 -4.68348328e-04 -5.07325807e-04 -5.58931492e-02 -1.06286537e-02
  3.52494717e-02  5.43394424e-02  2.85570920e-02  4.07138094e-03
 -1.12500759e-02  3.31992134e-02  1.69468634e-02 -1.90789271e-02
 -5.10910228e-02 -3.48479790e-03  2.38640290e-02  5.78931645e-02
 -4.76117134e-02  2.30702106e-02 -2.96886750e-02  5.58453947e-02
  9.84519441e-03 -4.24711853e-02 -4.59861457e-02  4.79332618e-02
  2.56237399e-07  3.78324911e-02  2.07228623e-02 -7.19283242e-03
  4.51450869e-02  1.76340993e-03 -3.11802141e-02 -3.61710638e-02
  1.13217738e-02  6.76238164e-02  1.70463137e-02  7.68079003e-03
  2.34561432e-02  6.53576776e-02  2.43470855e-02 -1.32129909e-02
 -3.98119874e-02 -3.74715589e-02  5.78953959e-02 -5.51484600e-02
  3.19206668e-03  1.60203502e-02  7.65292645e-02 -4.08038087e-02
 -6.66596461e-03 -1.63850337e-02  4.37196605e-02  3.95432562e-02
  2.03735214e-02 -2.78920680e-02 -8.28932039e-03  1.75251011e-02
  3.32035050e-02 -2.03077830e-02  4.67376225e-02 -3.23608033e-02
 -1.60467252e-02  3.54140960e-02 -2.75033037e-03 -1.70742031e-02
 -2.16355566e-02  1.67983789e-02  2.07991302e-02 -1.38261020e-02
 -3.50033604e-02 -3.76899051e-03 -7.14464784e-02  2.49788500e-02
  6.53784797e-02 -3.65501642e-02  1.97654534e-02  2.09532231e-02
 -2.45389473e-02  1.39133474e-02 -2.57692952e-02  4.41549681e-02
 -4.00878908e-03 -5.39463796e-02  2.27714218e-02 -2.07857061e-02
  2.94035543e-02 -3.41351628e-02 -5.86446002e-02 -3.73906679e-02
 -5.75429853e-03 -5.95699027e-02 -9.61179100e-03 -1.31744863e-02
  2.13333031e-34  3.91670316e-02 -8.26084055e-03  5.27649038e-02
 -2.33106483e-02  1.26030929e-02 -3.40531021e-02 -1.81349069e-02
 -1.42155057e-02 -3.00090238e-02 -5.86736165e-02 -2.92686634e-02]"
"Table 4: The Transformer generalizes well to English constituency parsing (Results are on Section 23
of WSJ)
Parser
Training
WSJ 23 F1
Vinyals & Kaiser el al. (2014) [37]
WSJ only, discriminative
88.3
Petrov et al. (2006) [29]
WSJ only, discriminative
90.4
Zhu et al. (2013) [40]
WSJ only, discriminative
90.4
Dyer et al. (2016) [8]
WSJ only, discriminative
91.7
Transformer (4 layers)
WSJ only, discriminative
91.3
Zhu et al. (2013) [40]
semi-supervised
91.3
Huang & Harper (2009) [14]
semi-supervised
91.3
McClosky et al. (2006) [26]
semi-supervised
92.1
Vinyals & Kaiser el al. (2014) [37]
semi-supervised
92.1
Transformer (4 layers)
semi-supervised
92.7
Luong et al. (2015) [23]
multi-task
93.0
Dyer et al. (2016) [8]
generative
93.3
increased the maximum output length to input length + 300. We used a beam size of 21 and α = 0.3
for both WSJ only and the semi-supervised setting.
 Our results in Table 4 show that despite the lack of task-specific tuning our model performs sur-
prisingly well, yielding better results than all previously reported models with the exception of the
Recurrent Neural Network Grammar [8].
 In contrast to RNN sequence-to-sequence models [37], the Transformer outperforms the Berkeley-
Parser [29] even when training only on the WSJ training set of 40K sentences.
","[ 2.44070888e-02  5.87956235e-02  3.86341549e-02 -1.08416274e-03
 -3.47053148e-02  2.68918200e-04  2.39237770e-02 -3.28460485e-02
 -7.64280334e-02 -3.49670984e-02 -3.24635953e-02 -2.98484210e-02
  2.07599774e-02 -3.19955759e-02  2.88120527e-02 -5.48015125e-02
  4.89427224e-02  1.13403155e-02 -1.74228847e-02  2.20022332e-02
  3.70316789e-03 -8.51309765e-03 -2.30740383e-02  6.28489256e-02
 -6.57506362e-02 -1.16996542e-02 -2.27623098e-02 -2.19213367e-02
  2.66220584e-03 -1.11102490e-02  9.58784483e-03  3.50610949e-02
 -8.81044287e-03  3.12242880e-02  2.01079934e-06 -1.81109328e-02
 -1.21696591e-02 -1.57065073e-03  7.67580816e-04 -2.85600070e-02
  8.54817033e-02 -7.41960034e-02 -2.89908163e-02  6.28368091e-03
 -2.79411934e-02 -2.56781895e-02  6.66897446e-02  4.40363213e-02
  6.30771145e-02  1.11755997e-01 -1.14454208e-02 -7.52107650e-02
  5.78415617e-02 -1.05151096e-02 -1.80693838e-04 -2.16630604e-02
  5.31741371e-03 -4.28279936e-02 -2.72123720e-02 -6.71656709e-03
 -2.73308288e-02  9.75722354e-03  4.74838689e-02  3.99478991e-03
 -1.09665608e-02  1.80970915e-02 -4.00308035e-02 -9.66942403e-03
  3.14533524e-02  6.14829315e-03 -2.21384447e-02 -1.22949025e-02
  2.81667640e-03  3.71522680e-02 -7.94007815e-03 -1.39317298e-02
 -3.38911414e-02  6.09681010e-02  5.81768388e-03  6.83767255e-03
  6.71580583e-02  9.40711796e-03 -1.34958467e-02 -1.21907452e-02
 -3.55178230e-02  7.53724128e-02  8.96837655e-03 -4.62035649e-02
 -5.27524529e-03  4.46459986e-02  7.41134514e-04 -1.93099361e-02
  3.82751301e-02  1.31062455e-02 -1.25947685e-04  3.04130875e-02
 -1.77915823e-02 -8.67186636e-02 -1.90916881e-02 -4.48538363e-02
  3.04569807e-02  2.35403087e-02 -8.55582068e-04 -1.73170157e-02
  1.40570328e-02  3.96283269e-02 -3.04441843e-02  4.30751666e-02
 -5.46195656e-02 -2.51961797e-02 -6.41053841e-02 -4.18521510e-03
 -4.36280556e-02  2.72928048e-02 -5.26898615e-02 -1.02406023e-02
 -5.67983873e-02 -6.14372874e-03  1.86690129e-02 -1.28933112e-03
  8.75022113e-02  1.73713583e-02 -9.37761217e-02  1.04921758e-02
  5.82360371e-04  8.12842548e-02  6.94180140e-03  1.22345388e-02
  2.95095295e-02 -5.60451597e-02 -2.08797697e-02  3.64541188e-02
 -6.30445732e-03 -5.24417125e-02 -3.40034068e-02  2.62435935e-02
 -4.00292501e-02 -9.74475034e-03 -3.08361314e-02  4.26636683e-03
 -5.90458252e-02 -2.78010815e-02  4.12278175e-02 -6.40326738e-02
  2.28433125e-02 -2.50852108e-03  6.38177735e-05 -4.42069070e-03
 -7.15592830e-03  2.96266545e-02  5.38959093e-02  5.70918992e-02
  3.61809656e-02 -2.47549433e-02  6.22523995e-03  4.85872244e-03
  1.44834546e-02  4.76099104e-02  2.47359481e-02  2.74190325e-02
 -6.84572384e-03  6.64821418e-05 -3.04566976e-03  3.46428342e-02
 -3.57827954e-02 -3.60649936e-02 -2.06076317e-02 -2.22287327e-02
 -4.42468002e-03  1.42389014e-02  9.05735418e-02  2.06626337e-02
 -2.25540288e-02  3.27150035e-03  2.61268914e-02  3.74339446e-02
  5.38083501e-02  4.68973778e-02  5.65954261e-02  4.84497240e-03
 -1.36796627e-02  3.07945292e-02 -2.49468144e-02 -4.10532719e-03
  6.08280906e-03  3.39437313e-02 -7.86458701e-02  2.51170043e-02
 -1.19760074e-02 -8.91215727e-03  1.23253893e-02 -2.81172134e-02
 -1.27080912e-02 -3.28219011e-02  6.51470646e-02  5.86144440e-02
 -5.30601889e-02  1.13592401e-01  2.57498100e-02 -7.14011118e-02
  6.28390175e-04 -5.15272431e-02 -3.47680785e-02 -1.99193731e-02
 -7.21026445e-03 -2.70368531e-02 -2.33294442e-02 -8.37980211e-03
 -7.77290016e-03  5.52197136e-02  4.52783257e-02 -1.34653756e-02
  2.86532808e-02 -4.29408811e-02  4.94495826e-03  2.47721076e-02
  3.16952579e-02  1.86785907e-02 -7.31147686e-03 -3.54281254e-03
  2.00606827e-02 -4.75157835e-02 -3.17520322e-03  4.69143614e-02
 -9.86111164e-03 -1.43083790e-02 -5.10900840e-03  1.27722155e-02
  5.38893864e-02  1.14220176e-02  2.30074935e-02  1.29145207e-02
  2.26125401e-02 -5.75514138e-02  4.56496365e-02  2.39068568e-02
 -1.00015134e-01 -5.14732674e-02  1.99861685e-03 -2.37744935e-02
 -7.81981624e-04  6.97379261e-02 -2.58392636e-02 -4.92486544e-02
  1.55524267e-02 -4.19721641e-02  4.64550452e-03 -2.32211202e-02
  1.97831113e-02  2.54875049e-02  1.45788537e-02 -3.62009965e-02
  4.64513451e-02  3.30618792e-03  3.08879977e-03 -3.19741853e-02
 -2.30097286e-02 -9.06757545e-03 -2.99979467e-02 -1.30908089e-02
 -7.08556501e-04 -2.05219984e-02 -1.43514620e-02 -1.66262966e-02
 -1.11234058e-02 -4.21075001e-02 -6.93063214e-02 -4.17188965e-02
 -2.04684166e-03 -3.54484953e-02  5.50124757e-02  4.13249806e-02
  1.13667017e-02  3.08055803e-02  1.48954960e-02 -2.88984720e-02
 -6.99606445e-03  1.32755551e-03  1.22328312e-03  3.80056836e-02
  1.21213365e-02  7.72574311e-03 -4.91900630e-02 -4.36887406e-02
 -3.26754153e-02  3.62594686e-02 -6.70834538e-03 -2.44556479e-02
 -4.78871688e-02  3.43173184e-02  5.00685126e-02  2.88739409e-02
 -9.89709282e-04 -5.06668687e-02  1.78745799e-02 -4.01638076e-02
  7.81565905e-02  6.56762570e-02  7.05530308e-03 -1.79816727e-02
 -2.88973451e-02 -2.78268978e-02 -5.07721156e-02  1.23747401e-02
 -9.31753311e-03 -4.57443809e-03 -7.15781450e-02 -1.28447367e-02
  4.16187458e-02  9.28444639e-02 -9.98078194e-03  4.20792215e-03
 -1.66206062e-02 -2.86728851e-02 -1.26322079e-02 -1.55872097e-02
  4.24139202e-02 -3.10145821e-02 -5.77633567e-02 -2.44755335e-02
 -1.25830444e-02  3.89588699e-02  1.15203978e-02 -4.65959273e-02
 -2.93839835e-02 -9.44350585e-02  1.26178944e-02 -2.79273018e-02
  4.94135320e-02  4.12613712e-02 -6.35891501e-03  2.62446385e-02
 -6.45389631e-02 -2.94676833e-02  8.17422103e-03 -1.77663993e-02
  2.68614059e-03  6.70748129e-02 -2.47731730e-02  1.20421564e-02
 -6.06715605e-02 -2.89210249e-02 -2.53887475e-02 -1.60417967e-02
 -1.23906070e-02  2.55092066e-02  4.06152979e-02 -3.89660336e-03
 -2.72801667e-02  2.17991304e-02  3.92112648e-03  7.34002739e-02
 -2.45570876e-02  1.77133828e-03 -2.78735124e-02  3.87009084e-02
 -2.13797018e-03  4.71343696e-02  1.65983476e-02  7.87460338e-03
  1.96771091e-03  3.04742064e-02  2.60414742e-02  8.49257782e-03
 -8.62833634e-02 -2.10627895e-02  2.95005012e-02 -6.88152015e-02
 -4.13547494e-02 -9.81463958e-03  8.80929306e-02 -8.47146660e-02
 -4.33352590e-02  9.88719761e-02 -7.63201993e-03 -8.35158676e-02
 -2.66567105e-03  1.04799848e-02 -1.25894733e-02  8.02549813e-03
  1.18400017e-02 -4.51446176e-02 -2.16118414e-02  2.71608513e-02
  3.64609249e-03  4.09883894e-02 -4.15787809e-02  1.41393822e-02
 -1.39374778e-01  2.27692556e-02 -1.03504444e-02 -1.15732970e-02
 -9.84689221e-03 -1.16348155e-02 -3.82378399e-02 -5.38257696e-02
  1.05048846e-02  3.30374315e-02 -3.35583016e-02  2.38934550e-02
  2.37361435e-02 -2.23972201e-02 -4.79766466e-02 -5.56374155e-03
 -4.78841811e-02  1.48274451e-02  7.06116855e-02  3.57152475e-03
 -7.60738598e-03 -3.97579558e-02  5.88590093e-02 -3.95486429e-02
  1.43849095e-02  6.63736509e-03  8.26702733e-03 -3.56889679e-03
 -1.81257837e-02 -3.15247364e-02  1.36517594e-02 -1.37628736e-02
 -4.74793231e-03 -4.68398584e-03  3.13921310e-02 -4.07066371e-04
  2.66225729e-02  1.90035384e-02  1.60623025e-02  1.76451672e-02
  4.67950925e-02  2.58794874e-02 -8.56353529e-03 -4.86580171e-02
 -2.09376160e-02  3.08977347e-02 -7.96000361e-02 -2.10357122e-02
  1.56418756e-02  1.95499007e-02 -3.27402428e-02 -8.45944658e-02
 -4.86587845e-02 -5.69586689e-03  5.12300283e-02 -1.62118878e-02
 -4.78784852e-02  2.88163628e-02 -1.53484279e-02  4.41924017e-03
  2.79206410e-02  6.20221393e-03  2.01471653e-02 -3.47315483e-02
  5.65186515e-03  4.98541594e-02  3.13769840e-02 -1.98382959e-02
 -4.79979329e-02 -4.01162021e-02 -8.19531828e-03  6.76204041e-02
  4.37895283e-02  1.65621471e-02  1.33150052e-02 -2.30327789e-02
  1.78133638e-03 -3.14048342e-02  5.38277812e-02 -6.25390783e-02
 -1.86591577e-02  3.46599780e-02  1.05806869e-02 -9.86159127e-03
  1.80732198e-02  1.54751381e-02  3.86583880e-02  9.66087682e-04
  2.90550478e-02 -3.53502966e-02  1.50602069e-02  2.68581845e-02
 -4.50235931e-03  6.45182654e-02  9.50253394e-04  4.29671556e-02
 -7.13556819e-03 -1.17314910e-03 -2.84374971e-02  1.66750308e-02
 -1.69768855e-02  9.71113518e-03  3.61297317e-02  1.02342553e-02
  1.19718257e-02  3.61057408e-02  1.83535423e-02  3.09343431e-02
 -3.16060856e-02  6.41741157e-02  3.14420238e-02  1.20326877e-02
 -3.52519229e-02  1.91430356e-02 -1.93079431e-02 -2.75775939e-02
  1.42476326e-02  3.04918401e-02 -2.68999860e-02  3.84925343e-02
  1.38231879e-02  2.39029285e-02 -2.79071350e-02  2.70798523e-02
 -5.62505983e-02  6.82662576e-02 -7.95184076e-03 -6.27408642e-03
  4.81394678e-02 -3.05670965e-02  4.95986231e-02  3.04221618e-03
 -8.37620907e-03  2.04105712e-02  8.40167981e-03 -1.29914759e-02
  2.86654122e-02  5.00812158e-02 -3.34005640e-03  1.93084637e-03
 -5.78962490e-02  5.39434105e-02  1.75590068e-02  2.19341367e-02
  3.43608670e-02  1.63739771e-02 -4.71786410e-02 -5.80325574e-02
 -2.09879763e-02 -1.70293618e-02 -3.85366715e-02 -1.76752508e-02
 -7.92659726e-03 -1.13979802e-02  1.53814955e-02 -6.30995119e-03
  1.98331736e-02 -1.44842621e-02  3.91431265e-02  2.88087968e-02
 -1.19826719e-02 -5.14129996e-02 -1.47273927e-03  1.21335089e-02
  4.50203121e-02 -2.68637389e-02 -2.25748997e-02 -5.83390573e-33
 -4.68859226e-02  4.09511663e-02  1.69804972e-02 -9.43499152e-03
 -5.08348793e-02 -2.39715353e-02 -3.55126187e-02 -4.05319221e-03
 -1.46801425e-02  5.89763559e-03 -3.14421095e-02 -1.02107981e-02
  4.14039828e-02  6.99461922e-02  6.26214519e-02 -4.46239673e-03
  5.66226244e-02 -5.31748543e-03  3.77564901e-03 -1.15814721e-02
  1.87784974e-02  4.98401932e-02  8.08665976e-02  9.41441220e-04
 -1.88391637e-02  1.43256290e-02 -2.17463523e-02 -4.55208635e-03
 -5.46661066e-03  3.48203219e-02  1.66174918e-02  1.53686302e-02
  1.71233844e-02 -9.00206342e-02 -4.53404561e-02  5.95266856e-02
 -1.13173515e-01  8.97189602e-03 -1.25388578e-02  4.69233468e-02
 -2.81476900e-02 -4.55214940e-02  5.87493591e-02 -2.82219728e-03
 -2.05880329e-02 -1.76465791e-02  3.07116266e-02 -4.49813008e-02
 -6.68120477e-03 -2.99099665e-02 -6.54706284e-02  1.00975195e-02
  1.41160917e-02  2.19995659e-02  2.54978463e-02  3.31083126e-02
 -6.90852152e-03  5.31734433e-03 -1.03516087e-01 -2.76541319e-02
 -2.31085699e-02  1.13573104e-01 -8.01725499e-03 -5.81162749e-03
 -5.21917827e-03 -1.24583598e-02  4.15649116e-02 -2.64294222e-02
 -1.60864331e-02  1.62681621e-02  1.66771933e-02  2.30308771e-02
  4.96686362e-02  8.48931912e-03  5.50213680e-02 -1.14200087e-02
 -4.18987013e-02  8.48538894e-03  2.05231067e-02  9.65562165e-02
 -2.53127859e-04 -7.42265489e-03  1.55671744e-03 -1.91819947e-02
  1.52225224e-02 -2.98252404e-02 -1.81021914e-03 -8.87382124e-03
  2.09881887e-02  2.40345038e-02  2.93500368e-02  4.56627943e-02
  4.13915366e-02 -3.69298793e-02  3.11326161e-02  1.28409406e-02
  7.35287264e-04  3.03379726e-02 -4.46993597e-02 -1.76480394e-02
 -7.09562972e-02 -1.98290665e-02  3.99150793e-03  6.91393316e-02
  2.86880974e-03  1.95864402e-02  5.21529280e-02  2.91056503e-02
 -6.40103668e-02 -1.71443576e-03 -4.50106189e-02  3.18551920e-02
  2.76485516e-04  1.03452720e-01  3.16910371e-02 -1.74956974e-02
 -5.48687065e-03  5.96663952e-02 -1.07125184e-02 -6.81289239e-03
  2.29245075e-03 -1.13446210e-02  2.15393249e-02  2.73961294e-02
 -3.36323492e-02  2.39389408e-02 -2.15573534e-02  2.72661783e-02
  3.20183821e-02 -5.82273630e-03 -5.59684401e-03  1.76239554e-02
  2.66104479e-07  4.00358252e-02  1.48790563e-02  5.60231879e-02
 -1.12547744e-02  1.14338631e-02  6.56053936e-03  6.06091507e-03
  3.88487019e-02 -2.38376800e-02 -1.10879224e-02 -2.17638053e-02
 -1.67692211e-02  3.63216735e-02  8.04824010e-03 -1.09641805e-01
 -3.46967429e-02 -8.21982771e-02  2.70607956e-02 -3.33183520e-02
  2.15954557e-02  1.45353442e-02  1.15527369e-01 -1.99558958e-02
 -4.33369167e-02 -1.22718271e-02  4.11668513e-03  1.08883521e-02
  2.60486566e-02 -1.09485174e-02  3.72982845e-02  1.38586210e-02
 -1.30360061e-02 -4.68718674e-04  3.00557632e-03 -2.01371238e-02
  2.47164872e-02 -4.37134020e-02  6.62195534e-02 -4.15084092e-03
 -1.00717191e-02  3.12178377e-02  8.05353187e-03 -2.71023164e-04
 -1.67033169e-02  3.67394537e-02 -8.95116702e-02 -1.86543465e-02
 -1.04888007e-02 -3.45941447e-02  3.65388766e-02 -5.35570942e-02
  7.66761228e-03  1.61473975e-02  1.04689354e-03  3.43559086e-02
 -2.39569936e-02 -3.00021060e-02 -4.27500606e-02 -3.44030224e-02
  1.90132186e-02 -3.47606689e-02  5.68802701e-04 -2.39909533e-02
  1.00283008e-02  2.34214775e-02 -3.16638090e-02 -5.39371222e-02
  2.49036261e-34  9.65608750e-03  2.01718099e-02  2.29577981e-02
  3.57614197e-02 -4.63587232e-04  5.94822783e-03 -6.05892874e-02
  1.69394780e-02 -8.51097237e-03 -7.56156668e-02 -4.12694737e-02]"
"7
Conclusion
In this work, we presented the Transformer, the first sequence transduction model based entirely on
attention, replacing the recurrent layers most commonly used in encoder-decoder architectures with
multi-headed self-attention.
 For translation tasks, the Transformer can be trained significantly faster than architectures based
on recurrent or convolutional layers. On both WMT 2014 English-to-German and WMT 2014
English-to-French translation tasks, we achieve a new state of the art. In the former task our best
model outperforms even all previously reported ensembles.
 We are excited about the future of attention-based models and plan to apply them to other tasks. We
plan to extend the Transformer to problems involving input and output modalities other than text and
to investigate local, restricted attention mechanisms to efficiently handle large inputs and outputs
such as images, audio and video. Making generation less sequential is another research goals of ours.
 The code we used to train and evaluate our models is available at https://github.com/
tensorflow/tensor2tensor.
 Acknowledgements
 We are grateful to Nal Kalchbrenner and Stephan Gouws for their fruitful
comments, corrections and inspiration.
 References
[1] Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E Hinton. Layer normalization. arXiv preprint
arXiv:1607.06450, 2016.
 [2] Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio. Neural machine translation by jointly
learning to align and translate. CoRR, abs/1409.0473, 2014.
 [3] Denny Britz, Anna Goldie, Minh-Thang Luong, and Quoc V. Le. Massive exploration of neural
machine translation architectures. CoRR, abs/1703.03906, 2017.
 [4] Jianpeng Cheng, Li Dong, and Mirella Lapata. Long short-term memory-networks for machine
reading. arXiv preprint arXiv:1601.06733, 2016.
 10
","[-2.50826881e-04  4.66586687e-02  1.14947259e-02  4.84716408e-02
 -9.57946759e-03 -1.34615796e-02  3.26771475e-02 -3.25993188e-02
 -3.35124210e-02 -1.82943363e-02 -5.21771610e-02 -3.56858596e-02
  2.89206505e-02  1.79153960e-02  3.00231446e-02 -6.09779730e-02
  1.04260482e-02  5.76507114e-03 -3.76128331e-02  4.18514349e-02
 -1.61882043e-02  3.31082963e-03  3.82182412e-02  4.98743393e-02
  1.65834595e-02  2.11001411e-02 -9.88834724e-03  1.58919580e-02
  3.86936143e-02 -1.84129253e-02  4.46283398e-03  5.73624559e-02
  3.00339162e-02  6.01331927e-02  2.26070642e-06  9.40430723e-03
 -4.89434600e-03 -3.02106161e-02  5.22601306e-02 -2.03972738e-02
 -1.42386826e-02 -6.77229986e-02 -3.88940163e-02  1.13997692e-02
 -2.80379932e-02 -6.54871436e-03  4.42250259e-02  4.28230986e-02
  6.36360198e-02  9.13924426e-02 -1.37476679e-02 -5.11661097e-02
  1.67580205e-03 -6.64628670e-02  9.34262481e-03 -2.85238475e-02
 -1.40562030e-02 -4.83392589e-02 -3.55931297e-02  1.52677083e-02
 -4.89817895e-02  5.58037162e-02  4.96777110e-02 -2.99203140e-03
  3.56922038e-02  3.41285802e-02 -3.48681142e-03 -5.29394634e-02
 -2.70674601e-02  7.88997561e-02 -7.40741044e-02 -2.82839756e-03
 -1.15974769e-02  1.45896850e-02 -1.44739961e-03 -4.78224605e-02
 -4.14764956e-02  3.07341758e-02  5.67706116e-03  2.82330476e-02
  1.44820008e-02  3.68526950e-02  1.24489758e-02 -4.07515168e-02
 -2.22164039e-02 -3.52940112e-02  1.04669519e-02 -1.03775710e-02
 -1.93732306e-02  3.08089238e-02  5.59082255e-03 -3.96811105e-02
  5.86326942e-02  5.08196540e-02  1.68452002e-02 -1.35836713e-02
 -4.05884124e-02 -7.06098303e-02 -2.04738230e-02 -5.61258383e-02
  4.39546593e-02  5.73446564e-02 -2.53880564e-02  3.03018726e-02
 -2.57695392e-02  8.98001641e-02 -3.06015853e-02 -7.39937834e-03
 -7.26934895e-02  1.91950239e-02 -9.89515521e-03  4.23357710e-02
 -3.58859487e-02 -2.12928746e-02 -4.56226841e-02 -3.24258022e-02
 -2.16299910e-02  1.06743816e-02  2.37380061e-02  3.53957480e-03
  3.41852047e-02  2.41231956e-02 -7.12390840e-02 -2.02652719e-02
  2.80994829e-02  7.04939514e-02 -4.65026079e-03 -2.23776028e-02
  2.63409372e-02 -4.67804223e-02 -5.24991192e-02  4.29445282e-02
  7.32259406e-03 -1.21348817e-02 -9.50940233e-03  7.22939149e-02
 -5.27271479e-02 -4.78166342e-02  1.16818892e-02  6.57652086e-03
 -2.56074946e-02 -5.78396656e-02  2.84260772e-02 -4.91597354e-02
  4.71386313e-02 -1.52549269e-02 -9.73027479e-03 -4.65831868e-02
  2.37229411e-02  7.47525180e-03 -1.72635280e-02  4.94277887e-02
  3.05764191e-02 -1.56112304e-02  4.27846909e-02  2.02668495e-02
  1.06651364e-02  2.60909218e-02  5.62429577e-02  4.92390171e-02
 -1.60494708e-02 -2.18220502e-02  3.10631935e-02  5.90854473e-02
 -8.02238472e-04 -4.41923458e-03 -3.12994272e-02 -2.38080863e-02
 -1.72805227e-02  3.00652441e-02  6.21603541e-02  4.29081060e-02
 -9.94252507e-03 -9.31636151e-03  6.48252219e-02  1.01310806e-02
  2.22662631e-02  4.25880887e-02  5.17134964e-02 -2.25736108e-03
 -3.44913229e-02  2.57951170e-02 -4.75458205e-02  9.20115411e-02
  6.52784714e-03 -9.79694352e-03  3.15343849e-02  4.20076288e-02
 -4.62744907e-02 -2.69254241e-02  2.72324737e-02 -1.85507480e-02
  1.71237607e-02 -2.96025258e-02  3.02840266e-02  3.48203816e-02
 -7.95930922e-02  3.42885479e-02 -2.20348909e-02 -4.52141277e-02
  2.02248991e-02  2.97132903e-03 -2.03126948e-02  5.68446890e-02
  3.25550847e-02  3.92310927e-03 -3.47942375e-02 -2.59470791e-02
 -8.95119272e-03  5.80534190e-02  1.63652115e-02  3.49797979e-02
  1.39569128e-02 -7.00465515e-02 -3.59013081e-02 -1.82293775e-03
 -9.21288040e-03  2.06379052e-02 -2.57892348e-02  1.69133004e-02
  4.17333320e-02  1.54858129e-02 -3.35048400e-02  2.95436420e-02
 -2.22595856e-02 -6.17775694e-02  3.27818608e-03  1.92004200e-02
  1.70286857e-02  1.35578951e-02 -3.14210751e-03  1.83186252e-02
  2.29484700e-02 -6.19897470e-02  4.19027871e-03  4.45673168e-02
 -7.49336183e-02 -5.23758382e-02  7.88414478e-03 -7.32545331e-02
 -8.33894778e-03  3.53584029e-02 -2.53459737e-02 -6.54839948e-02
  4.01591286e-02 -4.98782843e-02 -2.05821097e-02 -1.59961022e-02
  2.04860605e-02  4.61260751e-02  3.95841189e-02 -2.91418144e-03
  1.81792434e-02 -2.95936819e-02 -4.76335036e-03 -1.63580794e-02
 -1.71107817e-02  4.19647200e-03 -2.22223215e-02  1.04855150e-02
  2.80543361e-02 -1.08545450e-02  1.57487076e-02  4.14461866e-02
  2.11086199e-02 -1.59225296e-02 -3.97406146e-02 -4.52420861e-02
  2.49487218e-02 -3.22811231e-02  3.59012447e-02  2.76333056e-02
  3.59312333e-02  2.24430226e-02 -2.33481769e-02 -4.52373177e-02
  7.58124376e-03  1.44481827e-02 -1.36448322e-02  3.45712416e-02
 -2.49426682e-02  1.21993301e-02 -3.71485911e-02 -1.57714244e-02
  1.83260329e-02  2.94674356e-02  6.93350006e-03 -2.93896124e-02
 -3.85155044e-02 -2.49934960e-02  5.34935668e-03  2.41519455e-02
 -1.40286898e-02 -6.93013445e-02  6.62978925e-03 -4.39720601e-03
  5.80556467e-02  7.07696229e-02  2.11829375e-02  1.88003033e-02
  9.20392945e-03 -1.21371057e-02 -1.71149410e-02  3.35135050e-02
 -7.40852160e-03  7.19117001e-03 -1.86207816e-02 -3.99610475e-02
  7.58651085e-03  8.33984986e-02 -1.14665236e-02  3.14052254e-02
 -7.53969923e-02 -2.14123931e-02  1.28184306e-02 -1.18417162e-02
  1.86778232e-02  5.32940263e-04 -2.53988504e-02  1.06208969e-03
 -2.40061153e-02 -2.98067145e-02  3.16705741e-02 -2.36607753e-02
 -4.55607548e-02 -4.54344563e-02  1.23094339e-02 -2.03073099e-02
  5.69720566e-02  2.81182323e-02  2.31407862e-02  1.43409856e-02
 -2.75798775e-02 -3.01651359e-02  1.57432351e-02  2.98025203e-03
 -1.63307339e-02  6.81962967e-02 -2.22128388e-02 -3.04459166e-02
 -5.05740382e-02 -3.11702602e-02 -3.12160719e-02  2.10558921e-02
 -3.58925536e-02 -7.00302282e-03 -1.39370537e-03 -4.10663113e-02
 -8.41448307e-02 -1.04721934e-02  3.06553319e-02  9.30930674e-02
 -2.21145377e-02  1.05192401e-02 -1.67616550e-02  5.17657958e-02
  7.96387624e-03  3.77586633e-02 -1.45435510e-02 -4.02366482e-02
  3.72025408e-02  5.49756624e-02  1.63738709e-02  3.27723823e-03
 -4.22969460e-02  6.73980685e-04  1.89542249e-02 -1.85517129e-03
 -3.63360834e-03  3.31925438e-03  6.75889924e-02 -8.56268480e-02
 -2.13010591e-02  1.12915702e-01  1.95487146e-03 -4.62690853e-02
 -9.61554050e-03  2.71304995e-02 -2.26756278e-02  1.23682814e-02
  6.57862984e-03 -4.05386351e-02 -5.63442446e-02  1.24040467e-03
  1.62081067e-02  5.43266051e-02  1.09542971e-02  3.85391945e-03
 -4.73505855e-02  5.04560657e-02  5.27358390e-02 -6.10656738e-02
 -6.32132292e-02 -1.23771522e-02 -1.90239549e-02 -2.27834228e-02
  1.27426451e-02  1.18748536e-02  1.99228302e-02 -5.19445026e-03
 -8.62647034e-03  1.10324807e-02 -5.40123768e-02 -8.20583943e-03
 -5.32318689e-02  2.03887522e-02  7.76822045e-02  2.83947829e-02
  4.48031211e-03 -4.59400415e-02  1.80436950e-02  1.13218902e-02
  3.20242606e-02  6.67503709e-03  3.25090550e-02 -5.74696995e-03
 -2.34527588e-02 -5.70556440e-04  3.01749911e-02 -6.28671348e-02
  3.34716365e-02  1.67462323e-02  7.03521743e-02 -3.77501547e-03
 -3.83874178e-02 -3.27333808e-02  2.01886278e-02 -5.36799431e-03
  6.07621931e-02  3.94515619e-02 -5.58639318e-02 -3.32813449e-02
 -2.77329050e-02  9.41740908e-03 -1.10241465e-01 -4.96223122e-02
 -3.66662932e-03  2.46093180e-02 -7.10002631e-02 -7.71315992e-02
 -6.78755268e-02 -6.73014950e-03  4.79745073e-03  1.57233630e-03
 -3.82492878e-02  2.92384624e-02 -2.05749534e-02 -2.88929697e-02
  3.08003295e-02  1.08870480e-03 -3.02734179e-03 -5.86981028e-02
  2.58693490e-02  2.10360717e-02 -1.31028900e-02  1.10064354e-02
  5.46059273e-02 -1.03137143e-01 -3.64498459e-02 -3.13220806e-02
  7.56737217e-02  8.76531005e-03  2.84950025e-02 -1.64051056e-02
 -1.20542403e-02  1.17884194e-02  1.74296182e-03 -3.62640284e-02
 -3.66532663e-03  3.84709835e-02 -5.25997616e-02 -3.31032611e-02
  3.25571448e-02 -4.85094613e-04  4.41474579e-02  1.60666816e-02
  3.25531773e-02  2.28522695e-03 -5.01903258e-02  9.66129592e-05
 -3.75838391e-02  4.11400460e-02 -7.04405422e-04  4.73418981e-02
 -9.97711625e-03  2.35295063e-03  1.53645920e-02  8.82559549e-03
 -6.27651289e-02  2.72406405e-03  5.29291108e-02  1.29220821e-02
  1.33706424e-02  2.00193916e-02 -1.66906638e-03 -5.01215197e-02
 -3.11857034e-02  6.57684654e-02 -3.18179466e-02  2.13798247e-02
 -5.86510496e-03 -4.46097041e-03 -7.75289396e-03  2.25128233e-03
  3.87242716e-03  1.96749736e-02 -1.95328575e-02  4.45799008e-02
  2.80758496e-02  5.73379621e-02  1.10363765e-02  3.13077271e-02
 -3.65333781e-02  1.34224864e-02 -3.41151580e-02  1.94713695e-03
  7.41932243e-02 -2.01276764e-02  7.56114721e-02  1.67393647e-02
  2.58840411e-03 -3.59071270e-02  4.91518453e-02 -2.23210584e-02
 -3.02304234e-02 -1.92954373e-02 -1.38867209e-02  1.44067053e-02
 -5.25659602e-03  6.93271682e-02 -3.30086611e-02 -9.74637456e-04
  4.61199358e-02  1.58506744e-02 -6.73740879e-02 -1.26096932e-02
 -3.77851119e-03 -4.46359701e-02 -2.03198791e-02  1.35815106e-02
  1.55392988e-02 -4.29136902e-02  2.60536578e-02 -1.57807749e-02
  4.00254270e-03 -3.75196012e-03  3.10102720e-02  2.93352716e-02
 -2.85900850e-02 -3.64917191e-03 -5.65739023e-03  2.16461383e-02
 -3.06377020e-02 -6.31054118e-02 -2.78665815e-02 -6.50175697e-33
 -1.17989862e-03  3.30406288e-03 -6.89538941e-03 -4.16493714e-02
 -4.65519875e-02 -1.54638467e-02 -6.51312396e-02 -3.57049005e-03
 -1.61202271e-02  4.38590650e-04 -1.02661736e-02 -1.08118290e-02
  2.81431386e-03  5.28610349e-02  4.69451509e-02  1.44115053e-02
  7.32355863e-02 -2.16441434e-02 -4.23090495e-02  3.83527838e-02
  1.62867866e-02  3.53642926e-02  9.15563852e-02 -1.23992963e-02
 -2.75262110e-02 -2.92919646e-03 -1.86919924e-02 -6.86937128e-04
  2.38676444e-02  1.62578262e-02  5.83514851e-03  8.47267080e-03
  1.07773580e-02 -7.86124542e-02 -5.59669882e-02  3.79268341e-02
 -1.03833996e-01 -2.76435930e-02 -5.26562668e-02  2.87652984e-02
 -6.88476786e-02 -3.83229144e-02  7.50505105e-02 -2.14950293e-02
  1.45688537e-03 -3.24525200e-02  1.39426161e-02 -2.72703990e-02
 -1.18766613e-02 -2.73783458e-03 -5.85093834e-02  1.21092126e-02
 -2.98290644e-02 -3.86570245e-02  4.76298891e-02  6.94046244e-02
 -9.16577503e-03 -9.58527531e-03 -9.76469889e-02 -5.69105800e-03
  2.74570571e-04  6.76967055e-02  6.01385683e-02  2.96104746e-03
 -3.15298624e-02 -9.69517231e-03  8.18304904e-03 -3.13361287e-02
 -4.72120941e-02 -1.71678397e-03  1.15956664e-02  1.58024505e-02
  8.03224444e-02 -2.16536354e-02  2.36060359e-02 -4.12602117e-03
 -3.57454419e-02  4.97265346e-02 -6.59572845e-03  3.68616469e-02
  3.71658355e-02  2.90586241e-02  3.08097107e-03  1.80286746e-02
  1.12424907e-03 -1.88645478e-02 -1.15650501e-02 -1.72168184e-02
  3.73874977e-03  4.37575988e-02  1.42377149e-02 -6.87828055e-03
  6.85337633e-02 -5.40655293e-03  5.58777824e-02  2.45968197e-02
 -1.63868461e-02  1.60212442e-02  8.71550012e-03  3.22112888e-02
 -5.19337431e-02 -7.48789753e-04  5.18989079e-02  3.86062004e-02
 -1.51769388e-02  1.10253748e-02  3.58645469e-02  4.83545512e-02
 -3.49148922e-02 -2.41378415e-02 -5.75221665e-02  3.82657610e-02
 -8.45232280e-04  6.69086725e-02  2.76006814e-02 -2.32474450e-02
 -3.00587434e-02  3.80333774e-02 -2.31554564e-02 -3.42671038e-03
 -2.87030358e-02  4.21388410e-02  1.85454655e-02  3.54383327e-02
 -3.49153988e-02  4.09677476e-02 -7.12578371e-02  2.32319776e-02
  3.04364767e-02 -4.05309238e-02 -3.71568315e-02  3.57828513e-02
  2.89072631e-07  3.03854886e-02  1.57902222e-02  5.19112833e-02
  1.38745317e-02  2.91225705e-02  3.25294919e-02 -2.98765078e-02
  6.31971285e-02 -8.22299346e-03  1.64800230e-02  2.83348113e-02
  1.50091518e-02  6.43113405e-02 -8.21821392e-03 -5.50281927e-02
 -3.00514270e-02 -6.64229542e-02  3.19673866e-02 -3.29225101e-02
 -4.12805518e-03  1.17914099e-02  1.08433574e-01 -1.10389078e-02
  8.78465641e-03  2.61106174e-02 -1.27469357e-02  5.75367734e-02
 -3.12323612e-03  1.91313699e-02 -1.28241153e-02  2.74796262e-02
  1.69272460e-02 -7.51125887e-02 -2.73780394e-02 -3.98543626e-02
  4.63264342e-03  2.12835837e-02  5.58278672e-02 -1.34805618e-02
 -3.23292986e-02  1.06057487e-02  9.57765710e-03 -2.08295183e-03
 -6.00915030e-02  2.10552700e-02 -6.78182319e-02 -2.53823847e-02
  1.88584365e-02 -2.87386440e-02  4.94853258e-02  3.16583142e-02
 -2.19473038e-02 -1.71460689e-03  1.74161736e-02  6.35215566e-02
  2.66999216e-03 -1.04407948e-02 -5.74414730e-02 -2.88285241e-02
 -2.18660273e-02 -4.53886762e-02  2.61985380e-02 -8.75244513e-02
 -1.04423612e-02  1.25595303e-02  2.09474582e-02 -3.90058607e-02
  2.49176287e-34  1.54567370e-02 -2.91537009e-02  9.74139478e-03
 -7.05418130e-03  6.73683034e-03 -2.87684519e-02 -4.46504615e-02
 -4.81045665e-03  3.32394941e-03 -5.42155206e-02 -5.07385731e-02]"
"[5] Kyunghyun Cho, Bart van Merrienboer, Caglar Gulcehre, Fethi Bougares, Holger Schwenk,
and Yoshua Bengio. Learning phrase representations using rnn encoder-decoder for statistical
machine translation. CoRR, abs/1406.1078, 2014.
 [6] Francois Chollet. Xception: Deep learning with depthwise separable convolutions. arXiv
preprint arXiv:1610.02357, 2016.
 [7] Junyoung Chung, Çaglar Gülçehre, Kyunghyun Cho, and Yoshua Bengio. Empirical evaluation
of gated recurrent neural networks on sequence modeling. CoRR, abs/1412.3555, 2014.
 [8] Chris Dyer, Adhiguna Kuncoro, Miguel Ballesteros, and Noah A. Smith. Recurrent neural
network grammars. In Proc. of NAACL, 2016.
 [9] Jonas Gehring, Michael Auli, David Grangier, Denis Yarats, and Yann N. Dauphin. Convolu-
tional sequence to sequence learning. arXiv preprint arXiv:1705.03122v2, 2017.
 [10] Alex Graves.
 Generating sequences with recurrent neural networks.
 arXiv preprint
arXiv:1308.0850, 2013.
 [11] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for im-
age recognition. In Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 770–778, 2016.
 [12] Sepp Hochreiter, Yoshua Bengio, Paolo Frasconi, and Jürgen Schmidhuber. Gradient flow in
recurrent nets: the difficulty of learning long-term dependencies, 2001.
 [13] Sepp Hochreiter and Jürgen Schmidhuber. Long short-term memory. Neural computation,
9(8):1735–1780, 1997.
 [14] Zhongqiang Huang and Mary Harper. Self-training PCFG grammars with latent annotations
across languages. In Proceedings of the 2009 Conference on Empirical Methods in Natural
Language Processing, pages 832–841. ACL, August 2009.
 [15] Rafal Jozefowicz, Oriol Vinyals, Mike Schuster, Noam Shazeer, and Yonghui Wu. Exploring
the limits of language modeling. arXiv preprint arXiv:1602.02410, 2016.
","[ 2.18225773e-02  4.07884121e-02  5.12932567e-03  8.20455626e-02
 -3.31711955e-02  2.55239801e-03  3.73467058e-02 -1.04371794e-02
 -2.99571846e-02 -3.29373404e-02  8.80752783e-03 -7.79418796e-02
  3.75849120e-02  4.47573848e-02  1.05221393e-02 -7.57743865e-02
  2.61480398e-02  3.45256063e-03  3.29687856e-02  1.19367456e-02
 -3.93138751e-02 -5.30360267e-03 -1.22377053e-02  6.61654174e-02
 -1.29148792e-02 -3.27633019e-03  1.55100832e-02  1.22546824e-02
 -6.11518603e-03 -4.13272120e-02  4.72917110e-02  3.58366258e-02
  4.72002923e-02  8.06925371e-02  2.39778910e-06 -1.53988861e-02
  2.05211379e-02 -1.71123743e-02  1.02849510e-02  1.33604985e-02
 -5.61724091e-03  1.01916697e-02 -1.74233615e-02 -1.26237087e-02
 -4.25243936e-02 -7.24708242e-03  6.07559681e-02  2.57321075e-02
  4.80250530e-02  8.50307941e-02 -1.45248475e-03 -6.92869797e-02
  2.69353930e-02 -5.35823144e-02  3.31817344e-02 -3.30406465e-02
  6.62126625e-03 -2.76217554e-02 -4.00052629e-02 -3.01425774e-02
 -5.49691990e-02  2.58838162e-02  5.83013371e-02 -2.28573917e-03
  1.61238927e-02  1.78852361e-02 -7.68684503e-03 -4.59105112e-02
 -1.55082894e-02  9.16896313e-02 -5.65214157e-02  6.62614778e-03
 -7.11942650e-03 -5.85347880e-03 -3.33920456e-02 -3.84881981e-02
 -4.25880291e-02 -6.32620556e-03 -8.05582292e-03  1.96550861e-02
 -4.04553600e-02 -1.84757184e-04  3.73327211e-02 -1.48487231e-02
 -2.44163424e-02 -1.81058161e-02  3.63957928e-03 -1.92962717e-02
 -3.57361063e-02 -1.77389141e-02  2.83123180e-03 -6.80252835e-02
  3.51587124e-02  5.69715761e-02 -1.24825509e-02 -9.53976903e-03
 -2.21459251e-02 -6.94443807e-02  2.19167722e-03 -5.65457679e-02
  2.95628812e-02  3.61210965e-02 -2.01589074e-02  9.34399664e-03
 -2.89887767e-02  8.93654972e-02 -3.77712026e-02 -1.79420654e-02
  2.68533430e-03  1.51424035e-02 -3.75633724e-02  8.68555624e-04
 -1.20086242e-02  4.41268831e-02 -8.15364253e-03 -4.80334304e-04
 -1.02930836e-01 -2.42027408e-03  5.68237901e-03 -5.95639052e-04
 -3.64436395e-03  5.63744567e-02 -5.47512323e-02  1.75090749e-02
 -3.35097387e-02  1.81615185e-02 -4.23627719e-03 -6.60484936e-03
  7.01536890e-03 -5.17125800e-02 -6.49105012e-03  2.24019978e-02
  1.91770196e-02 -1.93078630e-02 -8.01833346e-03  5.74857704e-02
  1.88002605e-02 -2.46091876e-02 -3.78801674e-02  3.74687510e-03
 -2.48988234e-02 -7.56045952e-02  4.34224196e-02 -9.19451714e-02
  1.93191282e-02 -3.27597074e-02 -6.93347771e-03 -4.52965870e-02
  2.53789574e-02  1.02362335e-02  2.16336036e-03  2.84292921e-02
  2.82240380e-02 -4.67896983e-02  1.51663469e-02 -4.80882963e-03
  6.07799180e-02  3.40046436e-02  1.02299377e-01  3.53430584e-02
  4.10155673e-03 -2.86886804e-02 -9.32554249e-03  1.60194151e-02
  1.12579204e-03 -2.89277695e-02 -5.33950143e-02 -2.91013774e-02
 -2.92767044e-02  5.04383668e-02  3.73299234e-02  5.53387925e-02
 -3.67771107e-04 -2.37227064e-02  4.11628485e-02  8.01775977e-02
  1.71959884e-02  6.16304278e-02  9.03289840e-02 -4.85551134e-02
  2.76052393e-03  1.02509502e-02 -1.10101420e-02  5.18348366e-02
  6.48033172e-02 -2.92992219e-03 -5.30291582e-03  5.56232296e-02
 -2.05794722e-02 -5.77616170e-02  3.60252298e-02 -2.11397130e-02
  5.46479132e-03 -2.39093192e-02  4.06049974e-02  1.20787062e-02
 -4.95075807e-02 -2.52398271e-02 -2.25804783e-02 -5.59514239e-02
 -1.01409841e-03 -3.64830047e-02  3.52603663e-03  5.82562648e-02
  2.02403292e-02  7.76192546e-03 -4.25153561e-02 -3.14910933e-02
 -1.03009902e-02  9.41296294e-03  2.66120266e-02  2.31144577e-02
  3.53581235e-02 -8.12595859e-02 -1.39481528e-02  3.15367430e-02
  1.82371133e-03  4.02367301e-02 -2.38576606e-02  1.88116636e-02
  4.92969826e-02  3.15563269e-02 -5.19428141e-02  4.20207344e-02
 -3.45649943e-02 -3.87592763e-02  6.02304377e-02  2.58441772e-02
  6.71742409e-02  3.68360765e-02  2.79989820e-02  1.12723676e-03
  5.40520065e-02 -2.49997359e-02 -6.33281376e-03  8.00224487e-03
 -8.08811486e-02 -8.15969184e-02  2.76610721e-02 -3.95444408e-02
 -1.05894413e-02  6.18341425e-03 -6.14523515e-02 -6.83491230e-02
  6.18424416e-02 -4.50345017e-02  2.65192613e-02 -3.04066502e-02
  9.22912266e-03  2.58209929e-02  4.18682285e-02  1.81317423e-02
  5.37703894e-02 -2.22511441e-02  1.43118910e-02  3.13425879e-03
 -8.58433079e-03 -8.10709223e-03 -6.48451224e-02 -2.70280614e-02
 -6.59986865e-04 -1.15517816e-02  3.33898398e-03  1.16233043e-02
  3.57546024e-02 -2.23410912e-02 -5.17239748e-03 -3.14305089e-02
  2.73515824e-02 -2.88775880e-02  2.77794451e-02 -1.69675294e-02
  2.84284521e-02  2.90798489e-02 -3.29289250e-02 -5.12896217e-02
  3.77805680e-02  1.93006527e-02 -1.46131748e-02  4.62941974e-02
  5.94638800e-03 -3.39916833e-02 -2.08475981e-02 -2.71637943e-02
 -2.68611852e-02  4.68029603e-02 -5.97355329e-03 -6.23267666e-02
  2.45851353e-02 -3.32101546e-02 -3.04744113e-02  4.06571254e-02
 -2.41226535e-02 -4.74432558e-02 -5.07909223e-04  1.06699197e-02
  3.80925462e-02  4.51556630e-02  3.93469557e-02  5.28657660e-02
 -3.26971710e-02 -2.73393635e-02 -7.21657835e-03  1.82701442e-02
 -6.15140572e-02  3.24477232e-03 -9.48936306e-03 -1.70207936e-02
  5.63812908e-04  5.11512905e-02  1.50147723e-02  7.50913657e-03
 -3.45458575e-02 -1.92684419e-02  7.99111556e-03 -2.27167327e-02
 -1.13844499e-03  9.31927096e-03 -1.01053007e-02 -8.33672192e-03
 -1.82258021e-02 -4.48186845e-02  4.83459160e-02 -7.13453582e-03
 -2.38098521e-02 -2.52851211e-02 -2.87260320e-02 -5.92190847e-02
  3.65432687e-02  1.45274494e-02  6.74710516e-03  4.51526083e-02
 -4.98414673e-02 -2.93942057e-02  1.85353272e-02 -3.37689482e-02
 -4.47782204e-02  4.79145125e-02 -2.73912456e-02 -8.52551870e-03
 -2.21507344e-02  1.45356730e-03 -3.03764604e-02 -1.86807215e-02
  1.11805042e-02 -3.89692141e-03 -2.53785420e-02 -5.06555326e-02
 -2.19631754e-02 -1.90100656e-03  7.64798326e-03  5.11205159e-02
 -4.08568159e-02  1.97651759e-02 -2.70447694e-02  6.29255250e-02
  2.65079271e-02  2.06511971e-02  6.69336598e-03 -5.13039902e-03
  1.74492113e-02  3.87304425e-02 -1.94620751e-02  2.35564802e-02
 -9.21486169e-02  3.23291905e-02 -1.07768383e-02 -9.59018420e-04
 -1.73577126e-02  5.93179129e-02  3.21506783e-02 -1.16390027e-01
 -2.20653526e-02  1.01632200e-01 -5.13178110e-03 -6.44861460e-02
 -5.58614358e-03  1.69427171e-02  1.21827936e-02  1.46712642e-02
 -3.66997831e-02 -4.22462523e-02 -1.75594352e-02  3.10052000e-03
  1.68638062e-02 -5.32599259e-03 -3.49274762e-02 -1.27956048e-02
 -5.58862090e-02  5.61304279e-02  2.46761274e-02 -5.93947507e-02
 -5.12547269e-02 -2.22575068e-02 -3.21526490e-02  1.03899902e-02
  1.76540520e-02 -6.45896606e-03 -8.42888560e-03 -1.49523588e-02
  4.92196046e-02 -5.49660213e-02 -8.01436901e-02  3.85204959e-03
 -5.11632785e-02 -4.38753515e-03  8.71174484e-02  7.89727941e-02
 -1.06378216e-02 -4.07930762e-02  2.70668156e-02 -9.71480738e-03
 -3.08793341e-03 -6.58499263e-03  2.88625415e-02 -1.27091100e-02
 -2.12351661e-02 -2.55673402e-03  5.40889427e-02 -5.87858781e-02
  3.23384255e-02 -3.76884360e-03  6.24348558e-02 -3.31561975e-02
 -1.76948495e-02 -5.88727146e-02 -1.20869577e-02  3.20740230e-02
  3.26217450e-02  4.75020893e-02 -1.52577534e-02 -5.20439856e-02
 -4.07990180e-02  4.01025005e-02 -6.00319766e-02 -9.55205038e-03
 -2.24654116e-02  1.22854328e-02 -6.11220524e-02 -8.86921734e-02
 -2.86659133e-02 -1.23007391e-02  8.14710464e-03 -4.57845425e-04
 -6.21326361e-03  3.07123512e-02 -1.11332908e-02 -5.50294183e-02
 -3.97090241e-03  8.08023568e-03  2.50715762e-02 -6.09737150e-02
  1.21702179e-02  1.85206104e-02  1.84268579e-02 -2.17981134e-02
  1.52106816e-02 -9.78621244e-02 -2.67093442e-02 -1.83130261e-02
  4.14575897e-02  1.19043980e-02  2.62580179e-02 -1.61756165e-02
 -3.96764232e-03  1.05092116e-02  4.70771864e-02  3.66954990e-02
 -3.11268643e-02  2.86701005e-02 -1.74413249e-02 -2.12659501e-02
  2.71206838e-03 -1.79117471e-02  2.62042247e-02 -3.17746145e-03
  2.25362238e-02 -1.03576072e-02 -4.24640030e-02 -8.30851612e-04
 -2.41061859e-02  3.62610333e-02  6.34380290e-03 -3.42829525e-02
  1.28399243e-03  4.00861800e-02  8.80571734e-03  8.76753032e-03
 -6.72461763e-02 -1.32467095e-02  5.08549809e-02  3.24885398e-02
  1.37786297e-02 -8.15977156e-03  4.70534638e-02 -2.49099545e-02
 -2.39817686e-02  6.62830025e-02 -3.62200034e-03  3.89875695e-02
 -1.29153673e-02  7.99852796e-03 -1.02486964e-02  1.21378200e-02
 -2.48572603e-03  3.62356864e-02 -1.59676541e-02  1.70220621e-02
  6.87293429e-03  5.02862744e-02 -1.27104660e-02  4.61362395e-03
 -6.18997812e-02  3.63686681e-02 -7.96719566e-02  1.13199754e-02
  9.31359306e-02 -1.19778411e-02  1.93196237e-02 -6.94157230e-03
  2.93463729e-02 -3.96619998e-02  7.81764612e-02 -6.63680164e-03
  7.66563043e-03  4.14861441e-02  6.59856480e-03 -3.65367532e-02
 -1.37371412e-02  7.74267092e-02  5.16471826e-02  2.32141018e-02
  4.05358821e-02 -1.44238118e-04 -2.87212525e-02 -2.45375820e-02
  1.02120731e-02 -2.81109419e-02  5.97386993e-03  1.48454169e-03
 -1.21019380e-02 -6.06068261e-02  4.91039939e-02 -7.09890807e-03
  4.55335937e-02 -1.61035231e-03  2.28407625e-02  4.39208597e-02
 -2.26323195e-02  2.62865960e-03 -4.04231735e-02  1.09541332e-02
 -1.05428183e-02 -5.55765405e-02 -6.26108274e-02 -6.53762791e-33
 -1.39602777e-02 -2.05769092e-02 -1.45267160e-03 -1.77018549e-02
 -6.18474633e-02 -2.25631334e-02 -7.37157688e-02 -2.91461907e-02
  1.52505087e-02 -3.30558536e-03 -2.45998837e-02  1.76248897e-03
  1.84749961e-02  5.62592410e-02  1.71274487e-02 -5.21818968e-03
  6.29192069e-02 -1.58770978e-02  2.23112553e-02  2.00356040e-02
  6.48758039e-02  4.00341749e-02  7.94577152e-02 -7.34293275e-03
  5.24373585e-03 -3.27507529e-04  3.18964161e-02  3.41732800e-03
  1.01689035e-02  3.28883715e-02 -2.53540967e-02  4.16095089e-03
  3.63291241e-02 -1.30608268e-02 -4.46921922e-02  3.78691815e-02
 -1.11849748e-01 -1.24561582e-02 -4.24118713e-02  2.38224212e-02
 -4.82180789e-02 -3.03721391e-02  6.91030696e-02  6.26229309e-03
  3.30815604e-03  1.49266226e-02  3.00434474e-02 -4.47019339e-02
 -3.84535827e-02 -6.17793240e-02 -3.29718255e-02  9.16673709e-03
 -3.89696099e-02 -5.86381834e-03  3.84096839e-02  1.80127341e-02
 -2.52629165e-02  2.79900618e-02 -8.18466023e-02 -4.49125795e-03
 -1.89222004e-02  7.80687705e-02  1.95569992e-02  3.95250432e-02
  2.00120807e-02  8.20584502e-03  1.70479398e-02 -2.45949887e-02
 -5.06136119e-02  4.32682298e-02  1.45423142e-02  2.66417563e-02
  5.60856909e-02  1.58944838e-02  7.17183128e-02 -2.99636237e-02
 -8.80269408e-02  1.60394404e-02  1.27882324e-02  7.50034675e-02
  3.04549281e-02  1.73652079e-02 -1.27171855e-02  4.12729205e-05
  6.70833886e-03 -4.28745374e-02  4.08118777e-03 -2.46082991e-02
  4.05088486e-03 -7.18799653e-03  1.06184352e-02 -5.46579994e-03
  2.92472783e-02 -2.76572257e-02 -1.56929041e-03  1.13517819e-02
  2.35825162e-02  4.39478131e-03  2.84237769e-02  3.34322378e-02
 -2.88563333e-02 -2.61547957e-02  2.89852899e-02  2.37928201e-02
  2.26662960e-02 -3.65293352e-03  4.34944034e-02  2.47687176e-02
 -2.63995472e-02 -1.69773735e-02 -3.29111330e-02  1.72095802e-02
  9.21061542e-03  8.64796415e-02  2.88457163e-02 -1.52909039e-02
 -1.59980338e-02  6.76743090e-02 -3.13429236e-02  1.47343392e-03
 -2.00739950e-02  2.44985893e-03  1.66884623e-02  3.22007202e-02
 -4.96436730e-02 -3.69014293e-02 -5.10275289e-02  4.25887965e-02
  5.26284166e-02 -4.82577272e-02 -1.30544892e-02  3.75949815e-02
  3.05415199e-07 -2.00931705e-03  3.23897451e-02  6.49496093e-02
 -1.24285724e-02  4.16815542e-02  1.88003145e-02 -2.11668797e-02
  2.16752458e-02  6.55167131e-03 -1.36774825e-02  3.31569053e-02
  3.21018929e-03  5.46464212e-02  8.09000339e-03 -8.20799842e-02
 -2.89393459e-02 -9.07315612e-02  8.45302455e-03 -1.32824974e-02
  3.01380977e-02  3.17792445e-02  1.21253610e-01  2.00767480e-02
 -1.52777536e-02  4.06332240e-02  1.11337230e-02  4.34103794e-02
  2.31890585e-02  8.87212716e-03  2.70397356e-03  2.82614119e-02
  5.86139970e-03 -2.22087726e-02 -3.02986102e-03 -3.86388861e-02
  3.73541005e-02  6.41055871e-03  4.49268073e-02 -3.68664437e-03
 -3.88780832e-02 -1.81426052e-02  3.60488705e-02  5.87937236e-03
 -3.38339396e-02  3.86305824e-02 -2.46728659e-02 -5.17010354e-02
 -2.71283649e-02 -3.99844386e-02  4.46419753e-02  3.70136276e-02
 -2.98700249e-03 -7.19647435e-03  4.28446947e-04  2.35258639e-02
 -3.29945795e-02 -7.61687336e-03 -7.64125064e-02  9.55588743e-03
 -1.78585947e-02 -4.83484380e-02  3.67198430e-04 -5.21243028e-02
  1.89403910e-02  4.24332768e-02  2.77376603e-02 -2.60808654e-02
  3.13031666e-34  2.82220561e-02 -2.05522645e-02  7.24148238e-03
  2.98598073e-02 -1.42182559e-02 -1.58884861e-02 -1.18381614e-02
  2.11064517e-02  4.79502650e-03 -3.71148810e-02 -4.15096842e-02]"
"[16] Łukasz Kaiser and Samy Bengio. Can active memory replace attention? In Advances in Neural
Information Processing Systems, (NIPS), 2016.
 [17] Łukasz Kaiser and Ilya Sutskever. Neural GPUs learn algorithms. In International Conference
on Learning Representations (ICLR), 2016.
 [18] Nal Kalchbrenner, Lasse Espeholt, Karen Simonyan, Aaron van den Oord, Alex Graves, and Ko-
ray Kavukcuoglu. Neural machine translation in linear time. arXiv preprint arXiv:1610.10099v2,
2017.
 [19] Yoon Kim, Carl Denton, Luong Hoang, and Alexander M. Rush. Structured attention networks.
 In International Conference on Learning Representations, 2017.
 [20] Diederik Kingma and Jimmy Ba. Adam: A method for stochastic optimization. In ICLR, 2015.
 [21] Oleksii Kuchaiev and Boris Ginsburg. Factorization tricks for LSTM networks. arXiv preprint
arXiv:1703.10722, 2017.
 [22] Zhouhan Lin, Minwei Feng, Cicero Nogueira dos Santos, Mo Yu, Bing Xiang, Bowen
Zhou, and Yoshua Bengio. A structured self-attentive sentence embedding. arXiv preprint
arXiv:1703.03130, 2017.
 [23] Minh-Thang Luong, Quoc V. Le, Ilya Sutskever, Oriol Vinyals, and Lukasz Kaiser. Multi-task
sequence to sequence learning. arXiv preprint arXiv:1511.06114, 2015.
 [24] Minh-Thang Luong, Hieu Pham, and Christopher D Manning. Effective approaches to attention-
based neural machine translation. arXiv preprint arXiv:1508.04025, 2015.
11
","[ 4.52945335e-03  3.80126480e-03  4.53391485e-03  4.84336913e-02
 -9.29496251e-03  2.45978939e-03  2.92656757e-02 -3.67029198e-02
 -5.84182935e-03 -3.79048139e-02 -4.17383686e-02 -6.29155934e-02
  8.83584190e-03  5.53128645e-02  5.07680029e-02 -2.77631655e-02
  6.87434152e-02  4.13838588e-03  4.21049893e-02  3.00110914e-02
 -2.20716465e-02 -3.12431157e-02  1.66550018e-02  1.90031566e-02
  2.12328658e-02 -1.46714170e-02 -2.54096203e-02 -1.32672098e-02
  2.80618053e-02 -1.18657267e-02  1.41563360e-02  3.22765373e-02
  1.18099945e-02  5.13782538e-02  2.33538731e-06  1.24390181e-02
  1.60337333e-02 -5.71291707e-02  1.11996941e-02  2.67974716e-02
 -2.86566205e-02 -2.00475845e-02  8.18805769e-03 -2.10127304e-03
 -8.90799984e-02 -5.60896471e-02  3.99513841e-02  3.35332267e-02
  7.19358623e-02  8.58600736e-02 -2.07237229e-02  1.92125775e-02
  4.80274670e-02 -7.08727315e-02  4.45329472e-02 -4.53019552e-02
  1.25424135e-02 -4.84897830e-02 -4.11048718e-02  6.33757710e-02
 -2.39353664e-02  6.23446330e-02  5.04440330e-02 -1.41826866e-03
  5.03003597e-02  5.66834882e-02 -2.63991412e-02  4.03838139e-03
 -1.12880953e-02  7.34782070e-02 -3.44004072e-02  1.34801157e-02
 -1.02706272e-02 -3.75506394e-02 -1.32071106e-02 -2.36837082e-02
 -5.16346619e-02  1.07033355e-02  6.96401577e-03  4.73797731e-02
  1.58228278e-02  5.34093298e-04  3.90180349e-02 -2.36794725e-02
 -6.70926692e-03  1.81680843e-02  5.76405879e-03 -4.19872105e-02
 -1.26880687e-02  1.78998914e-02 -2.50121392e-02 -3.06944139e-02
  5.95637597e-02  4.57997024e-02 -5.76032558e-03 -4.70032822e-03
 -4.13167961e-02 -6.38672858e-02 -3.01207695e-02 -8.52152035e-02
  2.61009298e-02  3.35844643e-02  2.78556091e-03  4.78593409e-02
 -4.58380803e-02  5.86850382e-02 -4.41456437e-02  2.03883015e-02
 -3.79462503e-02  3.35059986e-02 -3.62669230e-02  6.86360640e-04
 -8.05044733e-03  3.23220864e-02 -1.12498645e-03 -2.77057309e-02
 -4.97632846e-02  4.67625819e-02 -7.52569875e-03  2.26479210e-02
 -2.47016666e-03  3.28429565e-02 -5.68166822e-02  2.53086053e-02
 -2.43346440e-03  2.04193629e-02 -4.70582284e-02  3.25754238e-03
 -2.06797812e-02 -2.57549371e-04 -3.78891081e-02  3.53112221e-02
  1.60941929e-02 -1.12743620e-02 -1.44144548e-02  6.67066723e-02
 -1.32701173e-02 -4.60867919e-02 -4.08843160e-02  1.11623220e-02
 -1.34362727e-02 -4.85644750e-02  6.71779141e-02 -4.47254814e-02
  4.15672027e-02 -4.66848537e-03 -2.62711607e-02 -3.42410579e-02
  1.89790875e-02  4.17585485e-02 -3.73220481e-02  4.18766178e-02
  3.36001106e-02 -5.37919365e-02 -1.41610680e-02  1.84083991e-02
  4.00922932e-02  3.88416387e-02  5.06444946e-02  3.18131112e-02
 -1.62399709e-02 -3.16376612e-02 -1.39907189e-02 -1.11108245e-02
  2.93547492e-02  2.23265458e-02  4.42058779e-03 -1.83489488e-03
 -1.80878248e-02  9.62534361e-03  2.67246012e-02  4.76137325e-02
 -6.97699981e-03  3.51005094e-03  4.87847663e-02  1.75653491e-02
 -2.67341244e-03  7.62608126e-02  2.19702590e-02 -3.55722681e-02
  6.47923589e-05  5.26639782e-02 -5.16026802e-02  8.93740952e-02
  2.35693008e-02  9.94314719e-03  3.46238203e-02  6.19817805e-03
 -3.61335911e-02 -3.85354348e-02  2.44343355e-02 -2.32692547e-02
  2.47559603e-02 -1.89966932e-02  1.83768254e-02 -4.55361651e-03
 -9.45991427e-02  3.06267142e-02 -2.19064504e-02 -5.14653288e-02
  9.61284805e-03 -1.83147956e-02 -2.35129008e-03  2.53669191e-02
  1.11111710e-02 -4.79884148e-02 -6.13993257e-02 -2.58696005e-02
 -1.33818919e-02  4.01468463e-02 -1.17255030e-02  1.70364063e-02
 -3.70128109e-04 -7.38085061e-02 -1.53909801e-02 -2.41101962e-02
  1.00517289e-04  9.31473076e-03 -1.71410404e-02  3.45026441e-02
  3.37062292e-02  4.88591865e-02 -1.14249373e-02  2.57756095e-02
 -1.16368402e-02 -7.41914436e-02  1.73820909e-02  3.14763114e-02
  5.73998243e-02  2.60383245e-02  4.37282845e-02  2.63413880e-02
  3.96557003e-02 -5.90624623e-02 -2.13178061e-02  1.63849397e-03
 -8.66944417e-02 -5.70751205e-02  3.59646790e-03 -4.60885614e-02
 -9.49797779e-03  3.91367152e-02 -5.76610640e-02 -6.94232211e-02
  5.68452198e-03 -4.92141843e-02 -1.14959832e-02 -1.33556966e-02
  2.14591846e-02  4.96866927e-02  4.46370877e-02 -1.35066006e-02
  4.97741811e-02 -4.04756330e-02  1.71848759e-02  2.40117367e-02
 -9.81093198e-03  2.52555292e-02 -4.19831350e-02  4.27061412e-03
  1.51741813e-04  8.01514182e-03 -5.29030804e-03 -1.45175538e-04
  1.48132266e-02 -4.95629236e-02  3.83164082e-03 -2.53292676e-02
  1.26191778e-02 -2.65303068e-02  3.19097787e-02  3.79550494e-02
  4.12855670e-02  3.50828506e-02 -1.27020832e-02 -4.25854623e-02
 -1.12633710e-03 -8.26346129e-03  2.02242343e-04  3.92001383e-02
  1.07455067e-02  1.92865059e-02 -3.41248102e-02 -4.49899696e-02
 -3.67933773e-02  4.81775589e-02 -2.54465882e-02 -7.00469539e-02
 -4.58510444e-02  2.60457229e-02 -1.25807514e-02  3.41824926e-02
 -1.90246217e-02 -2.19623409e-02  1.99779752e-03 -1.70120727e-02
  5.40772900e-02  1.10199548e-01 -8.03314988e-03 -7.42348749e-03
  3.52878124e-02 -1.45578925e-02 -6.52360404e-03  5.38627803e-02
 -3.75570692e-02  2.70608813e-02  1.01984264e-02 -2.40918156e-02
  1.94644332e-02  6.12907670e-02  1.42805660e-02 -2.73846206e-03
 -5.14042266e-02 -2.46988293e-02  7.89179746e-03 -4.07273043e-03
  1.17137721e-02  4.37452784e-03 -2.80134138e-02 -2.50816550e-02
 -1.88844476e-03 -4.00396250e-02  6.77428767e-02 -5.61859459e-03
 -2.80568656e-02 -5.88564277e-02  2.13774433e-03 -2.69033480e-02
  3.81064825e-02  2.51968671e-02 -8.82855151e-03 -1.68451946e-02
 -2.23191343e-02 -3.56006697e-02  2.02768743e-02 -2.70643830e-02
 -1.41491853e-02  7.08638728e-02  2.31847614e-02 -1.39964616e-03
 -3.84136066e-02 -1.81291141e-02 -3.65192555e-02 -6.00660592e-03
 -9.99904703e-03  9.05675534e-03  2.53305249e-02 -2.92546470e-02
 -2.67056208e-02 -2.09979340e-02  1.85032170e-02  3.94984148e-02
 -2.64005922e-02 -8.14880431e-03 -2.47511845e-02  7.16863796e-02
  2.96724532e-02  1.00246007e-02  1.70204602e-02 -1.65835023e-02
 -5.85482083e-03  6.83424920e-02  3.71608250e-02 -1.22246630e-02
 -9.77856386e-03 -5.33337751e-03  2.37584561e-02 -3.59136872e-02
 -1.02048460e-02  2.18343660e-02  1.61469728e-02 -8.04266110e-02
 -4.16298434e-02  9.33770314e-02  1.69263352e-02 -8.36504698e-02
 -1.39431749e-02  9.66353342e-03  1.17036505e-02  1.12860212e-02
  1.12052998e-02 -3.64136100e-02 -2.48182286e-02 -2.50277277e-02
  1.22161619e-02  3.64723466e-02 -2.31313556e-02 -8.13796651e-03
 -5.16316183e-02  1.18150879e-02  5.00362664e-02 -3.63195948e-02
 -6.10320717e-02 -3.22816893e-02 -3.53336614e-03  7.62525341e-03
 -3.73724994e-04 -9.88338515e-03  1.14700729e-02 -5.61489910e-03
 -6.62555313e-03 -8.88654962e-03 -2.29424909e-02  9.49022826e-03
 -4.98964116e-02  2.09983792e-02  3.51044312e-02  5.78819141e-02
  1.09395599e-02 -5.96775301e-02  5.36098285e-03  7.58881075e-03
 -2.02748049e-02 -7.34378677e-03  2.09611338e-02 -3.74754332e-02
 -1.75999030e-02 -2.48443913e-02  3.95354889e-02 -6.82546496e-02
  1.59882882e-03  1.50781767e-02  1.11380428e-01 -1.47908358e-02
 -2.36565643e-03 -3.23687978e-02  4.82488191e-03  8.42357427e-03
  5.94505779e-02  4.96322922e-02 -2.39412189e-02 -5.27444519e-02
 -2.38168370e-02  2.72928048e-02 -6.87291250e-02 -5.12686335e-02
  2.22811047e-02  3.11448760e-02 -1.67716201e-03 -8.14631134e-02
 -7.82677978e-02  1.83059778e-02  2.08074972e-02 -7.62158167e-03
  3.85126323e-02  2.73257699e-02 -6.16256297e-02 -2.60205884e-02
 -7.24212686e-03  4.50570296e-05 -6.37372676e-03 -3.39029245e-02
  1.07715162e-03 -1.19952038e-02  1.20409178e-02  1.01016117e-02
  1.30962469e-02 -1.16676070e-01 -2.05450691e-02 -1.54176252e-02
  6.05820119e-02  7.47257285e-03  2.70912182e-02 -2.51221079e-02
  7.15415273e-03  1.62223149e-02  1.06266560e-02 -3.47626582e-02
  5.29431971e-03  7.23095536e-02 -2.24654451e-02 -5.67389512e-03
  5.62891960e-02 -1.15658306e-02 -5.76692342e-04  7.25286826e-03
  5.96754439e-02 -9.51103342e-04 -2.93506309e-02 -1.78484656e-02
 -5.82990572e-02  5.80603108e-02  1.34924194e-02 -4.39913664e-03
 -4.98852041e-03  4.35759053e-02  1.89156365e-02  1.98912751e-02
 -5.96591495e-02 -1.92503575e-02  2.74900049e-02  2.27030832e-02
 -2.12782286e-02  1.33011891e-02  2.55276579e-02 -4.12732270e-03
 -3.24524045e-02  3.20081003e-02  9.74626653e-03 -5.59688965e-03
 -4.17920277e-02 -1.19379079e-02 -4.44805697e-02  1.85215846e-02
  1.06392987e-02  3.71729657e-02 -1.44923795e-02  4.45244275e-02
  1.34930769e-02  3.08447946e-02 -1.61361862e-02  1.77189205e-02
 -7.96391889e-02  8.74851644e-03 -3.28662843e-02 -6.92591304e-03
  7.91802183e-02 -3.54253314e-02  3.85900028e-02 -1.12290820e-02
  4.75199334e-03 -1.03563182e-02  4.49843854e-02 -9.13167931e-03
 -5.85461559e-04 -5.36881434e-03  5.46935992e-03  4.83326335e-03
 -1.25939026e-03  8.26630145e-02  3.11243497e-02 -8.11741746e-04
  3.66768837e-02 -1.10303676e-02 -2.29848996e-02 -4.68894690e-02
 -1.17591051e-02  9.04427655e-03 -1.72193442e-02  2.36448944e-02
 -1.52899390e-02 -7.25286305e-02  2.47551724e-02  2.28400691e-03
  7.96306506e-03 -3.55853140e-02  1.89800933e-02  1.93262082e-02
 -1.16876708e-02 -5.76710422e-03 -1.90472975e-02  4.18380387e-02
  2.38169879e-02 -6.20854907e-02 -4.36117575e-02 -6.51378081e-33
 -2.71618832e-02 -3.00297216e-02 -1.29628526e-02 -2.53031985e-03
 -2.11113822e-02  8.09242018e-03 -7.71133378e-02 -1.52768465e-02
 -2.44621076e-02 -1.74669605e-02 -2.48529688e-02  1.27247069e-02
  4.16681357e-03  3.05183921e-02  2.88679842e-02 -6.23037480e-03
  2.20680591e-02 -1.06866183e-02  6.91501750e-03  6.25975728e-02
  3.90018374e-02  3.78143042e-02  8.45166221e-02 -2.02435665e-02
  2.41813269e-02 -4.27194731e-03  2.81955618e-02  4.35502181e-04
 -1.78830102e-02  2.16513537e-02 -2.46383362e-02  1.15753179e-02
  4.20770384e-02 -4.49236594e-02 -3.22613306e-02  3.03448904e-02
 -1.18249916e-01 -5.67722358e-02 -1.37410210e-02 -5.36365900e-03
 -1.06711172e-01 -3.05612758e-02  6.51466623e-02 -5.63184731e-03
  3.53081822e-02 -2.99971309e-02  2.97781243e-03 -6.11416437e-03
 -5.70972525e-02 -2.57234890e-02 -5.64835258e-02 -1.58941485e-02
 -7.54211191e-03  4.12908122e-02  3.03867832e-02  2.19929162e-02
 -2.08349265e-02  2.60689259e-02 -1.12158656e-01 -2.91276425e-02
 -3.96294780e-02  8.79004747e-02  2.81011891e-02  3.50924544e-02
  6.00311032e-04  2.21263636e-02  2.41601467e-02  1.55738592e-02
 -4.18279245e-02  2.21632682e-02 -1.85558840e-03  1.24487039e-02
  6.82670847e-02 -1.74070597e-02  2.22002175e-02  3.63362320e-02
 -9.56399441e-02 -1.43262837e-02  1.47539172e-02  4.36787717e-02
  4.83670942e-02  3.02676950e-02 -3.00134327e-02 -1.32681094e-02
  2.66569983e-02  1.81260090e-02 -1.39523372e-02 -3.20933387e-02
  5.45186084e-03  2.36018859e-02 -3.05342656e-02 -3.58310081e-02
  4.63087000e-02 -1.41677866e-02  2.47374233e-02  1.32903997e-02
  4.58470872e-03 -8.41268862e-04  1.18401675e-02  1.55460527e-02
 -5.33988737e-02 -2.77206507e-02 -5.59520023e-03  2.83078686e-03
  1.04611786e-02  7.51706539e-03  4.80806939e-02  2.22878307e-02
 -4.53518443e-02 -3.53778377e-02 -2.10281890e-02  1.30378474e-02
  9.92274471e-03  5.97627349e-02  5.96479587e-02 -1.07281338e-02
 -1.69942789e-02  9.33182687e-02  8.34982563e-03 -3.69109935e-03
 -2.42757127e-02 -8.92757718e-03  1.06313564e-02  3.28479074e-02
 -8.10875371e-03 -3.64734349e-03 -6.57521337e-02  3.46984006e-02
  1.04128011e-02 -1.02729589e-01 -1.21545261e-02  3.25942077e-02
  3.00175600e-07  3.34469453e-02  3.31968851e-02 -1.24165304e-02
  1.01725552e-02  3.22449617e-02  3.93381566e-02 -2.56444346e-02
  4.07847390e-02  1.94663145e-02  2.95301504e-03  2.76674591e-02
  3.51343378e-02  4.16348135e-04 -6.59770099e-04 -1.03107348e-01
 -2.83260699e-02 -5.59566133e-02  2.48030871e-02 -3.79152186e-02
 -6.11217692e-03  2.28578616e-02  1.16428919e-01  9.43533238e-03
  9.08657350e-03  2.59890053e-02 -4.49612960e-02  5.69955967e-02
  2.76451577e-02  1.99064706e-03 -1.73738599e-02  3.75144277e-03
 -9.04043950e-03 -6.41957149e-02 -1.48862386e-02 -2.58287080e-02
  2.80308370e-02  3.94643806e-02  8.56566802e-02  4.77167405e-02
 -5.16644828e-02  4.54733055e-03  1.15439808e-03  2.71631554e-02
 -1.85230281e-02  8.63942206e-02 -5.27972877e-02 -4.07994017e-02
  5.89903779e-02 -2.36373954e-02  2.92015858e-02  3.69947515e-02
  2.41300464e-02 -6.36331621e-04 -6.60228124e-03  8.00713140e-04
 -9.53678507e-03 -1.33246379e-02 -8.18587244e-02 -2.41608489e-02
 -1.52767291e-02 -6.00955710e-02 -4.04470507e-03 -8.00208822e-02
  2.85744835e-02  5.09135835e-02  9.62045975e-03 -4.00074497e-02
  3.21811254e-34  3.03546619e-02 -6.82986062e-03  4.59154956e-02
  4.49170657e-02 -6.98303245e-03 -3.71382050e-02 -3.35747898e-02
 -1.80253386e-02  5.43781407e-02 -6.44853041e-02 -4.65187430e-02]"
"[25] Mitchell P Marcus, Mary Ann Marcinkiewicz, and Beatrice Santorini. Building a large annotated
corpus of english: The penn treebank. Computational linguistics, 19(2):313–330, 1993.
 [26] David McClosky, Eugene Charniak, and Mark Johnson. Effective self-training for parsing. In
Proceedings of the Human Language Technology Conference of the NAACL, Main Conference,
pages 152–159. ACL, June 2006.
 [27] Ankur Parikh, Oscar Täckström, Dipanjan Das, and Jakob Uszkoreit. A decomposable attention
model. In Empirical Methods in Natural Language Processing, 2016.
 [28] Romain Paulus, Caiming Xiong, and Richard Socher. A deep reinforced model for abstractive
summarization. arXiv preprint arXiv:1705.04304, 2017.
 [29] Slav Petrov, Leon Barrett, Romain Thibaux, and Dan Klein. Learning accurate, compact,
and interpretable tree annotation. In Proceedings of the 21st International Conference on
Computational Linguistics and 44th Annual Meeting of the ACL, pages 433–440. ACL, July
2006.
 [30] Ofir Press and Lior Wolf. Using the output embedding to improve language models. arXiv
preprint arXiv:1608.05859, 2016.
 [31] Rico Sennrich, Barry Haddow, and Alexandra Birch. Neural machine translation of rare words
with subword units. arXiv preprint arXiv:1508.07909, 2015.
 [32] Noam Shazeer, Azalia Mirhoseini, Krzysztof Maziarz, Andy Davis, Quoc Le, Geoffrey Hinton,
and Jeff Dean. Outrageously large neural networks: The sparsely-gated mixture-of-experts
layer. arXiv preprint arXiv:1701.06538, 2017.
 [33] Nitish Srivastava, Geoffrey E Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan Salakhutdi-
nov. Dropout: a simple way to prevent neural networks from overfitting. Journal of Machine
Learning Research, 15(1):1929–1958, 2014.
 [34] Sainbayar Sukhbaatar, Arthur Szlam, Jason Weston, and Rob Fergus. End-to-end memory
networks.","[ 3.33834961e-02  1.07316999e-03 -2.50414037e-03  4.52878214e-02
 -2.63749901e-02  1.39719816e-02 -5.00397012e-02 -4.26642522e-02
 -4.07090411e-02 -5.50959408e-02  1.62881445e-02 -1.69766545e-02
 -8.24014563e-03  1.23826042e-02  3.84415127e-02 -8.04986879e-02
  5.32659627e-02  1.97256338e-02  1.44906687e-02  1.00356145e-02
  1.27756195e-02  9.21124686e-03  4.64608483e-02  5.18795885e-02
 -1.93417352e-02 -6.46394193e-02 -1.26148863e-02  4.21849871e-03
 -8.70951189e-05 -1.57308728e-02  8.88630375e-03  3.52574065e-02
  8.40161741e-03  5.74421920e-02  2.46412469e-06 -4.15841490e-03
 -2.04063896e-02 -1.27606075e-02 -2.34887563e-02  1.33510111e-02
  3.12821046e-02 -3.69002298e-02  8.06490332e-03 -7.16204662e-03
 -4.08223420e-02 -3.47394869e-02  6.16250820e-02  4.37956899e-02
  8.39669630e-02  1.00797944e-01 -3.79388011e-03 -5.07174246e-02
  4.26605940e-02 -3.29059139e-02 -4.27294336e-02 -1.29307527e-02
 -5.13281301e-03  1.31302960e-02 -2.47547701e-02  2.79684793e-02
 -1.47188660e-02  2.27105636e-02  3.09490580e-02 -2.21800264e-02
  5.77696450e-02  4.32446375e-02 -5.54385930e-02 -2.52688937e-02
  7.80721102e-03  7.87289441e-02 -1.07502947e-02 -4.12896834e-02
 -1.08127259e-02 -6.21398911e-03 -9.03128181e-03 -1.31439576e-02
 -4.75217700e-02  3.13202515e-02  1.00399125e-02  4.56247292e-02
  5.94047755e-02  8.90975632e-03  1.97403524e-02  1.29395137e-02
 -2.93449610e-02  3.29456739e-02  3.59275634e-03 -4.31174263e-02
  5.08115906e-03  2.34908368e-02 -4.28822115e-02 -6.20926134e-02
  2.47272998e-02  7.71459751e-03  1.50426384e-02  5.93921496e-03
 -2.51179785e-02 -7.77850002e-02  8.61092377e-03 -7.26755112e-02
  2.80762129e-02  1.62310824e-02 -6.23884657e-03  4.24130000e-02
 -4.88618715e-03  2.44042501e-02 -1.46647226e-02  2.40360480e-02
 -4.61639538e-02  2.44734548e-02 -4.46630456e-02 -1.41608203e-02
 -3.52621600e-02  4.91219535e-02 -3.26505937e-02 -2.30455790e-02
 -3.66245061e-02 -1.46716731e-02 -6.26921793e-03 -2.94176978e-03
 -4.66957595e-03  1.97448581e-02 -5.77743724e-02  2.51401290e-02
  1.84234660e-02  3.51339392e-02 -4.22666706e-02 -2.18975246e-02
  2.57721264e-03 -2.73853354e-02 -2.63746269e-02  2.64057852e-02
  1.13127623e-02 -6.19059522e-03 -2.41254233e-02  2.10994929e-02
  1.05328783e-02 -4.43841293e-02  1.53227607e-02 -1.61649380e-02
 -3.27375680e-02 -3.00338883e-02  9.29227285e-03 -7.86218420e-02
  1.37385800e-02 -3.04634292e-02  5.33710420e-03 -2.18615830e-02
  2.04512216e-02  3.51119414e-02 -5.55285998e-03  3.02457325e-02
 -3.79133597e-02 -1.35415895e-02  1.39992672e-03 -1.25933429e-02
  4.87886369e-02  4.74781543e-02  5.27852066e-02  1.99291594e-02
  3.43019925e-02 -1.93433613e-02 -4.99112019e-03  2.02028919e-02
 -7.95324799e-03 -3.58562469e-02  1.62580125e-02 -1.62601415e-02
 -7.09219798e-02  3.49722849e-03  3.40105742e-02  2.84173731e-02
 -2.96320934e-02  1.54172163e-02  5.36917225e-02  5.43824360e-02
 -7.42616924e-03  3.45700867e-02  3.84175479e-02 -1.08148474e-02
  1.04013523e-02  3.96995358e-02 -4.09048423e-02  1.21035120e-02
  7.29380455e-03  3.29095609e-02 -5.80382161e-03 -2.20893845e-02
 -2.61620362e-03 -5.47159910e-02 -7.13785004e-04 -1.79268382e-02
  2.39639841e-02 -2.28246097e-02  4.75792438e-02  2.11154521e-02
 -2.89924014e-02  9.40323900e-03  1.94336418e-02 -3.93137746e-02
  2.83289589e-02 -2.37001888e-02 -2.04127165e-04  2.96729282e-02
  2.09433921e-02 -3.46337147e-02 -2.34676693e-02 -3.19324508e-02
  1.29801943e-03  5.79276122e-02  3.38759273e-02 -1.84398293e-02
 -3.52762849e-03 -2.83915251e-02  4.11224784e-03 -1.40755763e-02
  2.67765336e-02  2.43111756e-02 -3.48979272e-02 -4.42540236e-02
  2.19001248e-02 -3.59412143e-03 -6.11538850e-02  6.22569323e-02
 -1.41171459e-03 -5.88029139e-02 -6.27580751e-03  1.13347836e-03
  6.51327446e-02  5.45481071e-02  3.54474434e-03  4.16811295e-02
  5.00691608e-02 -2.73396838e-02 -2.05207393e-02  2.12614313e-02
 -4.80821356e-02 -4.87783849e-02  1.09367529e-02 -7.16937110e-02
 -1.17303971e-02  5.37997261e-02 -3.98470424e-02 -6.14901409e-02
 -1.52161706e-03 -7.32979551e-02  8.38541165e-02 -4.21190262e-02
  3.21280435e-02  1.59570426e-02 -1.16179895e-03 -3.59488688e-02
  7.42887110e-02 -9.52951983e-03  2.02825498e-02 -2.33705854e-03
 -4.12030593e-02  2.58133933e-02 -4.43273522e-02 -2.59006321e-02
 -4.49582329e-03 -5.41897304e-03 -5.35773626e-03  5.42194061e-02
  3.86387296e-02 -6.95667863e-02  1.94776338e-02 -5.87417334e-02
  1.14641814e-02 -2.85311211e-02  5.95487654e-02  3.03347260e-02
  8.88051093e-03  2.56786756e-02 -1.46665191e-03 -5.14980499e-03
 -1.63170509e-02 -3.31528415e-03  1.62178259e-02  2.51416918e-02
 -8.14687368e-03  4.09755036e-02 -7.22541213e-02 -4.18285057e-02
 -4.90766652e-02  4.96832356e-02  1.52105698e-02 -7.26484135e-02
 -2.02754885e-02  3.58529924e-03 -7.91621802e-04  2.11128592e-02
  1.99811142e-02 -4.20063213e-02  4.09164792e-03 -1.06199402e-02
  2.79420558e-02  6.10806495e-02 -5.20841591e-03  1.30796870e-02
  2.77910922e-02  1.42961377e-02 -5.13049662e-02  1.19929593e-02
 -4.08591218e-02  1.56221380e-02  1.50101483e-02 -2.27272306e-02
  2.36540269e-02  8.01979080e-02  1.82480253e-02 -1.32755507e-02
 -3.71548124e-02 -2.24113129e-02 -2.06735004e-02 -2.77888197e-02
  7.33127957e-03 -2.56717931e-02 -2.95515638e-02 -5.34086721e-04
 -4.66726571e-02 -3.14764827e-02  8.25081840e-02 -1.40111253e-03
 -1.09503446e-02 -6.56133890e-02  5.51733142e-03 -2.46722382e-02
  4.74749543e-02  4.51291502e-02  9.24587343e-03  2.41869874e-02
 -4.91202921e-02 -6.69703959e-03  3.29890288e-02 -1.44574791e-03
 -1.07271853e-03  5.39295934e-02 -7.41432700e-03  4.36253427e-03
 -1.29118776e-02 -7.36477738e-03 -1.02675213e-02 -7.76866525e-02
 -1.32971406e-02  1.26602966e-02  2.86383200e-02  1.43660866e-02
 -2.36251205e-02  1.11158621e-02  1.67181436e-02  4.71204259e-02
 -3.64232883e-02 -1.30314268e-02 -2.80406792e-02  5.11519201e-02
  1.74686443e-02  1.02256509e-02  2.64731627e-02 -2.04288196e-02
  2.75801551e-02  6.23144954e-02 -4.49881703e-03  2.99097467e-02
 -6.25554398e-02 -1.44617856e-02  1.56923253e-02 -8.00591707e-02
 -4.76064123e-02 -6.28262479e-03  4.60380651e-02 -1.00580402e-01
 -3.16046253e-02  1.20765038e-01  2.65727621e-02 -4.85736094e-02
  2.17880420e-02 -2.39859782e-02  3.34993750e-02  2.46918891e-02
  2.00499408e-02 -5.54667935e-02 -2.79116090e-02  1.18521592e-02
  3.71020101e-02  1.83154326e-02 -3.32644843e-02  3.25170010e-02
 -1.18814096e-01  1.87139865e-02  1.63284000e-02 -6.93001896e-02
 -3.15483846e-02 -3.71315144e-02 -3.84581345e-03 -1.41332103e-02
 -2.71828678e-02  2.02315282e-02 -1.81789473e-02  2.73478404e-02
  3.98286879e-02 -7.75960162e-02 -3.89534682e-02  1.09971752e-02
 -5.52773662e-02  1.19352173e-02  9.06246305e-02  7.40029886e-02
 -8.82631168e-03  2.12243181e-02  3.28186266e-02 -4.37529683e-02
 -1.74396634e-02 -8.87162890e-03  5.01096062e-02 -1.46602988e-02
 -4.42631962e-03 -6.85152039e-03  4.63471711e-02 -1.87090803e-02
  1.48986205e-02 -9.23920597e-04  9.65659097e-02  1.75721582e-03
  7.15031568e-03 -5.53944260e-02  2.51398310e-02 -1.55083677e-02
  5.26164882e-02  6.14083968e-02 -4.72038332e-03 -6.41903654e-02
 -5.02821952e-02  6.51975349e-02 -3.51774357e-02 -2.15522591e-02
  3.31694894e-02 -2.49762945e-02 -3.70132662e-02 -9.85637978e-02
 -7.23015219e-02  2.06604563e-02 -1.63132325e-03  1.42461387e-02
  1.12720870e-03  5.39983157e-03 -1.61975436e-02 -4.27736202e-03
  2.42631920e-02 -2.33424362e-03 -1.60825755e-02 -6.46888977e-03
 -2.50625447e-03  4.39371094e-02  1.56948045e-02 -1.38745932e-02
  4.27509891e-03 -9.67664924e-03 -3.20401043e-02 -2.60229055e-02
  7.33729526e-02  1.82857104e-02  5.05199507e-02 -1.76196266e-02
 -4.77554351e-02 -2.14567389e-02 -8.76054075e-03 -1.02555891e-02
 -1.32443039e-02  5.77027164e-02  1.41367847e-02 -3.39189661e-03
  4.54075411e-02 -3.56814750e-02  5.41312359e-02 -1.92794744e-02
  6.60452098e-02 -2.75308397e-02 -2.66977791e-02  4.14810181e-02
 -1.99337141e-03  4.12277542e-02 -1.15598692e-02 -2.35135132e-03
 -1.96988545e-02 -7.62147072e-04 -3.04956343e-02 -2.41294000e-02
 -4.16565165e-02  7.26805069e-03  8.41081422e-03  6.14528079e-03
 -1.01238349e-02  1.05015561e-02 -1.05493804e-02  3.11168190e-02
 -4.93216887e-02  5.00400960e-02  3.02824974e-02  9.24164709e-03
 -6.35071844e-02  3.29383393e-03 -4.21099328e-02 -3.25634181e-02
 -3.75740007e-02  2.25609560e-02 -1.00090289e-02  1.59168467e-02
  2.41830349e-02  1.09931994e-02  3.78119037e-03  5.34406514e-04
 -6.12882897e-02  3.21086422e-02 -4.76001203e-02  7.11441273e-03
  6.76508173e-02 -5.43134771e-02  7.96778426e-02 -1.21962363e-02
 -2.77739428e-02 -8.43346585e-03  4.08744738e-02 -2.19080085e-03
 -2.54720859e-02  1.08080087e-02  9.65204276e-03 -1.49456551e-02
 -8.86424351e-03  6.20647222e-02 -7.93261745e-04 -8.24212376e-03
  5.04042208e-02 -1.22399246e-02 -4.93987612e-02 -1.41985537e-02
 -9.92277451e-03  5.69332391e-02 -1.06312148e-03  2.39377804e-02
 -4.38123792e-02 -5.88427410e-02 -6.77045621e-03  4.43863384e-02
  1.99340302e-02 -2.55985297e-02  2.97144800e-02  3.54391597e-02
 -5.03237406e-03 -3.75376642e-02 -5.25472201e-02  1.76133458e-02
 -1.26516009e-02 -1.80768350e-03 -4.91142385e-02 -6.28707203e-33
 -4.86951508e-02 -1.03625730e-02 -2.51362119e-02  2.87973881e-02
 -7.62778521e-02  9.95006971e-03 -7.58444518e-02 -1.22734415e-03
 -5.65680722e-03  3.07113938e-02 -4.14074473e-02  4.76490241e-03
 -5.00418106e-03  3.14949118e-02  5.73860928e-02  3.42953317e-02
  2.90123187e-02 -1.50555810e-02  1.78492896e-03  2.77523715e-02
  2.57784277e-02  3.08357757e-02  7.99450502e-02 -2.84629539e-02
  3.59659120e-02 -1.74766108e-02 -4.61120578e-03  1.63627267e-02
 -1.10498967e-03  2.64744200e-02 -1.43535454e-02  8.68764985e-03
  3.56255397e-02 -4.51129787e-02 -3.98631357e-02  3.78678888e-02
 -1.24905571e-01 -3.12535800e-02  1.10632405e-02 -1.94501709e-02
 -6.02585487e-02 -4.08031419e-02  8.02314654e-02 -1.68454535e-02
  3.81282195e-02 -1.98947974e-02  4.89008948e-02 -4.08865586e-02
 -3.85139436e-02 -3.71758640e-02 -7.08510503e-02  2.23812293e-02
 -3.08280624e-02 -6.93764444e-03  3.66510116e-02  5.11695147e-02
 -2.33783871e-02  3.60106528e-02 -8.39551538e-02 -7.51508458e-04
  2.11676043e-02  7.82740861e-02  4.31243964e-02  1.04318373e-02
  5.60175441e-03  4.86491993e-02  4.19352278e-02 -2.01979605e-03
 -4.63686278e-03  1.15668389e-03  1.43980309e-02  2.76859850e-02
  6.27094135e-02  1.91712119e-02  5.32032996e-02  3.01924143e-02
 -6.49608448e-02  1.65290534e-02  2.72909831e-02  5.44782765e-02
  2.20080335e-02  1.15311537e-02 -4.62259464e-02 -2.03227587e-02
 -7.09225377e-03 -5.92269413e-02  1.79362763e-02 -2.96768863e-02
 -4.95242979e-03 -2.18172651e-02 -2.24718545e-02  2.29368415e-02
  5.16903820e-03 -4.12715264e-02  1.06215402e-02  1.02264816e-02
 -2.68110912e-03  2.36149468e-02 -9.55859292e-03  3.89329828e-02
 -6.09429665e-02 -2.05542203e-02 -4.03077155e-02  6.26836624e-03
  2.91867256e-02  1.67542603e-02  5.22819236e-02  5.74104208e-03
 -2.41444018e-02 -2.94913631e-02 -1.39974552e-04 -1.39721949e-02
 -4.15188856e-02  6.94017708e-02  4.58013862e-02  6.61966903e-03
  1.11611933e-02  4.10419777e-02  3.59105542e-02  2.43218038e-02
 -1.66082662e-02 -1.28906881e-02  1.62682272e-02  1.88833252e-02
 -1.42740142e-02  3.96225229e-03 -3.01941428e-02  4.73859608e-02
  2.86551304e-02 -5.91627844e-02 -1.62188131e-02 -1.29134825e-03
  2.99677566e-07  6.92983270e-02  5.79694621e-02  4.51538153e-02
 -1.01748193e-02  3.74763496e-02  1.80221349e-02 -7.47077772e-03
  4.29824553e-02  1.61886998e-02 -3.36674415e-02  5.46190073e-04
 -3.60486028e-03  3.58220860e-02 -1.21788848e-02 -1.20144092e-01
 -1.78837348e-02 -1.10062912e-01  1.03142404e-03 -2.45465729e-02
 -3.01829632e-02  4.86107096e-02  1.16427109e-01  1.72510389e-02
  7.05112284e-03 -2.27045175e-02  6.93338504e-03  4.27488722e-02
 -1.53515404e-02 -1.24679198e-02  9.83759668e-03  3.43528949e-02
  2.91106105e-02 -3.40991840e-02 -1.33640897e-02 -1.86413638e-02
  3.47733311e-02  3.26770619e-02  6.20567389e-02 -2.89620105e-02
  1.30637665e-03  1.48650529e-02 -1.45880319e-02  1.79112311e-02
 -3.38144153e-02  6.11060634e-02 -7.81800374e-02 -4.57697809e-02
 -2.19235220e-03 -6.88422248e-02  2.61899456e-02  3.75882490e-03
  2.35247519e-03 -1.42770251e-02  3.14821973e-02 -1.09471241e-03
 -3.51283588e-02 -3.20804156e-02 -5.67700900e-02 -3.98496240e-02
  2.96742786e-02 -2.18445547e-02 -2.39650141e-02 -1.11081991e-02
  2.93552857e-02 -1.04667777e-02 -3.30388770e-02 -4.58697192e-02
  3.19043815e-34  5.45070879e-02 -1.18623134e-02  2.10956614e-02
  3.81368399e-02 -8.04401748e-03 -3.90904024e-02 -6.76159933e-03
  3.05194524e-03  4.39300127e-02 -6.45826533e-02 -2.69844905e-02]"
"In C. Cortes, N. D. Lawrence, D. D. Lee, M. Sugiyama, and R. Garnett, editors,
Advances in Neural Information Processing Systems 28, pages 2440–2448. Curran Associates,
Inc., 2015.
 [35] Ilya Sutskever, Oriol Vinyals, and Quoc VV Le. Sequence to sequence learning with neural
networks. In Advances in Neural Information Processing Systems, pages 3104–3112, 2014.
 [36] Christian Szegedy, Vincent Vanhoucke, Sergey Ioffe, Jonathon Shlens, and Zbigniew Wojna.
 Rethinking the inception architecture for computer vision. CoRR, abs/1512.00567, 2015.
 [37] Vinyals & Kaiser, Koo, Petrov, Sutskever, and Hinton. Grammar as a foreign language. In
Advances in Neural Information Processing Systems, 2015.
 [38] Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V Le, Mohammad Norouzi, Wolfgang
Macherey, Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, et al. Google’s neural machine
translation system: Bridging the gap between human and machine translation. arXiv preprint
arXiv:1609.08144, 2016.
 [39] Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei Xu. Deep recurrent models with
fast-forward connections for neural machine translation. CoRR, abs/1606.04199, 2016.
 [40] Muhua Zhu, Yue Zhang, Wenliang Chen, Min Zhang, and Jingbo Zhu. Fast and accurate
shift-reduce constituent parsing. In Proceedings of the 51st Annual Meeting of the ACL (Volume
1: Long Papers), pages 434–443. ACL, August 2013.
 12
","[ 3.29425409e-02  3.33654135e-02 -1.61844250e-02  3.74030098e-02
 -4.81912382e-02 -5.99702541e-03  5.18405735e-02 -1.24663254e-03
 -7.26227239e-02 -3.90558243e-02  2.15734076e-02 -6.57934174e-02
  5.28157726e-02  1.47775030e-02  3.93888317e-02 -4.60118651e-02
  4.02979814e-02  2.52333488e-02 -2.88289469e-02  1.56201227e-02
 -3.36898118e-02 -1.31163932e-02  7.77105289e-03  6.65993318e-02
  7.49898469e-03 -1.96548104e-02 -6.81628240e-03 -2.22387742e-02
 -1.27203949e-02 -3.07020843e-02 -2.60795769e-03  2.40183398e-02
  1.49621246e-02  8.89483690e-02  2.49782738e-06 -5.24416454e-02
 -1.24832513e-02  1.48568796e-02 -7.98729307e-05  1.76381208e-02
  1.57317054e-02 -3.66223715e-02 -2.86814403e-02 -9.08170640e-03
 -4.25533578e-02 -3.85805294e-02  1.02465205e-01  2.81546153e-02
  3.01441662e-02  1.25144392e-01 -1.69375651e-02 -4.84668761e-02
  2.36563478e-02 -4.80742641e-02  1.86064304e-03 -3.70921753e-02
  3.36566777e-03 -4.84736860e-02 -5.48398606e-02 -3.29115354e-02
 -2.69068293e-02  3.71969827e-02  3.24232094e-02 -2.88562551e-02
 -4.24144510e-03  2.10529771e-02 -3.68937515e-02 -5.26155829e-02
  8.35511554e-03  4.61228266e-02 -3.86632211e-03 -1.44576859e-02
 -1.55022403e-03  1.83809381e-02 -1.68008748e-02  2.50573945e-03
 -4.81722839e-02  1.67785734e-02 -3.94395133e-03  3.81455347e-02
  5.62812872e-02 -4.15051021e-02  2.57334970e-02  6.06785296e-04
 -3.25006656e-02  9.92396753e-03  9.30972528e-05 -4.57349271e-02
 -9.08930879e-03  4.54928204e-02  2.54852362e-02 -4.73317727e-02
  3.46116573e-02  1.30435703e-02  8.79394531e-04 -1.65358093e-02
 -2.72052698e-02 -7.96384513e-02 -1.87240429e-02 -9.08493996e-02
  6.26412854e-02  2.99401209e-02 -1.09918965e-02  8.91708583e-03
 -8.85878876e-03  6.97039813e-02 -4.08200957e-02  8.19921307e-03
 -3.35452221e-02  1.99631378e-02 -1.39589636e-02  3.07775871e-03
 -4.93693277e-02  1.86640229e-02 -3.46038193e-02 -2.45903479e-03
 -6.12029955e-02  1.05283298e-02  1.26294950e-02  2.05235872e-02
 -1.86092965e-02  2.39650682e-02 -9.55687985e-02  2.39914320e-02
 -1.10028759e-02  3.78785767e-02  1.70709658e-02 -6.00109855e-03
  2.64212769e-02 -3.44236828e-02 -3.97296585e-02  1.99227110e-02
  4.83635906e-03 -9.84677672e-03 -3.37216035e-02  4.80628312e-02
 -9.75828152e-03 -1.44942980e-02  3.13139372e-02  4.14081803e-03
 -2.28337422e-02 -3.60923707e-02  3.56954113e-02 -7.58363083e-02
  2.09253598e-02 -7.22450996e-03 -7.39931036e-03 -3.44930254e-02
  4.49183444e-03  3.20796743e-02 -1.70635246e-02  2.53725965e-02
 -2.04250421e-02 -1.70321837e-02  2.22014207e-02 -8.63787532e-03
  3.62676717e-02  3.40824798e-02  4.33465950e-02 -8.30091722e-03
  2.85455715e-02 -4.19029705e-02 -1.96125619e-02  2.80753337e-02
 -1.65907703e-02 -1.69563387e-02 -1.97587460e-02 -5.40250130e-02
 -2.36431677e-02  4.12567854e-02  1.77025832e-02  4.76852246e-02
 -2.48440541e-02 -6.27022283e-03  4.65277769e-02  7.91511834e-02
  2.92964857e-02  6.84767738e-02  4.54233512e-02 -1.55190220e-02
  1.52241699e-02  3.96565720e-02 -4.57230695e-02  2.19609346e-02
 -7.70736113e-03  6.48581749e-03 -2.92648524e-02  4.20975760e-02
  8.34287796e-03 -5.29134534e-02  2.13366896e-02 -8.44029151e-03
 -5.18174889e-03 -5.16106114e-02  3.25208865e-02  1.89593136e-02
 -2.35502534e-02 -1.43492641e-02 -2.95525361e-02 -5.61983325e-02
  1.59185305e-02 -3.90792787e-02 -3.58937830e-02  2.58588176e-02
  1.20387657e-03 -6.30659936e-03 -5.40027879e-02 -2.73522753e-02
 -6.29795808e-03  5.46261854e-02  4.16178405e-02  2.98026241e-02
  1.67538375e-02 -3.68387699e-02  1.40302414e-02  6.15433836e-03
  2.33673137e-02 -1.13982242e-03 -4.44494933e-02  4.12684120e-02
  1.78854354e-02  1.85163282e-02 -7.14355409e-02  3.77886705e-02
  1.42845949e-02 -9.74098779e-03  3.64805316e-03  1.28466357e-02
  4.36005220e-02  1.83331501e-02 -1.95946824e-02  1.30150998e-02
  4.50496711e-02 -2.95737032e-02 -1.81912328e-03  4.92828973e-02
 -6.24603033e-02 -5.76392524e-02  4.37873304e-02 -7.49732032e-02
  8.71560629e-03  1.09421015e-02 -5.26070483e-02 -6.45674840e-02
  2.77692582e-02 -2.89814770e-02  1.05549404e-02 -5.10214418e-02
  4.48975340e-02  2.21574269e-02  4.04076539e-02 -4.01662942e-03
  2.41472647e-02 -1.12612424e-02  1.99691840e-02  1.28312092e-02
 -4.87580779e-04  2.12311782e-02 -5.97842373e-02 -3.35734747e-02
  6.35084957e-02 -1.36272458e-03  7.44182523e-03  2.16567963e-02
  3.72906849e-02 -3.34402211e-02 -4.34019929e-03 -4.26255539e-02
 -1.30078485e-02 -1.74524356e-02  3.46677378e-02  1.92571040e-02
  1.48242880e-02  2.62078140e-02  1.20678172e-02 -2.67801136e-02
  4.54466045e-02  2.84950975e-02  1.28684938e-02  5.16854525e-02
  1.38319908e-02 -1.02895685e-03 -3.45986225e-02 -3.98009978e-02
 -2.39464361e-02  4.66574505e-02  8.46623909e-03 -8.83972421e-02
 -4.40176874e-02 -1.45714562e-02 -2.54937401e-03  4.96537723e-02
  1.09843332e-02 -7.98837170e-02  1.53185744e-02 -1.00728236e-02
 -2.06005070e-02  9.02229697e-02  5.63578494e-03  3.69998366e-02
 -3.24877352e-02 -1.76669192e-02 -2.33697128e-02  7.77570298e-04
 -3.53549197e-02 -4.69996268e-03 -3.80937830e-02 -1.07101481e-02
  8.80707242e-03  8.75720009e-02  6.16664620e-05 -2.81500444e-03
 -1.90754868e-02 -6.15513825e-04 -2.59392913e-02 -5.70000708e-02
  2.04775110e-02 -1.49229437e-03 -2.96519343e-02 -1.40077178e-03
 -2.93246154e-02 -5.09966165e-02  7.54580498e-02 -2.68843099e-02
 -1.63565706e-02 -5.71043901e-02 -1.14586651e-02  4.79823211e-03
  2.21264809e-02  2.10543182e-02  1.28054107e-02  4.84119616e-02
 -3.99447270e-02 -2.44253185e-02  7.11048618e-02 -1.48384235e-04
 -1.36834076e-02  6.16839379e-02 -2.54375879e-02 -1.84379667e-02
 -5.69335967e-02 -2.04141140e-02  7.20520597e-03 -1.27955563e-02
  1.72455627e-02 -4.25420469e-03 -5.46032749e-03 -3.37857120e-02
 -4.01971936e-02 -1.33566400e-02  8.56352784e-03  4.55478318e-02
 -2.83003002e-02  2.20295284e-02 -3.81589383e-02  2.48099752e-02
  3.79941836e-02  3.93076800e-02 -5.26646012e-03 -1.59629434e-03
  4.24877256e-02  3.29857282e-02  1.35184722e-02  2.45465599e-02
 -4.68584299e-02  1.28339957e-02  2.67661382e-02 -1.69503633e-02
 -8.39432552e-02  2.30467282e-02  3.35068218e-02 -8.28214362e-02
 -1.60731673e-02  1.09775871e-01 -1.76284090e-02 -6.56887740e-02
 -1.15685090e-02  7.81574193e-03 -2.06133742e-02  1.55157764e-02
 -1.40244672e-02 -7.89294317e-02  4.30848962e-03 -3.30668571e-03
 -1.03617078e-02  7.03964429e-03 -4.23898064e-02 -1.00544770e-03
 -7.09920228e-02  4.40043248e-02  1.49088167e-02 -6.56354874e-02
 -2.80993376e-02 -6.45247195e-03 -2.81222668e-02  1.02704139e-02
  1.10940589e-02  2.34885188e-03 -7.91488681e-03  8.51875637e-03
  3.74314561e-02 -2.54826751e-02 -4.71909456e-02 -4.62388508e-02
 -7.87878335e-02 -3.82223399e-03  9.37587917e-02  6.42335489e-02
 -4.58548702e-02 -1.40919881e-02  3.07707787e-02 -2.39418708e-02
  1.66264828e-02 -2.06142874e-03  2.92959809e-02 -2.77754106e-02
 -1.77181009e-02  5.18958233e-02  3.08764074e-02 -9.30434093e-03
  3.50757279e-02 -7.70476134e-03  8.79897773e-02 -4.12085988e-02
  2.32481249e-02 -1.82113703e-02  2.95663457e-02 -2.03566197e-02
  1.72177963e-02  4.23717238e-02 -4.92059588e-02 -6.22475632e-02
 -5.02687544e-02  3.96905020e-02 -6.61714375e-02  1.06952321e-02
  4.06104652e-03  5.95553499e-03 -8.13038871e-02 -1.02492109e-01
 -5.27511053e-02  3.64742125e-03  2.90176757e-02  1.34579698e-02
  1.51413158e-02  4.02480327e-02 -1.60071459e-02 -1.35991815e-02
  1.26570063e-02  3.36250700e-02 -2.36576479e-02 -5.84063083e-02
  1.94826685e-02  9.08298325e-03  1.80667974e-02 -7.39325024e-03
  1.73322018e-02 -4.28790152e-02 -5.66389970e-02  1.32701937e-02
  5.10468222e-02  2.02302653e-02  6.38202939e-04 -2.62612570e-02
 -3.62510160e-02 -2.64624488e-02  5.90282492e-02  2.03830563e-02
  1.26261739e-02  3.46260518e-02 -5.17945923e-02 -6.38284720e-03
  3.32992487e-02  8.57078470e-03 -1.25969723e-02 -3.04420814e-02
  1.77686904e-02  4.92974464e-03 -4.91317622e-02  3.76095735e-02
 -4.37249104e-03  6.97303712e-02 -1.45341607e-03  1.00442059e-02
 -1.67817213e-02  1.97601449e-02 -1.80172035e-03 -6.66105794e-03
 -5.84610030e-02 -2.81139463e-02  4.79233004e-02  5.14858030e-02
  2.08451450e-02  3.59998904e-02  2.11260021e-02  6.47409106e-05
 -6.62094951e-02  4.79753166e-02  1.11710615e-02  6.51900694e-02
 -1.37544377e-02  3.19805071e-02 -5.12493029e-03 -1.00842072e-03
 -3.47241350e-02  2.32243966e-02 -3.19658332e-02  3.54934037e-02
  4.19297032e-02  6.55547380e-02 -1.94619386e-03  1.30489003e-02
 -5.11062592e-02 -5.91802271e-03 -4.03377675e-02 -2.72113159e-02
  1.19622745e-01 -3.12486757e-02  9.16457847e-02 -7.03448942e-03
 -4.44216793e-03 -9.48378071e-03  5.12515195e-02  4.61990293e-03
 -1.22327097e-02 -1.26772863e-03 -8.54834542e-03 -8.08082521e-03
 -4.75576986e-03  7.99457803e-02 -2.55657621e-02 -4.21633385e-03
  2.37644501e-02 -8.56417511e-03  1.79627072e-02 -5.45471534e-02
 -1.21375527e-02 -3.39799724e-03  3.23416702e-02 -2.36715432e-02
  4.13451390e-03 -4.87534627e-02  4.05741073e-02  1.28935161e-03
  2.95541510e-02 -2.83841025e-02  3.18097956e-02  7.66717121e-02
 -3.06829414e-03 -4.49718274e-02 -1.64051000e-02  1.50345284e-02
  8.53461493e-03 -2.12864634e-02 -7.48918904e-03 -6.58951644e-33
 -2.80035641e-02  1.10955387e-02 -5.77284349e-03  1.75758246e-02
 -7.71427378e-02 -1.96572021e-02 -4.16063592e-02 -1.51572451e-02
 -1.95409805e-02  9.85064544e-03 -5.17117679e-02  2.29706988e-02
  1.57766212e-02  4.63653170e-02  4.18204591e-02  3.01289260e-02
  4.84178886e-02 -4.98537682e-02  8.94474704e-03  5.88682131e-04
  3.53442058e-02  3.51930819e-02  1.40592977e-01 -1.49664758e-02
  2.05872636e-02  3.21773142e-02 -5.70110395e-04  1.32770836e-02
 -3.34309577e-03  1.34597998e-02  9.34195332e-03  1.20113287e-02
  3.63748707e-02 -4.88177836e-02 -4.03808691e-02  1.10343089e-02
 -9.38845128e-02 -6.81202253e-03 -2.52945977e-03  3.16872559e-02
 -6.38581514e-02 -2.35990249e-02  6.88363612e-02 -3.22716832e-02
 -1.66040715e-02  2.52014268e-02  1.49503881e-02 -6.82413876e-02
 -3.82035859e-02 -2.45733261e-02 -4.50218134e-02 -6.72293687e-03
 -1.31915761e-02  5.40231802e-02  4.50582281e-02  2.31797993e-02
 -4.35170867e-02 -4.62257490e-03 -1.15526773e-01 -1.76468957e-02
  2.01070774e-02  1.21297032e-01  4.72698808e-02  1.51947932e-02
  1.92901548e-02  1.12392725e-02  4.98558059e-02 -1.33260144e-02
 -1.74447373e-02  5.86979575e-02  2.95793135e-02  3.49009372e-02
  4.11394201e-02  2.66332198e-02  7.55717456e-02 -2.87063085e-02
 -5.71933612e-02  2.71714628e-02  4.04620124e-03  4.20925394e-02
  3.45638767e-02  4.30599740e-03  2.31337734e-03 -2.40772869e-02
 -1.23164700e-02 -5.09115830e-02 -8.03264556e-04 -3.50399725e-02
  1.62963162e-03 -1.89720001e-02  1.54687399e-02  2.01894715e-02
  3.56257446e-02 -4.01438661e-02  3.15843374e-02  2.27287668e-03
 -1.29802385e-02  1.60809215e-02  1.36888130e-02  1.87440366e-02
 -8.27561319e-02 -4.59179133e-02 -1.61206555e-02  4.13146652e-02
  5.15483990e-02 -1.14823431e-02  4.45318706e-02  7.73428613e-03
 -1.42469071e-02 -9.03755520e-03 -1.67153943e-02  2.75916932e-03
  3.54674160e-02  3.99172828e-02  3.08591761e-02 -2.13174224e-02
  3.91350500e-03  5.94633333e-02  1.12074623e-02  7.63056614e-03
 -2.94025838e-02 -1.24634588e-02  8.02259799e-03  2.08015237e-02
 -4.43308279e-02 -6.78785751e-03 -2.96518970e-02  3.60325314e-02
  5.32859042e-02 -5.87357990e-02 -2.79710647e-02  3.81851457e-02
  3.24140927e-07  3.06991935e-02  3.52258720e-02  5.48035130e-02
  1.96282403e-04  4.56557423e-02  9.21379216e-03 -1.35198105e-02
  5.13418391e-02  2.40140315e-02  1.29968086e-02  6.41395897e-03
  3.79878329e-03  3.42008099e-02  4.21446795e-03 -6.38708249e-02
 -4.60110568e-02 -6.42462671e-02  1.45553900e-02 -4.01341654e-02
  3.04483566e-02 -2.80596921e-03  9.49807093e-02 -1.65733621e-02
 -1.20145092e-02 -5.18610748e-03 -4.32780869e-02  2.67651342e-02
 -1.91431288e-02  1.93157280e-03  1.76049098e-02  4.05836552e-02
  4.44209622e-03 -2.51927730e-02 -2.55860034e-02 -1.97991468e-02
  3.79191712e-02  1.75368674e-02  7.26578245e-03  6.77760737e-03
  4.94388444e-03 -8.22632501e-05 -1.45546859e-02 -3.67486198e-03
 -5.62410019e-02  4.96022701e-02 -5.48102371e-02 -3.78115326e-02
  4.62397859e-02 -4.02238518e-02 -2.16094684e-03  9.55659151e-03
 -6.47600275e-03  2.32977327e-02 -2.38136810e-04  2.22995747e-02
  1.91427791e-03 -3.61605287e-02 -2.97066011e-02 -1.95548516e-02
  1.46369329e-02 -1.39559200e-02 -2.98494380e-02 -2.97722947e-02
 -2.83957459e-03  1.60308685e-02  1.59257613e-02 -5.09637110e-02
  3.37713076e-34  7.96762388e-03 -4.15168293e-02  2.63969861e-02
  2.47061737e-02  6.39662379e-03 -3.12936418e-02 -3.27606648e-02
  1.53070465e-02 -2.59467177e-02 -6.62969649e-02 -4.21547666e-02]"
"Attention Visualizations
Input-Input Layer5
It
is
in
this
spirit
that
a
majority
of
American
governments
have
passed
new
laws
since
2009
making
the
registration
or
voting
process
more
difficult
.
 <EOS>
<pad>
<pad>
<pad>
<pad>
<pad>
<pad>
It
is
in
this
spirit
that
a
majority
of
American
governments
have
passed
new
laws
since
2009
making
the
registration
or
voting
process
more
difficult
.
 <EOS>
<pad>
<pad>
<pad>
<pad>
<pad>
<pad>
Figure 3: An example of the attention mechanism following long-distance dependencies in the
encoder self-attention in layer 5 of 6. Many of the attention heads attend to a distant dependency of
the verb ‘making’, completing the phrase ‘making...more difficult’. Attentions here shown only for
the word ‘making’. Different colors represent different heads. Best viewed in color.
 13
","[-4.17718105e-02 -3.84151153e-02 -3.83420773e-02  3.72721180e-02
 -3.25247087e-02  1.87027249e-02 -2.66717728e-02 -2.86970782e-04
 -1.76513661e-02 -2.71681673e-03  3.70581597e-02 -5.60512859e-03
  8.95205885e-03  3.56682502e-02  3.21406238e-02 -7.72367641e-02
  3.35522485e-03  1.88103821e-02 -4.03452292e-02 -7.31567573e-03
 -1.60899088e-02 -2.83696782e-02  5.48606273e-03  3.05311084e-02
 -4.24780212e-02 -2.76337471e-02 -8.28872435e-03 -2.46612318e-02
  3.45258340e-02 -4.64537442e-02 -4.41369787e-02  4.08257917e-02
 -7.64592830e-03 -5.57570206e-03  2.87436251e-06 -3.82264666e-02
  2.38660797e-02 -3.49942520e-02 -7.39203487e-03  3.88166495e-02
  1.94438752e-02 -7.24776983e-02 -1.67684183e-02 -9.78613086e-03
 -1.23395706e-02  1.65790319e-02  4.95818965e-02  1.69158764e-02
  4.97369729e-02 -2.56306725e-03 -8.37953645e-04  4.71971417e-03
 -1.68087836e-02 -3.78590934e-02  5.18170632e-02  4.93564829e-02
  6.20299950e-03 -4.45829295e-02 -2.18825489e-02 -2.05974523e-02
 -8.24946836e-02  1.64646097e-02  4.09377292e-02  2.88742827e-03
  6.64095879e-02  4.78640422e-02  3.20903249e-02 -2.74334252e-02
 -2.73090391e-03  3.11641041e-02 -2.48706155e-02  2.05666889e-02
 -2.30391268e-02 -8.01846292e-03 -2.73836628e-02  4.28740866e-02
 -5.65023161e-02  2.13522427e-02  1.10986261e-02  7.13564409e-03
  9.06003453e-03  1.38539495e-02 -3.29084247e-02 -5.31405061e-02
 -1.33797340e-02 -2.65529659e-02  1.07154297e-02 -3.21206972e-02
  1.80612635e-02  1.81866752e-03  3.48709635e-02 -4.57095802e-02
  4.36419025e-02  9.28932452e-04  4.69724685e-02  1.26551157e-02
  1.93406269e-02 -1.72811858e-02  1.62854996e-02 -5.37392609e-02
  9.89003479e-02  1.54508231e-02 -3.95349264e-02  4.12667170e-02
 -1.23736598e-02  4.09893543e-02 -5.63531071e-02  6.30638562e-03
 -1.83534715e-02  6.12155534e-02  1.65380780e-02  2.34761741e-03
 -4.61562499e-02 -2.07951963e-02 -2.94410419e-02 -3.54438834e-02
 -5.75356856e-02 -4.64302953e-03 -2.14990322e-02 -7.82709941e-03
 -3.94400284e-02 -2.68836897e-02  4.20617958e-04  2.35949978e-02
 -3.44046317e-02  5.50666377e-02 -7.92599097e-02 -1.10340985e-02
 -1.03141088e-02  2.56165471e-02 -4.70799245e-02  1.71220284e-02
 -6.65360410e-03 -9.84848198e-03 -6.10370375e-02  5.99690527e-02
  3.90719026e-02  5.99457696e-03  2.13404396e-03 -1.08604152e-02
  1.23984655e-02  1.51810721e-02  5.77070117e-02  7.65600475e-03
  5.97221497e-03 -1.68420039e-02  1.14126969e-03 -7.09166424e-03
  2.92965155e-02  4.08036169e-03  8.83699488e-03  3.47848274e-02
 -1.19849565e-02 -3.43744047e-02 -7.02741416e-03  1.28024546e-02
  8.29130039e-03  2.08008233e-02  1.70589183e-02  4.35801521e-02
 -3.63712646e-02 -7.52164871e-02  5.41220382e-02 -4.68550064e-02
 -9.05935653e-03  1.71647202e-02 -3.77189219e-02 -4.40757871e-02
 -3.46276872e-02  1.01204831e-02  8.20766911e-02  5.86355198e-03
 -5.85631141e-03 -1.33010121e-02  3.92267480e-02  5.67719564e-02
  3.08169480e-02 -2.66397856e-02 -1.53762400e-02  2.26281118e-02
 -2.10684892e-02  7.45082200e-02 -2.08821241e-02  8.95029902e-02
 -4.10818234e-02  1.01338665e-03 -4.28395271e-02  9.33378283e-03
 -3.07047088e-02 -5.48331402e-02 -2.36219801e-02  3.97036597e-02
 -9.04684048e-03 -3.77510041e-02  2.14956068e-02  1.42450314e-02
 -4.85576354e-02 -2.59578936e-02  9.93982144e-03 -3.64552885e-02
 -3.01975128e-03 -1.66643951e-02  7.80360121e-03  3.50010656e-02
 -3.01993024e-02  9.96632315e-03  2.32576430e-02 -3.33904549e-02
  2.61490457e-02  4.52978611e-02 -7.34968483e-03  4.68020886e-02
 -3.43322232e-02 -1.06842360e-02 -4.49463502e-02 -3.72105837e-02
  7.80359842e-03  1.38002355e-02 -9.87849310e-02  3.30405473e-03
  2.02150736e-03  4.46746312e-02  9.96397529e-03  2.29716599e-02
  6.95416108e-02  2.61314232e-02 -4.31464277e-02  4.56805788e-02
  8.81160703e-03 -1.19574172e-02  1.03956182e-02  4.31024618e-02
  6.39364943e-02 -4.21609618e-02  3.25592943e-02  2.82007568e-02
  8.23334977e-03  4.59901392e-02 -1.47143165e-02 -7.09057972e-02
  1.08877178e-02 -2.29075179e-02  2.92019248e-02 -3.21541391e-02
  6.54944927e-02 -8.17435309e-02  3.63116935e-02  1.33912675e-02
  6.58228877e-04  1.25780059e-02  4.30123024e-02 -2.25520581e-02
  6.18605502e-02 -3.17485854e-02 -3.23045067e-04 -9.31347720e-03
  3.31474561e-03  4.79063485e-03 -3.52855101e-02  4.96786125e-02
 -1.43568171e-02 -1.27418311e-02 -1.88899599e-02 -1.69016160e-02
 -2.94302888e-02 -7.89586902e-02 -6.49716472e-03  5.99218868e-02
 -5.06561659e-02 -1.12536196e-02  1.10156331e-02  3.04081105e-02
 -3.42300981e-02 -2.03606114e-02 -1.84080824e-02  5.51159568e-02
  4.63187136e-02 -1.84030682e-02  7.41673587e-03  2.59278025e-02
 -2.28119269e-02 -2.61201821e-02 -4.56681103e-02 -3.10179219e-02
 -3.65016214e-03  4.34003286e-02  4.05985303e-02 -6.99577108e-02
 -4.41540517e-02 -2.10075434e-02  6.33266345e-02 -1.24063343e-02
  4.20547388e-02 -6.18819855e-02  2.35523377e-02  1.07312519e-02
  9.42151248e-02  1.03257120e-01  3.07131745e-02  1.12266645e-01
  4.16032672e-02 -8.82572087e-04 -1.24936877e-02  1.93689764e-02
 -3.51271927e-02  6.98250234e-02  9.17746127e-03 -2.41476353e-02
  4.45974208e-02  6.77035749e-02  1.67031232e-02  1.82725117e-02
 -4.96980287e-02  7.06014559e-02 -3.58029753e-02 -2.96138767e-02
 -3.17988284e-02 -2.20566746e-02 -3.94662879e-02  7.42876753e-02
 -9.03643377e-05 -9.08691809e-03  1.64954141e-02  2.80508939e-02
  3.30573432e-02  2.44429931e-02  4.58612330e-02 -1.86354481e-03
  6.84896559e-02  1.42597063e-02  3.06221843e-02  1.64084062e-02
 -6.02292493e-02  1.09350355e-02  4.19344567e-02 -7.80831417e-03
 -1.02551840e-02  5.00357151e-02 -1.96952894e-02 -4.76478823e-02
 -1.37493564e-02 -1.58961918e-02 -5.11382818e-02  3.80478762e-02
  2.66884100e-02 -2.71174219e-02  7.19468947e-03  6.66119950e-03
 -1.55145936e-02  3.40252295e-02  3.83257791e-02 -2.32161637e-02
 -1.18165025e-02 -2.21469696e-03 -5.21359732e-03  5.10560768e-03
 -2.63656769e-02  3.38994637e-02 -1.54553354e-02 -7.98287541e-02
  3.15869711e-02  3.93145308e-02 -8.83733854e-03  7.00635090e-02
 -2.01512929e-02  3.83436568e-02  4.45179902e-02 -2.48464476e-02
 -1.01508119e-03 -1.12107676e-02  7.10682124e-02 -3.38221453e-02
 -9.66397021e-03  3.12042031e-02  3.74321057e-03 -5.37034683e-02
  5.80677688e-02 -6.59403428e-02 -3.92415076e-02  3.02087665e-02
  3.02530974e-02 -3.55821215e-02  3.55383120e-02 -2.12300625e-02
 -1.66899581e-02  1.16350632e-02 -3.19144479e-03  3.02690566e-02
 -4.19544503e-02  9.48896185e-02 -7.07182428e-03 -2.66492758e-02
 -7.43932426e-02 -2.45199464e-02  2.41599791e-02  2.98968907e-02
 -3.06616556e-02  1.44383113e-04 -2.33583990e-02  9.58360638e-03
  2.20090691e-02  2.81127393e-02  4.14575217e-03 -4.03634235e-02
 -1.50914676e-02  1.98311009e-03  9.80874430e-03  3.46210338e-02
 -1.37938065e-02 -7.79532269e-02  2.71213483e-02 -3.03349141e-02
  4.70689908e-02  7.91232567e-03  6.09253459e-02  6.40450567e-02
 -3.28454152e-02 -4.78360206e-02 -3.40070947e-05  1.29320314e-02
 -6.20125188e-03  1.15942974e-02  3.77574936e-02 -3.76423299e-02
 -1.18451845e-02 -2.94219293e-02  5.24153337e-02 -5.39002568e-02
 -1.02117732e-02  8.69502053e-02 -2.40478087e-02  7.86943641e-03
 -3.68688665e-02  7.13870376e-02 -4.87919897e-02 -2.93714646e-02
  2.78178584e-02  1.42515153e-02 -5.78477755e-02 -3.37801762e-02
 -2.49927342e-02  1.86172295e-02  4.29399274e-02  1.63555555e-02
 -3.31675224e-02  6.14379607e-02 -4.87688631e-02 -2.27977298e-02
  3.08984797e-02  5.40240295e-03  1.56806204e-02  1.77145135e-02
 -4.89975847e-02 -3.76431495e-02  6.69320896e-02 -2.16337908e-02
 -4.55432711e-03 -3.85735147e-02  1.54778697e-02  5.73747233e-02
  2.67201457e-02  2.98136268e-02 -5.13064824e-02 -2.80600935e-02
 -2.45173536e-02 -5.26050851e-02 -8.65812749e-02  2.20000837e-02
 -1.40219752e-03 -2.79671736e-02 -4.97097038e-02  3.84145859e-03
 -2.79261637e-02  3.03850230e-02  2.00104527e-02  9.10459086e-03
 -1.51925264e-02 -4.26121615e-02  1.32039119e-03  2.26474069e-02
 -2.65954565e-02  8.85878801e-02  3.04358173e-02  3.73237766e-02
 -1.27531542e-02  3.04211602e-02 -2.99600754e-02  1.93867050e-02
 -8.45798012e-03 -4.99940999e-02  5.63104972e-02 -1.26292249e-02
  3.97603028e-03  5.13922572e-02  1.87210017e-03 -3.60771865e-02
 -6.58654049e-02  9.21071768e-02 -3.21516544e-02  1.75249577e-02
  5.93823206e-04  1.70827974e-02 -1.61248520e-02  3.02181393e-02
 -2.49761567e-02  3.76995504e-02  2.48397011e-02  5.04260026e-02
 -1.42091559e-02 -2.12769443e-03  2.44635306e-02  1.90074798e-02
 -1.75205562e-02 -3.63703892e-02 -1.36596495e-02 -8.70788097e-03
  5.07881790e-02 -3.96686420e-02  2.82810256e-02  3.18654813e-02
  9.76620358e-04  1.38219679e-02  2.14508194e-02 -1.49408104e-02
 -1.16228336e-03  3.05022057e-02  5.45456074e-03  4.29990236e-03
 -9.27223638e-02  4.66836207e-02 -6.53766096e-02 -2.26448048e-02
  4.61391546e-03  1.58670917e-02 -2.23555472e-02 -1.43024675e-03
  1.89115796e-02  2.44039437e-03  3.93508095e-03  7.25555420e-03
 -3.78924124e-02 -2.27340199e-02 -1.50469341e-03 -1.61978975e-02
  1.74131524e-02  1.82890352e-02  5.16486727e-02 -4.43853661e-02
 -1.30468216e-02 -7.24479333e-02  3.12599167e-02  1.81633625e-02
 -3.79715264e-02 -1.46747408e-02  1.13569591e-02 -8.17817428e-33
 -3.85420211e-02 -2.67125051e-02  1.42868077e-02 -4.74791378e-02
 -6.08378500e-02  2.15040669e-02 -4.72827293e-02  4.17177798e-03
 -1.81169230e-02  5.55136846e-03  4.66782460e-03  1.71234328e-02
  1.00827329e-02  8.81876051e-03  4.81545068e-02 -5.01267985e-03
  2.61230823e-02 -9.95106064e-03 -1.09841162e-02  1.79645661e-02
 -2.24196054e-02  2.47605219e-02  6.88341632e-02 -3.75157259e-02
 -2.66532898e-02  5.44841215e-02 -1.51629057e-02 -4.76284511e-02
  1.23910129e-03 -2.20013503e-03 -3.11325602e-02  1.99314598e-02
 -6.12098351e-03 -9.11113396e-02 -3.52201797e-02  2.21407618e-02
  3.53730051e-03 -7.05530941e-02 -3.30683999e-02  3.97973694e-04
 -1.00884803e-01 -5.58501147e-02  3.45100611e-02  1.98239423e-02
 -1.31567596e-02 -1.35579088e-03  3.14129293e-02 -2.42259707e-02
 -1.70106497e-02  5.41690364e-02 -6.66600168e-02  8.48200289e-04
 -6.44578934e-02  2.88921762e-02 -9.33111273e-03  2.66126301e-02
  6.10226113e-03 -5.21355402e-03 -7.87718147e-02  7.12643862e-02
  5.42589417e-03  1.68910380e-02  2.79034916e-02  1.80784743e-02
  3.95709500e-02  2.73269620e-02  2.72617191e-02  1.19064525e-02
 -5.49206808e-02 -9.98848304e-03  3.80502967e-03  4.83448543e-02
  5.71633801e-02 -7.83746243e-02  6.40934855e-02 -6.21795096e-02
 -3.66113037e-02 -1.45621542e-02 -4.64872178e-03  9.29245427e-02
  2.10066140e-02  6.80975989e-03 -2.99064573e-02 -7.77157536e-03
  1.93632953e-02 -2.08385643e-02 -2.75330562e-02 -4.65741381e-03
  1.43430913e-02 -2.21479442e-02  2.62000430e-02 -3.14951851e-03
 -2.69581880e-02  1.55500304e-02  5.04181497e-02 -9.28822625e-03
  1.72372703e-02  1.84734315e-02  1.69375353e-02 -5.17724901e-02
 -2.63872687e-02  2.17755996e-02 -2.71420199e-02  1.05236294e-02
  2.92491950e-02  1.51654687e-02 -3.99202248e-03 -4.00354676e-02
 -3.76029760e-02 -2.31942739e-02 -1.77339409e-02 -2.29922459e-02
  5.58159240e-02 -2.47413702e-02  1.86164360e-02 -3.40930969e-02
 -1.66340973e-02 -2.15041917e-03  2.32132571e-03 -9.03243478e-03
  4.61079041e-03  1.38115790e-02 -3.04961018e-02  4.25188132e-02
 -2.73378603e-02 -2.87827551e-02 -7.55716041e-02  5.51685616e-02
  6.01099208e-02 -1.07833192e-01 -4.32965122e-02  2.38829339e-03
  3.64927899e-07  4.98215705e-02  6.31038025e-02  2.82559432e-02
  6.92999959e-02  2.86309496e-02 -2.14277413e-02 -1.62042268e-02
  6.93368688e-02  4.05207090e-03 -1.88990273e-02 -1.29171740e-02
  2.38113794e-02 -3.03511019e-03  2.60477676e-03 -2.84396019e-02
 -2.80882027e-02 -3.12720216e-03  1.34210968e-02 -9.30141471e-03
  4.79204245e-02  9.11896452e-02  3.70089076e-02  4.51215915e-03
  3.11343875e-02 -5.14285378e-02 -7.21146306e-03  1.70659404e-02
 -1.59588624e-02  4.43044193e-02 -3.75160910e-02 -2.43320130e-03
 -8.80529359e-03 -2.61653289e-02  4.69105542e-02 -2.93417629e-02
 -3.63738909e-02 -8.89982097e-03 -1.91128664e-02 -2.48467587e-02
  1.02935610e-02  2.13934220e-02  2.60216445e-02  2.09578555e-02
 -9.11631063e-03  2.13852078e-02 -5.94096594e-02 -2.62199622e-02
  9.21178609e-03  3.27956416e-02  3.57064269e-02  5.08044846e-02
  2.79340614e-03 -3.76601629e-02 -4.99491468e-02  1.95303522e-02
 -3.33055072e-02 -3.09088756e-03 -3.91219221e-02  2.21500210e-02
  1.15655633e-02 -6.45877561e-03 -6.72821235e-03 -6.23224042e-02
 -7.19843898e-03  4.91183363e-02  1.26044080e-02 -1.00449637e-01
  3.59501323e-34  1.14042806e-02 -1.13202473e-02  5.91871813e-02
 -1.86672788e-02  5.68914227e-03 -5.20528704e-02 -6.28617872e-03
  1.18450969e-02 -1.72098149e-02 -5.04646376e-02 -4.11691926e-02]"
"Input-Input Layer5
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
Input-Input Layer5
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
Figure 4: Two attention heads, also in layer 5 of 6, apparently involved in anaphora resolution. Top:
Full attentions for head 5. Bottom: Isolated attentions from just the word ‘its’ for attention heads 5
and 6. Note that the attentions are very sharp for this word.
 14
","[ 2.37671565e-02 -1.06331585e-02 -2.82958951e-02  2.27149148e-02
 -3.29381935e-02 -1.59060005e-02 -9.06311907e-03  1.59789100e-02
 -3.10553908e-02 -2.07296051e-02  5.15197543e-03 -5.07569015e-02
  1.46658616e-02 -4.17266525e-02  3.18809226e-02 -4.71790098e-02
  1.87669769e-02  2.47767214e-02 -6.41562715e-02 -2.03624498e-02
  2.48740520e-02 -1.22760488e-02 -3.10579489e-04  1.01650497e-02
  1.89263560e-02 -1.04706287e-02 -3.51821189e-03  5.78194531e-03
 -8.00788496e-03  3.35930325e-02 -2.21781079e-02  5.95713258e-02
 -3.95286530e-02  2.12306809e-02  2.50826633e-06 -4.24503833e-02
  2.68360619e-02 -4.69544064e-03  1.65616758e-02  5.65702878e-02
  1.36076231e-02 -4.40414669e-03 -4.48379815e-02 -2.21757982e-02
 -8.35458562e-03  5.78602776e-02  6.84683174e-02  3.98673825e-02
  3.69233564e-02  4.22316678e-02 -7.85792340e-03 -2.75361389e-02
 -3.96871881e-04 -2.72785649e-02  2.03128569e-02  3.35550793e-02
  1.02757085e-02 -6.43257275e-02 -2.07437593e-02 -3.03139929e-02
 -1.45417983e-02  5.01502305e-02  4.41647222e-04  8.31693038e-03
  1.88349951e-02  3.13723907e-02  1.71485301e-02 -6.42586797e-02
 -1.99076943e-02  1.32275615e-02 -1.01562375e-02 -3.41044390e-03
 -1.44749004e-02  8.39829817e-03 -3.33059509e-03 -4.15993407e-02
 -2.15233956e-02  2.99102291e-02  1.03833703e-02  7.39575364e-03
  2.34120879e-02 -3.68474089e-02 -3.31449509e-02 -2.45514400e-02
 -3.58495489e-02 -9.26436763e-03 -7.99768139e-03 -4.66623157e-02
 -5.70072513e-03  4.58974484e-03  9.81969479e-03 -4.12413739e-02
  4.67657633e-02  2.40882952e-02  2.32362207e-02  1.46775516e-02
 -1.72052644e-02 -3.24395671e-02  5.12610152e-02 -1.10412471e-01
  9.21329111e-02 -1.56868752e-02 -5.17896982e-03  3.39011997e-02
  3.16596776e-03  1.28702715e-03 -5.05030230e-02  4.37559113e-02
 -3.77362967e-02  6.15849756e-02  1.75883975e-02  4.38268151e-04
 -3.57229561e-02  4.13517058e-02 -6.62289262e-02 -2.77466867e-02
  5.70501527e-03 -4.79422696e-03  1.21068349e-02  4.82279836e-04
 -3.61063704e-02  1.81047078e-02 -2.20159385e-02 -2.67535262e-02
  2.79499143e-02  6.83349222e-02 -5.06370999e-02  7.38246553e-03
 -2.71985959e-03 -1.58416573e-02 -3.74477059e-02 -8.20294488e-03
 -1.64186601e-02  1.40014319e-02 -3.27271521e-02  9.30945575e-02
  1.67603176e-02 -1.31798601e-02  2.27298308e-02 -6.82813843e-05
 -5.48845865e-02 -4.12417240e-02  2.19799252e-03  2.15333067e-02
 -4.38352413e-02 -7.89346232e-04 -1.91351697e-02  1.63612552e-02
  2.20406316e-02  3.53720002e-02  1.95999746e-03  5.77446520e-02
 -1.20278113e-02 -1.82847641e-02 -4.10086736e-02  9.11974721e-03
  1.45003097e-02  2.59708986e-02  1.22165028e-02 -1.17871375e-03
 -2.34838901e-03 -4.00883146e-02 -8.02404154e-03  6.77948468e-04
 -7.13792956e-03 -1.19857704e-02 -1.44890649e-02 -4.75901850e-02
 -6.06628247e-02  1.70524642e-02  7.09071383e-02  6.17667437e-02
  2.88172215e-02 -3.65204178e-02  6.30663857e-02  8.94193575e-02
  2.52529811e-02 -2.55407067e-03 -8.43563825e-02 -8.96750856e-03
  3.51497829e-02  8.21148306e-02 -4.30988185e-02  2.85857655e-02
 -2.57011820e-02  4.41675931e-02 -4.18902673e-02  2.61297766e-02
 -7.29952287e-03 -2.67110150e-02 -5.19568101e-02  6.19531237e-02
 -8.13251957e-02 -6.30689189e-02  1.00048399e-02  3.13863605e-02
 -6.18727840e-02 -1.15465140e-02  1.44322431e-02 -2.88945511e-02
  9.88632999e-03  7.50437286e-03  5.18818535e-02  1.06039243e-02
  5.47370221e-03 -1.50570609e-02  1.80172399e-02 -1.73565820e-02
  1.31029189e-02  8.71785507e-02  8.32716748e-03  4.02179286e-02
 -1.66274719e-02 -2.77231466e-02 -1.59036443e-02 -2.12498046e-02
  2.59070583e-02 -2.62855116e-04 -1.19604006e-01  5.30331535e-03
  1.01797655e-02  3.67364883e-02 -3.84419672e-02  2.26043779e-02
  1.89293884e-02 -2.68147350e-03 -7.41468742e-02  4.37002257e-02
 -3.29085789e-03 -1.30007286e-02 -4.37381268e-02  6.23980314e-02
  3.37194428e-02 -1.54554220e-02  4.24196757e-02  1.54049518e-02
 -6.00066669e-02  8.58125463e-03  4.65110689e-02 -1.07918724e-01
 -2.34191190e-03  2.29568715e-04  5.94937056e-02 -7.37566408e-03
  3.64796259e-02 -9.25118178e-02  5.01849875e-02 -2.50852648e-02
  2.65842266e-02 -1.57107152e-02  3.00558638e-02 -2.51071174e-02
 -1.30356848e-02  1.61019657e-02 -1.99336875e-02  1.54059725e-02
 -3.77889052e-02  1.43159535e-02  1.92820455e-03  1.52062885e-02
 -1.32146571e-02  3.61573859e-03  1.33371446e-02 -2.17827912e-02
 -1.91174764e-02 -5.20187020e-02 -1.13868453e-02  5.94867356e-02
 -1.05724186e-02  9.90984961e-03  2.79498491e-02  5.05519845e-02
 -1.06631285e-02  5.55468118e-03 -1.11964652e-02  2.86216903e-02
  6.89101815e-02 -4.56814375e-03  7.66648771e-03  2.92834435e-02
 -1.32046696e-02 -2.46303566e-02 -6.29170984e-02 -2.46127676e-02
 -7.99228810e-03 -5.08283870e-03  3.33121121e-02 -5.91256507e-02
 -1.14836330e-02  3.75092253e-02  4.68650237e-02  1.42480060e-02
  3.11580151e-02 -7.04935268e-02  2.05879938e-02 -3.34816873e-02
 -3.04905162e-03  7.92036355e-02  3.05418633e-02  5.00662401e-02
  1.10990303e-02  1.93549390e-03 -1.25321299e-02 -2.57144589e-02
 -3.57998759e-02  4.43819091e-02 -3.10729463e-02  1.20619340e-02
 -1.75391464e-03  9.04426351e-02  2.62399241e-02  8.56297184e-03
 -7.66070709e-02  3.90945710e-02 -4.85126823e-02 -2.72319373e-02
  7.09767267e-03 -2.27955077e-02 -8.28533024e-02  3.70607525e-02
 -2.40568500e-02 -4.58718650e-03  4.69298773e-02  1.14906998e-02
 -9.97388829e-03 -4.49322117e-03  6.67986274e-02  2.38684192e-03
  4.28162105e-02  4.82764235e-03  3.82596441e-02  6.55650049e-02
 -9.80410874e-02 -4.26628664e-02  1.64108090e-02  1.71505157e-02
 -1.81172788e-02  5.27501330e-02  9.42373369e-03 -1.45771913e-02
 -1.25612170e-02 -4.66127731e-02 -2.56722351e-03  2.59756073e-02
  3.60742817e-03 -7.27166329e-03 -2.55817696e-02 -2.09650416e-02
 -3.57180908e-02 -2.12930399e-03  8.50813743e-03  4.24027489e-03
 -2.22765710e-02 -3.86940665e-03 -3.38591784e-02  2.14161444e-02
 -1.95111614e-02  1.33651672e-02  2.02920120e-02 -6.98135495e-02
  1.31474463e-02  4.13335413e-02 -1.47396103e-02  8.11910182e-02
  4.77515720e-03  1.73268393e-02  5.38085662e-02 -3.57954875e-02
 -1.21017406e-02  8.85047857e-03  6.78264722e-02 -2.20355652e-02
 -1.55756632e-02  5.39752990e-02 -1.96070895e-02 -2.63921395e-02
  4.09395248e-02 -6.01337254e-02 -4.44071442e-02  2.49904674e-02
 -1.75066665e-02 -2.17481647e-02  9.66913067e-03  6.15123136e-04
 -3.04915593e-03  4.40415256e-02 -1.74225923e-02  4.17228043e-02
 -5.57259284e-02  6.19596578e-02  3.11087985e-02 -4.99492735e-02
 -6.61499426e-02  1.44998552e-02  3.36612239e-02  3.69862467e-02
  2.36204527e-02  3.98845747e-02 -5.02379127e-02  1.81072149e-02
  2.07410008e-02  8.43004361e-02  5.23204803e-02 -3.35606746e-02
 -5.31679392e-02  5.12827635e-02  2.41560098e-02  3.52031067e-02
 -3.04275937e-02 -4.86470014e-02  3.28939818e-02 -4.21874411e-02
  2.07626559e-02  3.90843526e-02  6.06428571e-02  3.74770015e-02
 -1.35736940e-02 -7.76569918e-02 -1.04241250e-02 -5.73403668e-03
 -1.14619797e-02 -8.75982735e-03  5.21890707e-02 -3.91885638e-03
 -3.13416645e-02 -4.02633809e-02  6.76904768e-02 -9.19019356e-02
  1.58817731e-02  9.81137753e-02 -7.27509521e-03 -2.07168814e-02
  3.64782941e-03  4.64351811e-02 -9.01166350e-02 -4.26377319e-02
  7.59778023e-02  2.56134830e-02 -7.77570382e-02 -4.54872325e-02
 -4.79627252e-02 -1.66238677e-02  7.79252648e-02  4.80923131e-02
 -6.14451170e-02  1.24381506e-03 -4.43451479e-02 -2.84579396e-02
  1.79431420e-02  2.25604773e-02  7.67504284e-03 -2.61487998e-03
  1.82481203e-02 -7.47353444e-03  1.38344653e-02 -1.93078425e-02
  1.64467376e-02  2.34073913e-03 -2.10555401e-02  6.28436506e-02
  1.09650539e-02  3.69682312e-02 -4.40650471e-02 -4.97837849e-02
 -2.43488643e-02  2.70795133e-02 -2.04650946e-02  5.46687748e-03
  5.99575378e-02  3.24865803e-02 -9.13751274e-02  1.96516272e-02
  2.55383272e-02  1.61052402e-02 -1.19762672e-02  2.74250861e-02
 -2.29129139e-02  6.56416779e-03 -6.54321760e-02  5.23669682e-02
  9.48688947e-03  1.71125233e-02  6.34112675e-03  2.04096232e-02
 -2.59952378e-02 -4.82548168e-03  2.00378858e-02  1.51752783e-02
 -9.42088198e-03 -3.39876562e-02  4.61220779e-02 -2.26054788e-02
  2.22757142e-02  2.13213474e-03 -2.41636988e-02  1.14291452e-03
 -5.02869859e-03  4.12697643e-02  2.29345802e-02 -7.43102236e-03
  1.05628558e-02  9.22037009e-03  7.24210078e-03  2.67290138e-02
 -7.36487657e-02  3.11448518e-02 -1.02477497e-03  1.52039286e-02
  1.57999503e-03 -2.10318193e-02 -6.00320958e-02  1.65703669e-02
 -2.26569753e-02 -5.90611137e-02 -3.63432840e-02 -2.32555903e-02
  4.71993275e-02 -3.19499187e-02  3.83121297e-02  1.68979529e-03
  1.10602546e-02  1.90153103e-02 -1.92778055e-02 -2.16952171e-02
  8.75879079e-03 -1.47843054e-02  6.77855220e-03  2.13421006e-02
 -6.28708228e-02  2.24871375e-02 -8.49609524e-02  2.45343242e-03
  8.16409010e-03 -7.60263810e-03 -1.05558336e-02 -2.33139191e-02
 -1.35427909e-02  1.21091222e-02 -1.18295532e-02 -2.24119928e-02
 -3.01019959e-02 -4.61233445e-02 -2.26080790e-03  3.55459787e-02
  3.38163809e-03 -1.20672828e-03  7.91422185e-03  5.52802859e-03
  6.68738969e-03 -7.65643418e-02  3.02210916e-02  6.04300909e-02
  3.37800849e-03  1.96178909e-02  1.64063147e-03 -7.22589602e-33
 -1.70320105e-02  3.06714270e-02 -1.98133085e-02 -2.38936371e-03
 -8.39633718e-02  8.46640207e-03 -5.77843338e-02  1.57149918e-02
 -1.44729456e-02  1.78535413e-02  2.06227601e-03  2.44308505e-02
  1.50548900e-02 -4.02936526e-03  6.34568334e-02 -1.49579905e-02
 -2.66941235e-04 -1.04814200e-02  1.29410094e-02 -1.70896091e-02
 -2.80479249e-03  1.81602314e-02  1.20574482e-01 -4.39903215e-02
  2.97385646e-04  3.19351666e-02 -1.37463249e-02 -1.58696622e-02
 -4.13072705e-02  4.94379783e-03  1.03050927e-02  5.62727638e-02
 -5.90626616e-03 -9.39885527e-02 -2.85236742e-02 -1.38390241e-02
 -1.55981118e-02 -2.93923933e-02  2.88206581e-02  2.99066082e-02
 -6.42196015e-02 -2.46269200e-02  5.63407205e-02 -3.45898382e-02
 -1.81110799e-02 -4.22975942e-02  2.18010806e-02 -5.03360257e-02
 -1.94010772e-02  7.76189053e-03 -8.99453983e-02 -2.43831500e-02
 -4.79541197e-02  2.22025416e-03  1.08371442e-02 -2.76092831e-02
  5.03628561e-03 -2.91650183e-02 -4.78692912e-02  3.72124501e-02
  4.19561081e-02  4.61263396e-02 -1.63014270e-02 -1.53389270e-03
  6.90420717e-03  3.97106521e-02  8.02663639e-02  1.25841396e-02
 -1.62104890e-02 -3.35693993e-02  1.20363459e-02  5.47856092e-02
  4.86980043e-02 -3.80226113e-02  2.78500300e-02 -2.19447259e-02
  2.21138075e-02 -3.86507027e-02  2.11781729e-02  1.02870055e-01
  3.35851200e-02  2.22648978e-02 -4.06467728e-02  6.07847143e-03
 -6.60511840e-04 -7.85274804e-02 -2.14721095e-02  8.53757001e-03
 -2.33903807e-02 -7.29183201e-03  7.81736225e-02  2.35179327e-02
  7.06736790e-03 -5.94206154e-03  3.84966843e-02 -3.14719267e-02
  2.24312656e-02  2.69719716e-02 -9.43772588e-03 -1.44498879e-02
 -3.76374461e-02  5.86447772e-03 -3.88270020e-02  2.88730431e-02
  1.59189869e-02  4.00433131e-02 -1.87030882e-02 -2.72811968e-02
 -2.03945488e-02 -3.49830501e-02 -3.33733596e-02 -5.24287336e-02
  6.48814887e-02 -2.32566521e-02  1.93263292e-02 -1.44545911e-02
 -6.05060766e-03  9.76871885e-03  1.10980431e-02 -7.09065469e-03
  2.55653262e-02  4.38813977e-02  1.33721335e-02  1.33678410e-02
 -3.09284721e-02 -1.81688368e-02 -3.43397222e-02  9.43283364e-02
  4.37633544e-02 -5.78908995e-02 -1.24699622e-02 -9.18888487e-03
  3.31507152e-07  6.60798848e-02  8.00354499e-03  3.13727707e-02
  6.11355789e-02  2.02164799e-02  1.34739056e-02 -1.40969343e-02
  4.55880910e-02  3.94946197e-03 -1.78160667e-02  1.56594589e-02
  3.14817624e-03 -6.94271876e-03 -9.53307189e-03 -2.60174554e-02
 -5.49039133e-02 -2.82798503e-02  4.05628583e-04 -8.02584179e-03
  3.99773866e-02  1.97891463e-02  6.47678375e-02  2.92061642e-02
 -2.65273210e-02 -3.57505726e-03 -1.01244049e-02 -2.12101489e-02
 -7.34906970e-03  5.19201532e-02 -1.29968915e-02  3.20283100e-02
 -4.97225896e-02  6.69623725e-03  1.70598980e-02 -2.41161734e-02
 -8.38961918e-03  2.29793112e-03 -9.52246320e-03 -4.10097688e-02
  3.27427238e-02  5.43178106e-03 -2.73625106e-02  3.30902915e-03
 -4.51401286e-02  1.68191288e-02 -2.16120505e-03 -3.75603535e-03
  2.26678769e-03 -1.86723769e-02  5.05950535e-03  1.33261960e-02
  1.02313189e-02 -3.72951664e-02 -5.83382845e-02  1.52381556e-03
 -8.69814213e-03 -1.83956586e-02 -7.18888044e-02  1.54975960e-02
  4.19581383e-02 -6.68679178e-03  6.99560274e-04 -1.94718707e-02
 -2.32897815e-03  6.49274141e-02 -1.24156564e-01 -4.06218395e-02
  3.09545017e-34  4.53949999e-03 -5.01900278e-02  7.26575926e-02
  3.96046080e-02 -2.63405722e-02 -1.21725071e-02  3.46652269e-02
 -1.04111899e-02  1.53469322e-02 -1.95797719e-02 -5.16367033e-02]"
"Input-Input Layer5
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
Input-Input Layer5
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
The
Law
will
never
be
perfect
,
but
its
application
should
be
just
-
this
is
what
we
are
missing
,
in
my
opinion
.
 <EOS>
<pad>
Figure 5: Many of the attention heads exhibit behaviour that seems related to the structure of the
sentence. We give two such examples above, from two different heads from the encoder self-attention
at layer 5 of 6. The heads clearly learned to perform different tasks.
 15
","[ 2.85978280e-02  1.65531356e-02 -3.99283543e-02  2.68690530e-02
  3.33477603e-03  1.03015993e-02 -2.19037142e-02 -9.35868733e-03
 -1.48778660e-02 -5.26336720e-03  3.62384808e-03  3.64103052e-03
  1.34650087e-02 -1.41268782e-03  3.98804881e-02 -4.46996540e-02
  1.03508960e-02  1.59808677e-02 -2.54624356e-02 -9.62399971e-03
  3.18451971e-02 -2.13520583e-02  9.95509420e-03 -3.19531746e-03
  9.82289761e-03  1.04779017e-03 -2.82485653e-02  2.21838728e-02
  5.64761180e-03  1.34051684e-02 -1.21275745e-02  4.01468761e-02
 -2.66907346e-02  7.61550991e-03  2.51663255e-06 -3.78890745e-02
  3.51863280e-02 -3.72680724e-02 -1.56993307e-02  5.67657351e-02
 -6.16317801e-02 -5.04196286e-02 -2.81937048e-02 -2.37577851e-03
  1.39705406e-03  6.84380978e-02  7.13606328e-02  2.26797629e-02
  3.69414426e-02  4.36506979e-02 -1.20549905e-03 -3.36532779e-02
  2.88403686e-02 -3.14422175e-02  4.22065109e-02  5.96199976e-03
  3.31411138e-02 -9.78200361e-02 -6.69095367e-02 -2.23373249e-03
 -2.97760181e-02  2.59804055e-02  3.66630107e-02  7.13524548e-03
  4.04442102e-02  2.67751608e-02 -4.23271358e-02 -9.42360051e-03
 -3.45131829e-02  1.50071075e-02  9.22152400e-03  5.36614610e-03
 -5.83847985e-03 -3.35304323e-03  5.11906948e-03 -4.41064127e-02
 -3.43311727e-02  3.87068391e-02  1.57652479e-02  1.27612734e-02
  2.91673746e-02  4.43369179e-04 -2.10695080e-02 -5.70569672e-02
 -3.13920826e-02  3.47880274e-02 -1.20700579e-02 -6.14384189e-02
 -1.01098353e-02  3.73198949e-02  2.14521326e-02 -4.35668789e-02
  2.04467177e-02  5.54593932e-03  1.99593753e-02  2.15282142e-02
 -2.53187791e-02 -3.22204754e-02  2.02863719e-02 -1.50487483e-01
  8.32844153e-02 -9.99646448e-03 -3.85391563e-02  2.46581119e-02
 -1.26132639e-02  3.10081523e-02 -6.23330921e-02  6.02164008e-02
 -2.23067682e-02  4.44174446e-02  2.80332193e-03 -4.71031666e-02
 -1.33097796e-02  6.48897439e-02 -6.64148778e-02 -1.78164896e-02
 -2.41334606e-02  2.34789271e-02 -5.63885132e-03  8.87575443e-04
 -5.09321950e-02 -4.26188670e-03 -1.80453528e-02  7.86122773e-03
  9.31096449e-03  3.47457007e-02 -3.61507870e-02  6.85780775e-03
  1.00893201e-03  3.49603384e-03 -5.90276495e-02  3.91212143e-02
 -2.47635115e-02  3.04176025e-02 -3.50721106e-02  9.96754244e-02
  1.18916659e-02  6.14079135e-03 -1.18506588e-02  4.49118111e-03
 -8.19982961e-02 -2.71725506e-02  2.42260210e-02  1.24538541e-02
 -3.08319014e-02  2.93814298e-02 -4.42808308e-02  1.64928604e-02
  1.82462987e-02  2.91566048e-02  3.51919956e-03  4.37691770e-02
  1.38398232e-02 -1.61671545e-02 -5.82879223e-02 -3.45559604e-02
  3.08104921e-02  5.07027619e-02 -8.72985180e-03  1.73056088e-02
  5.52844489e-03 -1.73058137e-02  1.42958267e-02  1.85836777e-02
 -1.89379381e-03  7.43774930e-03 -1.98705718e-02 -2.43510474e-02
 -2.30141860e-02  3.36367451e-02  4.96534854e-02  5.09344004e-02
  1.76369119e-02 -2.61543114e-02  2.50655077e-02  5.79078682e-02
 -6.27535954e-03 -3.08502000e-02 -1.42507572e-02  2.56107142e-03
  3.23864073e-02  8.71719941e-02 -3.66209708e-02  3.65226157e-02
 -6.53515682e-02  3.56319323e-02 -7.68995658e-02 -5.55562833e-03
 -1.77389849e-02 -3.85286659e-02 -4.07048948e-02  5.01494333e-02
 -5.40456809e-02 -2.91778650e-02  3.17690731e-03  2.89917476e-02
 -4.51359823e-02 -1.74769927e-02  1.22325476e-02 -4.09966148e-02
  2.00772509e-02  2.30779639e-03  4.04553209e-03  2.64225882e-02
 -1.86141506e-02  4.22732830e-02 -9.01760254e-03  5.62803727e-03
 -6.25399500e-03  7.69664496e-02  9.98319872e-03  1.45908436e-02
 -1.17887126e-03 -3.41796242e-02 -2.32282318e-02 -4.87617329e-02
  1.39522962e-02 -7.63706816e-03 -1.33636594e-01  2.94982269e-03
  2.11245175e-02  3.36569324e-02 -1.87180415e-02  3.50871310e-02
  3.40279378e-02  1.28263258e-03 -4.42974865e-02  5.03895618e-02
  1.19557492e-02 -8.49691151e-06 -4.80812835e-03  4.36650254e-02
  5.34823276e-02 -2.28553414e-02  2.33602170e-02  2.55320277e-02
 -9.48739424e-02 -8.86934996e-02  1.07297823e-02 -7.24356472e-02
 -1.05566569e-02  2.80444678e-02  6.03252538e-02 -5.52629977e-02
  2.06722245e-02 -6.30606636e-02  9.08177197e-02 -1.24143902e-02
  5.08025289e-02 -2.46048030e-02  4.12092619e-02 -5.30871078e-02
  1.76570266e-02  3.22464714e-03 -3.48626152e-02 -7.12922122e-03
 -2.24739946e-02  1.93553958e-02 -4.12621461e-02 -1.80360861e-02
  2.43160520e-02  1.88769195e-02 -8.86792596e-03 -2.26218048e-02
 -7.34214019e-03 -4.02298197e-02 -1.58127360e-02  3.41649051e-04
 -2.40827799e-02 -1.43572027e-02  1.80376060e-02  4.94048260e-02
 -1.55838402e-02  3.90986819e-03 -2.66729649e-02  9.52186063e-03
  5.05819358e-02 -9.34095494e-03 -1.34768318e-02  3.97281833e-02
 -2.28876546e-02 -5.29754162e-02 -4.20960970e-02 -4.22760397e-02
 -3.19213197e-02  2.35114079e-02  9.31114424e-03 -4.14802469e-02
 -5.78014664e-02  1.58656519e-02  4.71687540e-02 -1.09423306e-02
  2.02438608e-02 -5.68092279e-02  6.14026561e-03  3.23900487e-03
 -5.17024565e-03  1.02986060e-01  2.24090982e-02  8.74824300e-02
  7.00674206e-03  2.40467377e-02 -1.80720519e-02 -9.59350727e-03
 -2.80232523e-02  4.11137044e-02 -6.38132915e-02  4.63043749e-02
  3.53066176e-02  9.01867896e-02  6.22852966e-02  6.43195305e-03
 -6.65421337e-02  8.64431821e-03 -1.85223240e-02 -4.85539623e-02
 -2.68306825e-02 -6.80002049e-02 -7.05082566e-02  3.07491459e-02
  5.18219918e-03 -1.49621675e-02  8.26919302e-02 -1.63567788e-03
 -2.20848713e-02 -1.85562428e-02  7.16834664e-02 -4.00868990e-02
  3.98135372e-02  2.87308283e-02  2.92293373e-02  6.62428737e-02
 -8.62039477e-02 -3.18078659e-02  1.48250824e-02  1.35502405e-03
  2.84074545e-02  2.49199942e-02  7.96075165e-03 -3.95802893e-02
  1.70956179e-02 -5.47823906e-02 -3.28415670e-02  2.63194814e-02
 -6.82683708e-03  5.27027342e-03  3.89259867e-02 -3.95640358e-03
 -4.81466651e-02 -9.74488072e-03  5.08399419e-02 -8.24211258e-03
 -3.73113155e-02 -5.24889026e-03 -6.01213761e-02  3.11341193e-02
 -3.03618726e-04 -1.94270127e-02  1.96703300e-02 -7.74977207e-02
  2.35609487e-02  2.92859524e-02 -4.00998667e-02  5.83717749e-02
 -9.97754559e-03  4.64597158e-02  7.19143972e-02 -2.54852679e-02
 -1.61016732e-02  3.48644778e-02  8.64540637e-02 -4.35688458e-02
 -3.36081581e-03  5.66900745e-02 -2.38314644e-02 -1.72086675e-02
  3.69242281e-02 -5.04156053e-02 -1.23420833e-02  4.14025746e-02
 -8.06330331e-03  2.72554881e-03 -2.78444728e-03  9.70031880e-03
  1.08618522e-02  3.59715298e-02  7.97503721e-03  3.76678705e-02
 -3.55218612e-02  7.86559209e-02  1.75990202e-02 -4.10867929e-02
 -4.41430770e-02  2.96763815e-02  2.40053684e-02  3.19992751e-02
  9.48548410e-03  5.29841371e-02 -4.85106893e-02  5.86076640e-03
  2.11998262e-02  4.00300063e-02  3.23013179e-02 -3.85648087e-02
 -3.63134183e-02  5.53164110e-02  6.38998002e-02 -6.98852679e-03
 -2.87844185e-02 -5.01733758e-02  2.85985656e-02 -8.55554342e-02
  2.54172888e-02  5.47355004e-02  5.66509441e-02 -1.26330452e-02
 -1.79021861e-02 -6.47666156e-02  2.79840939e-02 -1.91187002e-02
  2.71280762e-02  1.64609738e-02  4.56952676e-02 -2.63628587e-02
 -6.64749369e-02 -7.05969930e-02  3.30195427e-02 -8.35422277e-02
  2.19632778e-02  7.21629411e-02 -3.78948972e-02 -2.44268402e-02
 -1.93454493e-02  8.86974670e-03 -5.33666648e-02 -1.16010038e-02
  6.02822527e-02  3.99724282e-02 -4.13877964e-02 -3.72922234e-02
 -8.16240087e-02 -3.00127547e-02  3.90383378e-02  2.48512067e-02
 -1.78123079e-02  2.65145451e-02 -5.73350005e-02 -1.73785966e-02
 -3.64982560e-02  3.32172848e-02 -8.90602078e-03 -2.97357957e-03
  3.76063609e-03  3.06135546e-02 -9.03385133e-03 -1.73121095e-02
 -3.50304022e-02 -6.40301872e-03 -3.66402753e-02  4.73033711e-02
  1.85126755e-02  2.47315988e-02  1.50085241e-03 -2.02711206e-02
 -2.27734540e-03  1.71789955e-02 -1.02669429e-02  7.75917619e-03
  6.94133341e-02  3.01573221e-02 -4.90318537e-02  6.65246136e-03
  2.92765517e-02  2.59306114e-02 -5.92693454e-03  8.65457300e-03
  6.30436325e-03 -1.79391596e-02 -3.95568274e-02  5.32555319e-02
  5.80776716e-03  5.31817935e-02  1.41731882e-02  3.74172144e-02
 -1.78649239e-02  3.29449512e-02 -1.57765131e-02  7.90672842e-03
 -3.46478857e-02 -1.95659772e-02  5.23190247e-03  3.62074375e-02
  2.28603296e-02  4.24963282e-03 -8.23124591e-03 -2.26337891e-02
  1.78740192e-02  2.76676733e-02 -1.06429160e-02  2.02900562e-02
  6.53721450e-04  2.36148387e-02  1.63550247e-02  3.89892422e-02
 -3.72024514e-02  2.41297856e-02  1.28769521e-02  2.42719222e-02
  2.47583389e-02 -1.51530812e-02 -6.01130798e-02  3.63152549e-02
 -4.83687781e-02 -3.61275636e-02 -2.22763252e-02 -4.19351980e-02
  1.54822050e-02 -3.22431065e-02  2.58548036e-02  2.33971654e-03
  1.52166896e-02  1.60966218e-02  4.36647981e-03 -5.22522628e-02
 -1.57676749e-02  1.16012208e-02 -5.43632079e-03 -1.29966205e-02
 -6.64683506e-02  2.32621003e-02 -8.57574120e-03 -3.82505311e-03
 -4.84443344e-02  1.09844655e-02 -1.87021103e-02 -1.67063307e-02
  5.08842617e-02  4.11145538e-02 -8.61354917e-03 -2.19732430e-02
 -1.78985689e-02 -3.27296108e-02  2.17657816e-02  7.67501350e-03
  5.05537614e-02 -6.37515262e-03  5.27686030e-02  3.36832143e-02
 -1.04225182e-03 -8.10398981e-02  1.77970063e-02  6.94600772e-03
  6.06992329e-03  2.32004002e-02  6.18940871e-03 -7.36621257e-33
 -1.34059007e-03  5.41095529e-03 -3.19600254e-02  3.29468958e-02
 -6.00734241e-02 -1.50481276e-02 -5.24068289e-02  6.88815024e-03
  1.33707281e-02  3.03016580e-03  9.81299789e-04  1.42430468e-02
  1.27455369e-02  3.40426005e-02  8.80632102e-02 -3.22718732e-02
  2.29600705e-02 -8.89594853e-03  6.22107531e-04 -2.44226400e-02
  3.17705199e-02  1.36212865e-02  1.12203605e-01 -5.66883162e-02
  2.10665353e-02 -8.80801864e-03 -5.81092620e-03 -3.33344564e-02
 -3.44353803e-02 -2.26051314e-04 -5.96769340e-03  4.65885252e-02
 -1.42992958e-02 -2.92577837e-02 -3.29554789e-02 -1.73458401e-02
  6.11208053e-03 -4.03251536e-02  7.17147393e-03  1.21919084e-02
 -1.14954486e-01 -2.32267957e-02  6.68563843e-02 -3.13445143e-02
 -4.17490266e-02 -5.21807699e-03  4.61639315e-02 -2.37862710e-02
  3.32037639e-03  9.16033238e-03 -7.91771188e-02 -3.23439203e-02
 -4.82054241e-02  2.31450126e-02 -9.33566224e-03 -7.03726569e-03
 -4.54289466e-03  3.51797743e-03 -4.39901873e-02  4.10707779e-02
 -2.57403329e-02  1.96879916e-03  7.28622591e-03  9.61909129e-04
  1.34042623e-02  4.40424830e-02  8.45010132e-02 -2.61660316e-03
 -3.19084078e-02 -2.10696645e-02  1.24293063e-02  5.57589680e-02
  3.57417315e-02 -5.98410843e-03  2.14958098e-02 -1.54260425e-02
 -1.32633932e-03 -3.89358811e-02  4.32956684e-03  7.86743388e-02
  6.30835863e-03  3.38859819e-02 -5.46702705e-02 -3.56923603e-02
 -1.60817374e-02 -8.18195716e-02 -8.98262952e-03 -1.31341135e-02
  3.35230818e-03 -1.02718845e-02  3.93046252e-02  1.92552584e-03
  1.02878897e-03 -2.11408362e-02  7.96674788e-02  1.91359350e-03
 -2.91722361e-02  2.72294972e-02  2.17035580e-02 -1.72813307e-03
 -6.92828298e-02  1.16153806e-02 -1.56215094e-02  1.89226326e-02
  2.22455747e-02  4.19675149e-02  1.67823546e-02 -5.52956946e-03
 -1.00655314e-02 -1.22701088e-02 -8.30326462e-04 -3.74009348e-02
  3.03705093e-02 -7.18206093e-02  2.30268240e-02 -9.16942954e-03
 -2.42020003e-02  3.66310515e-02 -1.68301314e-02 -5.65207156e-04
 -2.33912915e-02  1.11463983e-02  1.35081476e-02  4.07103784e-02
 -1.30975787e-02  6.78195432e-03 -4.00070101e-02  7.05184042e-02
  3.76126356e-02 -7.58740753e-02 -6.99282158e-03  1.79616027e-02
  3.35983088e-07  3.44850868e-02  1.36756832e-02  3.15090716e-02
  5.00643514e-02  3.26856747e-02  3.56087461e-02 -1.69200078e-02
  6.04058206e-02 -9.30439448e-04 -4.64597810e-03 -1.02744587e-02
  4.97221248e-03 -1.26575620e-03 -4.11321670e-02 -2.97756735e-02
 -2.45709606e-02 -3.49651724e-02 -7.10397493e-03 -9.06655006e-03
  3.11171878e-02  3.29417437e-02  4.89202328e-02  2.47652978e-02
  5.08639403e-03  1.85537653e-03  3.28662768e-02  1.87771097e-02
  2.90692765e-02  5.36505803e-02 -9.19908565e-03 -2.06312705e-02
 -3.52006108e-02 -2.17788033e-02  6.91171810e-02 -1.63361169e-02
  4.43374785e-03  9.35947988e-03  1.13032367e-02 -1.28517691e-02
 -1.67360995e-02  3.35058430e-03  2.33338624e-02  2.94815144e-03
 -5.38277552e-02  3.11115440e-02 -1.36061478e-02 -4.40399423e-02
  1.39826639e-02 -1.75553095e-02  2.73715612e-02  3.85425538e-02
  2.20900513e-02 -2.35485621e-02 -4.67483923e-02  1.12473208e-03
 -1.27149252e-02 -1.14198038e-02 -7.21752793e-02  7.00281048e-03
  2.88414564e-02  9.53672640e-03 -1.21777272e-03 -3.71900536e-02
  1.02922749e-02  8.45751315e-02 -1.14927009e-01 -3.85342725e-02
  3.29358249e-34 -9.81322862e-03 -3.77541855e-02  5.10184430e-02
  7.21605355e-03 -4.34396788e-02 -4.47831489e-02 -1.75695289e-02
  3.14581245e-02  1.22448700e-02 -4.14722748e-02 -4.94340286e-02]"
